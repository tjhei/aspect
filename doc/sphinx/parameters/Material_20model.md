(parameters:Material_20model)=
# Material model


## **Subsection:** Material model


(parameters:Material_20model/Material_20averaging)=
### __Parameter name:__ Material averaging
**Default value:** default averaging

**Pattern:** [Selection none|default averaging|arithmetic average|harmonic average|geometric average|pick largest|project to Q1|log average|harmonic average only viscosity|geometric average only viscosity|project to Q1 only viscosity ]

**Documentation:** Whether or not (and in the first case, how) to do any averaging of material model output data when constructing the linear systems for velocity/pressure, temperature, and compositions in each time step, as well as their corresponding preconditioners. The default value &rsquo;default averaging&rsquo; will choose the averaging option based on the Stokes solver type.

Possible choices: none|default averaging|arithmetic average|harmonic average|geometric average|pick largest|project to Q1|log average|harmonic average only viscosity|geometric average only viscosity|project to Q1 only viscosity

The process of averaging, and where it may be used, is discussed in more detail in {ref}`sec:cookbooks:sinker-with-averaging`.

More averaging schemes are available in the averaging material model. This material model is a &ldquo;compositing material model&rdquo; which can be used in combination with other material models.

(parameters:Material_20model/Model_20name)=
### __Parameter name:__ Model name
**Default value:** unspecified

**Pattern:** [Selection Steinberger|ascii reference profile|averaging|compositing|composition reaction|depth dependent|diffusion dislocation|drucker prager|entropy model|grain size|latent heat|latent heat melt|melt boukare|melt global|melt simple|modified tait|multicomponent|multicomponent compressible|nondimensional|perplex lookup|prescribed viscosity|reactive fluid transport|replace lithosphere viscosity|simple|simple compressible|simpler|visco plastic|viscoelastic|unspecified ]

**Documentation:** The name of the material model to be used in this simulation. There are many material models you can choose from, as listed below. They generally fall into two category: (i) models that implement a particular case of material behavior, (ii) models that modify other models in some way. We sometimes call the latter &ldquo;compositing models&rdquo;. An example of a compositing model is the &ldquo;depth dependent&rdquo; model below in that it takes another, freely choosable model as its base and then modifies that model&rsquo;s output in some way.

You can select one of the following models:

&lsquo;Steinberger&rsquo;: This material model looks up the viscosity from the tables that correspond to the paper of Steinberger and Calderwood 2006 (&ldquo;Models of large-scale viscous flow in the Earth&rsquo;s mantle with constraints from mineral physics and surface observations&rdquo;, Geophys. J. Int., 167, 1461-1481, <http://dx.doi.org/10.1111/j.1365-246X.2006.03131.x>) and material data from a database generated by the thermodynamics code `Perplex`, see <http://www.perplex.ethz.ch/>. The default example data builds upon the thermodynamic database by Stixrude 2011 and assumes a pyrolitic composition by Ringwood 1988 but is easily replaceable by other data files. If &rsquo;Use Drucker-Prager rheology&rsquo; is set to true, this model will apply Drucker-Prager plasticity after computing the default steinberger viscosity. The minimum viscosity with and without the Drucker-Prager plasticity is always equal to the &rsquo;Minimum viscosity&rsquo; in the prm file.

&lsquo;ascii reference profile&rsquo;: A material model that reads in a reference state for density, thermal expansivity, compressibility and specific heat from a text file.
Note the required format of the input data: The first lines may contain any number of comments if they begin with &lsquo;#&rsquo;, but one of these lines needs to contain the number of points in the reference state as for example &lsquo;# POINTS: 3&rsquo;. Following the comment lines there has to be a single line containing the names of all data columns, separated by arbitrarily many spaces. Column names are not allowed to contain spaces. The file can contain unnecessary columns, but for this plugin it needs to at least provide the columns named &lsquo;density&rsquo;, &lsquo;thermal\_expansivity&rsquo;, &lsquo;specific\_heat&rsquo;, and &lsquo;compressibility&rsquo;. Note that the data lines in the file need to be sorted in order of increasing depth from 0 to the maximal depth in the model domain. Points in the model that are outside of the provided depth range will be assigned the maximum or minimum depth values, respectively. Points do not need to be equidistant, but the computation of properties is optimized in speed if they are.

The viscosity $\eta$ is computed as $\eta(z,T) = \eta_r(z) \eta_0 \exp\left(-A \frac{T - T_{\text{adi}}}{T_{\text{adi}}}\right)$, where $\eta_r(z)$ is the depth-dependence, which is a piecewise constant function computed according to the list of &ldquo;Viscosity prefactors&rdquo; and &ldquo;Transition depths&rdquo;, $\eta_0$ is the reference viscosity specified by the parameter &ldquo;Viscosity&rdquo; and $A$ describes the dependence on temperature and corresponds to the parameter &ldquo;Thermal viscosity exponent&rdquo;.

&lsquo;averaging&rsquo;: The &ldquo;averaging&rdquo; Material model applies an averaging of the quadrature points within a cell. The values to average are supplied by any of the other available material models. In other words, it is a &ldquo;compositing material model&rdquo;. Parameters related to the average model are read from a subsection &ldquo;Material model/Averaging&rdquo;.

The user must specify a &ldquo;Base model&rdquo; from which material properties are derived. Furthermore an averaging operation must be selected, where the Choice should be from the list none|arithmetic average|harmonic average|geometric average|pick largest|log average|NWD arithmetic average|NWD harmonic average|NWD geometric average.

NWD stands for Normalized Weighed Distance. The models with this in front of their name work with a weighed average, which means each quadrature point requires an individual weight. The weight is determined by the distance, where the exact relation is determined by a bell shaped curve. A bell shaped curve is a continuous function which is one at its maximum and exactly zero at and beyond its limit. This bell shaped curve is spanned around each quadrature point to determine the weighting map for each quadrature point. The used bell shape comes from Lucy (1977). The distance is normalized so the largest distance becomes one. This means that if variable &rdquo;Bell shape limit&rdquo; is exactly one, the farthest quadrature point is just on the limit and its weight will be exactly zero. In this plugin it is not implemented as larger and equal than the limit, but larger than, to ensure the quadrature point at distance zero is always included.

&lsquo;compositing&rsquo;: The &ldquo;compositing&rdquo; Material model selects material model properties from a given set of other material models, and is intended to make mixing different material models easier. This is useful, for example, when wanting to use the melting parameterization of the &ldquo;melt simple&rdquo; model (which has a relatively simple viscosity model that only allows for a temperature- but not strain rate-dependent viscosity) with a more realistic viscosity model such as that provided by the &ldquo;diffusion dislocation&rdquo; model.

Specifically, this material model works by allowing to specify the name of another material model for each coefficient that material models are asked for (such as the viscosity, density, etc.). Whenever the material model is asked for the values of coefficients, it then evaluates all of the &ldquo;base models&rdquo; that were listed for the various coefficients, and copies the values returned by these base models into the output structure.

The implementation of this material model is somewhat expensive because it has to evaluate all material coefficients of all underlying material models. Consequently, if performance of assembly and postprocessing is important, then implementing a separate material model is a better choice than using this material model.

&lsquo;composition reaction&rsquo;: A material model that behaves in the same way as the simple material model, but includes two compositional fields and a reaction between them. Above a depth given in the input file, the first fields gets converted to the second field.

&lsquo;depth dependent&rsquo;: The &ldquo;depth dependent&rdquo; Material model applies a depth-dependent scaling to the viscosity of any other available material models. In other words, it is a &ldquo;compositing material model&rdquo;.

Parameters related to the depth dependent model are read from a subsection &ldquo;Material model/Depth dependent model&rdquo;. The user must specify a &ldquo;Base model&rdquo; from which material properties are derived. Currently the depth dependent model only allows depth dependence of viscosity - other material properties are taken from the &ldquo;Base model&rdquo;. Viscosity $\eta$ at depth $z$ is calculated according to:$ \eta(z,p,T,X,...) = \eta(z) \eta_b(p,T,X,..)/\eta_{r}$ where $\eta(z)$ is the depth-dependence specified by the depth dependent model, $\eta_b(p,T,X,...)$ is the viscosity calculated from the base model, and $\eta_{r}$ is the reference viscosity. In addition to the specification of the &ldquo;Base model&rdquo;, the user must specify the method to be used to calculate the depth-dependent viscosity $\eta(z)$ as &ldquo;Material model/Depth dependent model/Depth dependence method&rdquo;, which can be chosen among &ldquo;None|Function|File|List&rdquo;. Each method and the associated parameters are as follows:

&ldquo;Function&rdquo;: read a user-specified parsed function from the input file in a subsection &ldquo;Material model/Depth dependent model/Viscosity depth function&rdquo;. By default, this function is uniformly equal to 1.0e21. Specifying a function that returns a value less than or equal to 0.0 anywhere in the model domain will produce an error.

&ldquo;File&rdquo;: read a user-specified file containing viscosity values at specified depths. The file containing depth-dependent viscosities is read from a directory specified by the user as &ldquo;Material model/Depth dependent model/Data directory&rdquo;, from a file with name specified as &ldquo;Material model/Depth dependent model/Viscosity depth file&rdquo;. The format of this file is ascii text and contains two columns with one header line:

example Viscosity depth file:\\Depth (m)    Viscosity (Pa-s)\\0.0000000e+00     1.0000000e+21\\6.7000000e+05     1.0000000e+22\\

Viscosity is interpolated from this file using linear interpolation. &ldquo;None&rdquo;: no depth-dependence. Viscosity is taken directly from &ldquo;Base model&rdquo;

&ldquo;List:&rdquo;: read a comma-separated list of depth values corresponding to the maximum depths of layers having constant depth-dependence $\eta(z)$. The layers must be specified in order of increasing depth, and the last layer in the list must have a depth greater than or equal to the maximal depth of the model. The list of layer depths is specified as &ldquo;Material model/Depth dependent model/Depth list&rdquo; and the corresponding list of layer viscosities is specified as &ldquo;Material model/Depth dependent model/Viscosity list&rdquo;

&lsquo;diffusion dislocation&rsquo;: An implementation of a viscous rheology including diffusion and dislocation creep. Compositional fields can each be assigned individual activation energies, reference densities, thermal expansivities, and stress exponents. The effective viscosity is defined as

$\eta_{\text{eff}} = \left(\frac{1}{\eta_{\text{eff}}^\text{diff}}+ \frac{1}{\eta_{\text{eff}}^\text{dis}}\right)^{-1}$ where $\eta_{\text{i}} = \frac{1}{2} A^{-\frac{1}{n_i}} d^\frac{m_i}{n_i} \dot{\varepsilon_i}^{\frac{1-n_i}{n_i}} \exp\left(\frac{E_i^\ast + PV_i^\ast}{n_iRT}\right)$

where $d$ is grain size, $i$ corresponds to diffusion or dislocation creep, $\dot{\varepsilon}$ is the square root of the second invariant of the strain rate tensor, $R$ is the gas constant, $T$ is temperature, and $P$ is pressure. $A_i$ are prefactors, $n_i$ and $m_i$ are stress and grain size exponents $E_i$ are the activation energies and $V_i$ are the activation volumes.

This form of the viscosity equation is commonly used in geodynamic simulations See, for example, Billen and Hirth (2007), G3, 8, Q08012. Significantly, other studies may use slightly different forms of the viscosity equation leading to variations in how specific terms are defined or combined. For example, the grain size exponent should always be positive in the diffusion viscosity equation used here, while other studies place the grain size term in the denominator and invert the sign of the grain size exponent. When examining previous work, one should carefully check how the viscous prefactor and grain size terms are defined.

The ratio of diffusion to dislocation strain rate is found by Newton&rsquo;s method, iterating to find the stress which satisfies the above equations. The value for the components of this formula and additional parameters are read from the parameter file in subsection &rsquo;Material model/DiffusionDislocation&rsquo;.

&lsquo;drucker prager&rsquo;: A material model that has constant values for all coefficients but the density and viscosity. The defaults for all coefficients are chosen to be similar to what is believed to be correct for Earth&rsquo;s mantle. All of the values that define this model are read from a section &ldquo;Material model/Drucker Prager&rdquo; in the input file, see {ref}`parameters:Material_20model/Drucker_20Prager`. Note that the model does not take into account any dependencies of material properties on compositional fields.

The viscosity is computed according to the Drucker Prager frictional plasticity criterion (non-associative) based on a user-defined internal friction angle $\phi$ and cohesion $C$. In 3d:  $\sigma_y = \frac{6 C \cos(\phi)}{\sqrt{3} (3+\sin(\phi))} + \frac{6 P \sin(\phi)}{\sqrt{3} (3+\sin(\phi))}$, where $P$ is the pressure. See for example Zienkiewicz, O. C., Humpheson, C. and Lewis, R. W. (1975), G\&rsquo;{e}otechnique 25, No. 4, 671-689. With this formulation we circumscribe instead of inscribe the Mohr Coulomb yield surface. In 2d the Drucker Prager yield surface is the same as the Mohr Coulomb surface:  $\sigma_y = P \sin(\phi) + C \cos(\phi)$. Note that in 2d for $\phi=0$, these criteria revert to the von Mises criterion (no pressure dependence). See for example {cite}`thieulot:2011`.

Note that we enforce the pressure to be positive to prevent negative yield strengths and viscosities.

We then use the computed yield strength to scale back the viscosity on to the yield surface using the Viscosity Rescaling Method described in Kachanov, L. M. (2004), Fundamentals of the Theory of Plasticity, Dover Publications, Inc. (Not Radial Return.)A similar implementation can be found in GALE (<https://geodynamics.org/resources/gale>).

To avoid numerically unfavourably large (or even negative) viscosity ranges, we cut off the viscosity with a user-defined minimum and maximum viscosity: $\eta_{eff} = \frac{1}{\frac{1}{\eta_{min} + \eta}+ \frac{1}{\eta_{max}}}$.

Note that this model uses the formulation that assumes an incompressible medium despite the fact that the density follows the law $\rho(T)=\rho_0(1-\beta(T-T_{\text{ref}}))$.

&lsquo;entropy model&rsquo;: A material model that is designed to use pressure and entropy (rather than pressure and temperature) as independent variables. It requires a thermodynamic data table that contains all relevant properties in a specific format as illustrated in the data/material-model/entropy-table/opxtable example folder. The material model requires the use of the projected density approximation for compressibility, and the existence of a compositional field called &rsquo;entropy&rsquo;.

&lsquo;grain size&rsquo;: A material model that relies on compositional fields that correspond to the average grain sizes of a mineral phase and source terms that determine the grain size evolution in terms of the strain rate, temperature, phase transitions, and the creep regime. This material model only works if a compositional field named &rsquo;grain_size&rsquo; is present. In the diffusion creep regime, the viscosity depends on this grain size field. We use the grain size evolution laws described in Behn et al., 2009. Implications of grain size evolution on the seismic structure of the oceanic upper mantle, Earth Planet. Sci. Letters, 282, 178–189. Other material parameters are either prescribed similar to the &rsquo;simple&rsquo; material model, or read from data files that were generated by the Perplex or Hefesto software. This material model is described in more detail in Dannberg, J., Z. Eilon, U. Faul, R. Gassmoeller, P. Moulik, and R. Myhill (2017), The importance of grain size to mantle dynamics and seismological observations, Geochem. Geophys. Geosyst., 18, 3034–3061, doi:10.1002/2017GC006944.

&lsquo;latent heat&rsquo;: A material model that includes phase transitions and the possibility that latent heat is released or absorbed when material crosses one of the phase transitions of up to two different materials (compositional fields). This model implements a standard approximation of the latent heat terms following Christensen \& Yuen, 1985 {cite}`christensen:yuen:1985`. The change of entropy is calculated as $\Delta S = \gamma \frac{\Delta\rho}{\rho^2}$ with the Clapeyron slope $\gamma$ and the density change $\Delta\rho$ of the phase transition being input parameters. The model employs an analytic phase function in the form $X=\frac{1}{2} \left( 1 + \tanh \left( \frac{\Delta p}{\Delta p_0} \right) \right)$ with $\Delta p = p - p_{\text{transition}} - \gamma \left( T - T_{\text{transition}} \right)$ and $\Delta p_0$ being the pressure difference over the width of the phase transition (specified as input parameter).

&lsquo;latent heat melt&rsquo;: A material model that includes the latent heat of melting for two materials: peridotite and pyroxenite. The melting model for peridotite is taken from Katz et al., 2003 (A new parameterization of hydrous mantle melting) and the one for pyroxenite from Sobolev et al., 2011 (Linking mantle plumes, large igneous provinces and environmental catastrophes). The model assumes a constant entropy change for melting 100\% of the material, which can be specified in the input file. The partial derivatives of entropy with respect to temperature and pressure required for calculating the latent heat consumption are then calculated as product of this constant entropy change, and the respective derivative of the function the describes the melt fraction. This is linearly averaged with respect to the fractions of the two materials present. If no compositional fields are specified in the input file, the model assumes that the material is peridotite. If compositional fields are specified, the model assumes that the first compositional field is the fraction of pyroxenite and the rest of the material is peridotite.

Otherwise, this material model has a temperature- and pressure-dependent density and viscosity and the density and thermal expansivity depend on the melt fraction present. It is possible to extent this model to include a melt fraction dependence of all the material parameters by calling the function melt_fraction in the calculation of the respective parameter. However, melt and solid move with the same velocity and melt extraction is not taken into account (batch melting).

&lsquo;melt boukare&rsquo;: A material model that implements a simplified version of the melting model of Boukare et al. (https://doi.org/10.1002/2015JB011929) for the lowermost mantle and uses it to compute the material parameters required for the modeling of melt transport, including melting and solidification and the corresponding changes in composition.The model parameterizes the composition (which includes the components MgO, FeO and SiO2) as a mixture between two endmembers (one iron-bearing and one magnesium-bearing). The equation of state considers three phases: bridgmanite, ferropericlase, and melt (each with their individual compositions). More details can be found in Dannberg, J., Myhill, R., Gassmöller, R., and Cottaar, S. (2021). The morphology, evolution and seismic visibility of partial melt at the core–mantle boundary: implications for ULVZs. Geophysical Journal International, 227(2), 1028-1059.

&lsquo;melt global&rsquo;: A material model that implements a simple formulation of the material parameters required for the modeling of melt transport, including a source term for the porosity according to a simplified linear melting model similar to {cite}`schmeling2006`:
$\phi_{\text{equilibrium}} = \frac{T-T_{\text{sol}}}{T_{\text{liq}}-T_{\text{sol}}}$
with $T_{\text{sol}} = T_{\text{sol,0}} + \Delta T_p \, p + \Delta T_c \, C$
$T_{\text{liq}} = T_{\text{sol}}  + \Delta T_{\text{sol-liq}}$.

&lsquo;melt simple&rsquo;: A material model that implements a simple formulation of the material parameters required for the modeling of melt transport, including a source term for the porosity according to the melting model for dry peridotite of {cite}`katz:etal:2003`. This also includes a computation of the latent heat of melting (if the &lsquo;latent heat&rsquo; heating model is active).

Most of the material properties are constant, except for the shear, viscosity $\eta$, the compaction viscosity $\xi$, and the permeability $k$, which depend on the porosity; and the solid and melt densities, which depend on temperature and pressure:
 $\eta(\phi,T) = \eta_0 e^{\alpha(\phi-\phi_0)} e^{-\beta(T-T_0)/T_0}$, $\xi(\phi,T) = \xi_0 \frac{\phi_0}{\phi} e^{-\beta(T-T_0)/T_0}$, $k=k_0 \phi^n (1-\phi)^m$, $\rho=\rho_0 (1 - \alpha (T - T_{\text{adi}})) e^{\kappa p}$.

The model is compressible only if this is specified in the input file, and contains compressibility for both solid and melt.

&lsquo;modified tait&rsquo;: A material model that implements the thermal modified Tait equation of state as written in {cite}`HP2011`. Constant values are used for the thermal conductivity and viscosity. The defaults for all coefficients are chosen to be similar to what is believed to be correct for Earth&rsquo;s mantle. All of the values that define this model are read from a section &ldquo;Material model/Modified Tait model&rdquo; in the input file, see {ref}`parameters:Material_20model/Modified_20Tait_20model`.

&lsquo;multicomponent&rsquo;: This incompressible model is for use with an arbitrary number of compositional fields, where each field represents a rock type which can have completely different properties from the others. However, each rock type itself has constant material properties.  The value of the  compositional field is interpreted as a volume fraction. If the sum of the fields is greater than one, they are renormalized.  If it is less than one, material properties  for &ldquo;background mantle&rdquo; make up the rest. When more than one field is present, the material properties are averaged arithmetically.  An exception is the viscosity, where the averaging should make more of a difference.  For this, the user selects between arithmetic, harmonic, geometric, or maximum composition averaging.

&lsquo;multicomponent compressible&rsquo;: This model is for use with an arbitrary number of compositional fields, where each field represents a rock type which can have completely different properties from the others. Each rock type is described by a self-consistent equation of state.  The value of the  compositional field is interpreted as a mass fraction. If the sum of the fields is greater than one, they are renormalized.  If it is less than one, material properties  for &ldquo;background mantle&rdquo; make up the rest. When more than one field is present, the material properties are averaged arithmetically by mass fraction (for specific heat), or volume fraction (for density, thermal expansivity and compressibility). The thermal conductivity is also arithmetically averaged by volume fraction. Finally, the viscosity is averaged by volume fraction, but the user can choose between arithmetic, harmonic, geometric or maximum composition averaging.

&lsquo;nondimensional&rsquo;: A material model for nondimensionalized computations for compressible or incompressible computations defined through Rayleigh number   ext{Ra} and Dissipation number Di. This model is made to be used with the Boussinesq, ALA, or TALA formulation.

The viscosity is defined as $\eta = \text{Di} / \text{Ra} \cdot \exp(-b T^\prime + c z)$ where $T^\prime$ is the temperature variation from the adiabatic temperature, $z$ is the depth, $b$ is given by &ldquo;Viscosity temperature prefactor&rdquo;, and $c$ by &ldquo;Viscosity depth prefactor&rdquo;. If $\text{Di}$ is zero, it will be replaced by 1.0 in $\eta$.

The density is defined as $\rho = \exp(\text{Di}/\gamma \cdot z)  (1.0 - \alpha T^\prime + \text{Di} \gamma p^\prime),$ where $\alpha=\text{Di}$ is the thermal expansion coefficient, $\gamma$ is the Grueneisen parameter, and $p^\prime$ is the pressure variation from the adiabatic pressure. The pressure dependent term is not present if &ldquo;TALA&rdquo; is enabled.

&lsquo;perplex lookup&rsquo;: A material model that has constant values for viscosity and thermal conductivity, and calculates other properties on-the-fly using PerpleX meemum. Compositional fields correspond to the individual components in the order given in the PerpleX file.

&lsquo;prescribed viscosity&rsquo;: A material model that applies a viscosity to a &rdquo;base model&rdquo; chosen from any of the other available material models. This prescribed viscosity material model allows the user to specify a function which describes where the viscosity should be prescribed and a second function which describes the viscosity in that region. This material model requires a base model which prescribes the viscosity and the other material parameters in the rest of the model.

&lsquo;reactive fluid transport&rsquo;: Material model that is designed to advect fluids and compute fluid release and absorption based on different models for fluid-rock interaction. At present, models where no fluid-rock interactions occur or the solid has zero solubility are available. The properties of the solid can be taken from another material model that is used as a base model.

&lsquo;replace lithosphere viscosity&rsquo;: The &ldquo;replace lithosphere viscosity&rdquo; Material model sets viscosity to a prescribed constant above the lithosphere-asthenosphere boundary (specified by an ascii file or maximum lithosphere depth). Below the lithosphere-asthenosphereboundary the viscosity is taken from any of the other available material model. In other words, it is a &ldquo;compositing material model&rdquo;.
Parameters related to the replace lithosphere viscosity model are read from a subsection &ldquo;Material model/Replace lithosphere viscosity&rdquo;. The user must specify a &ldquo;Base model&rdquo; from which other material properties are derived.
Note the required format of the input data file: The first lines may contain any number of comments if they begin with ‘#’, but one of these lines needs to contain the number of grid points in each dimension as for example ‘# POINTS: 3 3’. For a spherical model, the order of the data columns has to be&rsquo;phi&rsquo;, &rsquo;theta&rsquo;,&rsquo;depth (m)&rsquo;, where phi is the  azimuth angle and theta is the polar angle measured positive from the north pole.

&lsquo;simple&rsquo;: A material model that has constant values for all coefficients but the density and viscosity. The defaults for all coefficients are chosen to be similar to what is believed to be correct for Earth&rsquo;s mantle. All of the values that define this model are read from a section &ldquo;Material model/Simple model&rdquo; in the input file, see {ref}`parameters:Material_20model/Simple_20model`.

This model uses the following set of equations for the two coefficients that are non-constant: \begin{align}  \eta(p,T,\mathfrak c) &= \tau(T) \zeta(\mathfrak c) \eta_0, \\  \rho(p,T,\mathfrak c) &= \left(1-\alpha (T-T_0)\right)\rho_0 + \Delta\rho \; c_0,\end{align}where $c_0$ is the first component of the compositional vector $\mathfrak c$ if the model uses compositional fields, or zero otherwise.

The temperature pre-factor for the viscosity formula above is defined as \begin{align}  \tau(T) &= H\left(e^{-\beta (T-T_0)/T_0}\right),\intertext{with}   \qquad\qquad H(x) &= \begin{cases}                            \tau_{\text{min}} & \text{if}\; x<\tau_{\text{min}}, \\                            x & \text{if}\; 10^{-2}\le x \le 10^2, \\                            \tau_{\text{max}} & \text{if}\; x>\tau_{\text{max}}, \\                         \end{cases}\end{align} where $x=e^{-\beta (T-T_0)/T_0}$, $\beta$ corresponds to the input parameter &ldquo;Thermal viscosity exponent&rdquo;, and $T_0$ to the parameter &ldquo;Reference temperature&rdquo;. If you set $T_0=0$ in the input file, the thermal pre-factor $\tau(T)=1$. The parameters $\tau_{\text{min}}$ and $\tau_{\text{max}}$ set the minimum and maximum values of the temperature pre-factor and are set using &ldquo;Maximum thermal prefactor&rdquo; and &ldquo;Minimum thermal prefactor&rdquo;. Specifying a value of 0.0 for the minimum or maximum values will disable pre-factor limiting.

The compositional pre-factor for the viscosity is defined as $ \zeta(\mathfrak c) = \xi^{c_0}$ if the model has compositional fields and equals one otherwise. $\xi$ corresponds to the parameter &ldquo;Composition viscosity prefactor&rdquo; in the input file.

Finally, in the formula for the density, $\alpha$ corresponds to the &ldquo;Thermal expansion coefficient&rdquo; and $\Delta\rho$ corresponds to the parameter &ldquo;Density differential for compositional field 1&rdquo;.

Note that this model uses the formulation that assumes an incompressible medium despite the fact that the density follows the law $\rho(T)=\rho_0(1-\alpha(T-T_{\text{ref}}))$.

:::{note}
Despite its name, this material model is not exactly &ldquo;simple&rdquo;, as indicated by the formulas above. While it was originally intended to be simple, it has over time acquired all sorts of temperature and compositional dependencies that weren&rsquo;t initially intended. Consequently, there is now a &ldquo;simpler&rdquo; material model that now fills the role the current model was originally intended to fill.
:::

&lsquo;simple compressible&rsquo;: A material model that has constant values for all coefficients but the density. The defaults for all coefficients are chosen to be similar to what is believed to be correct for Earth&rsquo;s mantle. All of the values that define this model are read from a section &ldquo;Material model/Simple compressible model&rdquo; in the input file, see {ref}`parameters:Material_20model/Simple_20compressible_20model`.

This model uses the following equations for the density: $ \rho(p,T) = \rho_0 \left(1-\alpha (T-T_a)\right) \exp{\beta (P-P_0))}$ This formulation for the density assumes that the compressibility provided by the user is the adiabatic compressibility ($\beta_S$). The thermal expansivity and isentropic compressibility implied by the pressure and temperature dependence are equal to the user-defined constant values only along the reference isentrope, and there is also an implicit pressure dependence to the heat capacity $C_p$ via Maxwell&rsquo;s relations.

&lsquo;simpler&rsquo;: A material model that has constant values except for density, which depends linearly on temperature: $ \rho(p,T) = \left(1-\alpha (T-T_0)\right)\rho_0.$

Note that this material model fills the role the &ldquo;simple&rdquo; material model was originally intended to fill, before the latter acquired all sorts of complicated temperature and compositional dependencies.

&lsquo;visco plastic&rsquo;: An implementation of an incompressible visco(elastic)-plastic rheology with options for selecting dislocation creep, diffusion creep or composite viscous flow laws. Prior to yielding, one may select to modify the viscosity to account for viscoelastic effects by setting the parameter &rsquo;Enable elasticity&rsquo; in subsection Formulation to true. Plasticity limits viscous stresses through a Drucker Prager yield criterion. The implementation of this material model is based heavily on the &lsquo;DiffusionDislocation&rsquo; (Bob Myhill), &lsquo;DruckerPrager&rsquo; (Anne Glerum), and &lsquo;Viscoelastic&rsquo; (John Naliboff) material models.

 The viscosity for dislocation or diffusion creep is defined as $ \eta = \frac 12 A^{-\frac{1}{n}} d^{\frac{m}{n}} \dot{\varepsilon}_{ii}^{\frac{1-n}{n}} \exp\left(\frac{E + PV}{nRT}\right)$ where $A$ is the prefactor, $n$ is the stress exponent, $\dot{\varepsilon}_{ii}$ is the square root of the deviatoric strain rate tensor second invariant, $d$ is grain size, $m$ is the grain size exponent, $E$ is activation energy, $V$ is activation volume, $P$ is pressure, $R$ is the gas exponent and $T$ is temperature. This form of the viscosity equation is commonly used in geodynamic simulations. See, for example, Billen and Hirth (2007), G3, 8, Q08012. Significantly, other studies may use slightly different forms of the viscosity equation leading to variations in how specific terms are defined or combined. For example, the grain size exponent should always be positive in the diffusion viscosity equation used here, while other studies place the grain size term in the denominator and invert the sign of the grain size exponent. When examining previous work, one should carefully check how the viscous prefactor and grain size terms are defined.

 One may select to use the diffusion ($\eta_{\text{diff}}$; $n=1$, $m\neq 0$), dislocation ($\eta_{\text{disl}}$, $n>1$, $m=0$) or composite $\frac{\eta_{\text{diff}} \eta_{\text{disl}}}{\eta_{\text{diff}}+\eta_{\text{disl}}}$ equation form.

 The diffusion and dislocation prefactors can be weakened with a factor between 0 and 1 according to the total or the viscous strain only.

 Viscosity is limited through one of two different &lsquo;yielding&rsquo; mechanisms.

The first plasticity mechanism limits viscous stress through a Drucker Prager yield criterion, where the yield stress in 3d is  $\sigma_y = \frac{6C\cos(\phi) + 2P\sin(\phi)} {\sqrt{3}(3+\sin(\phi))}$ and $\sigma_y = C\cos(\phi) + P\sin(\phi)$ in 2d. Above, $C$ is cohesion and $\phi$  is the angle of internal friction.  Note that the 2d form is equivalent to the Mohr Coulomb yield surface.  If $\phi$ is 0, the yield stress is fixed and equal to the cohesion (Von Mises yield criterion). When the viscous stress ($2\eta {\varepsilon}_{ii}$) exceeds the yield stress, the viscosity is rescaled back to the yield surface: $\eta_{y}=\sigma_{y}/(2{\varepsilon}_{ii})$. This form of plasticity is commonly used in geodynamic models. See, for example, Thieulot, C. (2011), PEPI 188, pp. 47-68.

The user has the option to linearly reduce the cohesion and internal friction angle as a function of the finite strain magnitude. The finite strain invariant or full strain tensor is calculated through compositional fields within the material model. This implementation is identical to the compositional field finite strain plugin and cookbook described in the manual (author: Gassmoeller, Dannberg). If the user selects to track the finite strain invariant ($e_{ii}$), a single compositional field tracks the value derived from $e_{ii}^t = (e_{ii})^{(t-1)} + \dot{e}_{ii}\; dt$, where $t$ and $t-1$ are the current and prior time steps, $\dot{e}_{ii}$ is the second invariant of the strain rate tensor and $dt$ is the time step size. In the case of the full strain tensor $F$, the finite strain magnitude is derived from the second invariant of the symmetric stretching tensor $L$, where $L = F [F]^T$. The user must specify a single compositional field for the finite strain invariant or multiple fields (4 in 2d, 9 in 3d) for the finite strain tensor. These field(s) must be the first listed compositional fields in the parameter file. Note that one or more of the finite strain tensor components must be assigned a non-zero value initially. This value can be be quite small (e.g., 1.e-8), but still non-zero. While the option to track and use the full finite strain tensor exists, tracking the associated compositional fields is computationally expensive in 3d. Similarly, the finite strain magnitudes may in fact decrease if the orientation of the deformation field switches through time. Consequently, the ideal solution is track the finite strain invariant (single compositional) field within the material and track the full finite strain tensor through particles.When only the second invariant of the strain is tracked, one has the option to track the full strain or only the plastic strain. In the latter case, strain is only tracked in case the material is plastically yielding, i.e. the viscous stress > yield stress.

Viscous stress may also be limited by a non-linear stress limiter that has a form similar to the Peierls creep mechanism. This stress limiter assigns an effective viscosity $\sigma_{\text{eff}} = \frac{\tau_y}{2\varepsilon_y} {\frac{\varepsilon_{ii}}{\varepsilon_y}}^{\frac{1}{n_y}-1}$ Above $\tau_y$ is a yield stress, $\varepsilon_y$ is the reference strain rate, $\varepsilon_{ii}$ is the strain rate and $n_y$ is the stress limiter exponent.  The yield stress, $\tau_y$, is defined through the Drucker Prager yield criterion formulation. This method of limiting viscous stress has been used in various forms within the geodynamic literature {cite}`chri92,vavv02,cibi13,cibi15`.When $n_y$ is 1, it essentially becomes a linear viscosity model, and in the limit $n_y\rightarrow \infty$ it converges to the standard viscosity rescaling method (concretely, values $n_y>20$ are large enough).

 The visco-plastic rheology described above may also be modified to include viscoelastic deformation, thus producing a viscoelastic plastic constitutive relationship.

 The viscoelastic rheology behavior takes into account the elastic shear strength (e.g., shear modulus), while the tensile and volumetric strength (e.g., Young&rsquo;s and bulk modulus) are not considered. The model is incompressible and allows specifying an arbitrary number of compositional fields, where each field represents a different rock type or component of the viscoelastic stress tensor. The stress tensor in 2d and 3d, respectively, contains 3 or 6 components. The compositional fields representing these components must be named and listed in a very specific format, which is designed to minimize mislabeling stress tensor components as distinct &rsquo;compositional rock types&rsquo; (or vice versa). For 2d models, three plus three consecutive compositional fields must be labeled &rsquo;stress\_xx&rsquo;, &rsquo;stress\_yy&rsquo;, &rsquo;stress\_xy&rsquo;, &rsquo;stress\_xx\_old&rsquo;, &rsquo;stress\_yy\_old&rsquo;, and &rsquo;stress\_xy\_old&rsquo;. In 3d, six plus six compositional fields must be labeled &rsquo;stress\_xx&rsquo;, &rsquo;stress\_yy&rsquo;, &rsquo;stress\_zz&rsquo;, &rsquo;stress\_xy&rsquo;, &rsquo;stress\_xz&rsquo;, &rsquo;stress\_yz&rsquo;, &rsquo;stress\_xx\_old&rsquo;, &rsquo;stress\_yy\_old&rsquo;, &rsquo;stress\_zz\_old&rsquo;, &rsquo;stress\_xy\_old&rsquo;, &rsquo;stress\_xz\_old&rsquo;, &rsquo;stress\_yz\_old&rsquo;.

 Combining this viscoelasticity implementation with non-linear viscous flow and plasticity produces a constitutive relationship commonly referred to as partial elastoviscoplastic (e.g., pEVP) in the geodynamics community. While extensively discussed and applied within the geodynamics literature, notable references include: Moresi et al. (2003), J. Comp. Phys., v. 184, p. 476-497. Gerya and Yuen (2007), Phys. Earth. Planet. Inter., v. 163, p. 83-105. Gerya (2010), Introduction to Numerical Geodynamic Modeling. Kaus (2010), Tectonophysics, v. 484, p. 36-47. Choi et al. (2013), J. Geophys. Res., v. 118, p. 2429-2444. Keller et al. (2013), Geophys. J. Int., v. 195, p. 1406-1442.

 The overview below directly follows Moresi et al. (2003) eqns. 23-38. However, an important distinction between this material model and the studies above is the option to use compositional fields, rather than particles, to track individual components of the viscoelastic stress tensor. Calculating viscoelastic stresses with particles is also implemented, and can be switched on by using particles with the particle property &rsquo;elastic stress&rsquo;.

 Moresi et al. (2003) begins (eqn. 23) by writing the deviatoric rate of deformation ($\hat{D}$) as the sum of elastic ($\hat{D_{e}}$) and viscous ($\hat{D_{v}}$) components: $\hat{D} = \hat{D_{e}} + \hat{D_{v}}$.  These terms further decompose into $\hat{D_{v}} = \frac{\tau}{2\eta}$ and $\hat{D_{e}} = \frac{\overset{\nabla}{\tau}}{2\mu}$, where $\tau$ is the viscous deviatoric stress, $\eta$ is the shear viscosity, $\mu$ is the shear modulus and $\overset{\nabla}{\tau}$ is the Jaumann corotational stress rate. This later term (eqn. 24) contains the time derivative of the deviatoric stress ($\dot{\tau}$) and terms that account for material spin (e.g., rotation) due to advection: $\overset{\nabla}{\tau} = \dot{\tau} + {\tau}W -W\tau$. Above, $W$ is the material spin tensor (eqn. 25): $W_{ij} = \frac{1}{2} \left (\frac{\partial V_{i}}{\partial x_{j}} - \frac{\partial V_{j}}{\partial x_{i}} \right )$.

 If plasticity is included, the deviatoric rate of deformation may be written as: $\hat{D} = \hat{D_{e}} + \hat{D_{v}} + \hat{D_{p}}$, where $\hat{D_{p}}$ is the plastic component. $\hat{D_{p}}$ decomposes to $\frac{\tau_{y}}{2\eta_{y}}$, where $\tau_{y}$ is the yield stress and $\eta_{y}$ is the viscosity rescaled to the yield surface. The Jaumann stress-rate can also be approximated using terms from the previous time step ($t$) and current time step ($t + \Delta t^{e}$): $\smash[t]{\overset{\nabla}{\tau}}^{t + \Delta t^{e}} \approx \frac{\tau^{t + \Delta t^{e} - \tau^{t}}}{\Delta t^{e}} - W^{t}\tau^{t} + \tau^{t}W^{t}$. In this material model, the size of the time step above ($\Delta t^{e}$) can be specified as the numerical time step size or an independent fixed time step. If the latter case is selected, the user has an option to apply a stress averaging scheme to account for the differences between the numerical and fixed elastic time step (eqn. 32). If one selects to use a fixed elastic time step throughout the model run, this can still be achieved by using CFL and maximum time step values that restrict the numerical time step to a specific time.

 The formulation above allows rewriting the total rate of deformation (eqn. 29) as
 $\tau^{t + \Delta t^{e}} = \eta_{eff} \left ( 2\hat{D}^{t + \triangle t^{e}} + \frac{\tau^{t}}{\mu \Delta t^{e}} + \frac{W^{t}\tau^{t} - \tau^{t}W^{t}}{\mu}  \right )$.

 The effective viscosity (eqn. 28) is a function of the viscosity ($\eta$), elastic time step size ($\Delta t^{e}$) and shear relaxation time ($ \alpha = \frac{\eta}{\mu} $): $\eta_{eff} = \eta \frac{\Delta t^{e}}{\Delta t^{e} + \alpha}$ The magnitude of the shear modulus thus controls how much the effective viscosity is reduced relative to the initial viscosity.

 Elastic effects are introduced into the governing Stokes equations through an elastic force term (eqn. 30 updated to the term in eqn. 5 in Farrington et al. 2014) using stresses from the previous time step rotated and advected into the current time step: $F^{e,t} = -\frac{\eta_{eff}}{\mu \Delta t^{e}} \tau^{0adv}$. This force term is added onto the right-hand side force vector in the system of equations.

 When plastic yielding occurs, the effective viscosity in equation 29 and 30 is the plastic viscosity (equation 36). If the current stress is below the plastic yield stress, the effective viscosity is still as defined in equation 28. During non-linear iterations, we define the current stress prior to yielding (e.g., value compared to yield stress) as $\tau^{t + \Delta t^{e}} = \eta_{eff} \left ( 2\hat{D}^{t + \triangle t^{e}} + \frac{\tau^{t}}{\mu \Delta t^{e}} \right ) $

 Compositional fields can each be assigned individual values of thermal diffusivity, heat capacity, density, thermal expansivity and rheological parameters.

 If more than one compositional field is present at a given point, viscosities are averaged with an arithmetic, geometric harmonic (default) or maximum composition scheme.

 The value for the components of this formula and additional parameters are read from the parameter file in subsection  &rsquo;Material model/Visco Plastic&rsquo;.

&lsquo;viscoelastic&rsquo;: An implementation of a simple linear viscoelastic rheology that only includes the deviatoric components of elasticity. Specifically, the viscoelastic rheology only takes into account the elastic shear strength (e.g., shear modulus), while the tensile and volumetric strength (e.g., Young&rsquo;s and bulk modulus) are not considered. The model is incompressible and allows specifying an arbitrary number of compositional fields, where each field represents a different rock type or component of the viscoelastic stress tensor. The stress tensor in 2d and 3d, respectively, contains 3 or 6 components. The compositional fields representing these components must be named and listed in a very specific format, which is designed to minimize mislabeling stress tensor components as distinct &rsquo;compositional rock types&rsquo; (or vice versa). For 2d models, the first six compositional fields must be labeled &rsquo;stress\_xx&rsquo;, &rsquo;stress\_yy&rsquo; and &rsquo;stress\_xy&rsquo;, &rsquo;stress\_xx\_old&rsquo;, &rsquo;stress\_yy\_old&rsquo; and &rsquo;stress\_xy\_old&rsquo;, In 3d, the first twelve compositional fields must be labeled &rsquo;stress\_xx&rsquo;, &rsquo;stress\_yy&rsquo;, &rsquo;stress\_zz&rsquo;, &rsquo;stress\_xy&rsquo;, &rsquo;stress\_xz&rsquo;, &rsquo;stress\_yz&rsquo;, &rsquo;stress\_xx\_old&rsquo;, &rsquo;stress\_yy\_old&rsquo;, &rsquo;stress\_zz\_old&rsquo;, &rsquo;stress\_xy\_old&rsquo;, &rsquo;stress\_xz\_old&rsquo;, &rsquo;stress\_yz\_old&rsquo;.

 Expanding the model to include non-linear viscous flow (e.g., diffusion/dislocation creep) and plasticity would produce a constitutive relationship commonly referred to as partial elastoviscoplastic (e.g., pEVP) in the geodynamics community. While extensively discussed and applied within the geodynamics literature, notable references include: Moresi et al. (2003), J. Comp. Phys., v. 184, p. 476-497. Gerya and Yuen (2007), Phys. Earth. Planet. Inter., v. 163, p. 83-105. Gerya (2010), Introduction to Numerical Geodynamic Modeling. Kaus (2010), Tectonophysics, v. 484, p. 36-47. Choi et al. (2013), J. Geophys. Res., v. 118, p. 2429-2444. Keller et al. (2013), Geophys. J. Int., v. 195, p. 1406-1442.

 The overview below directly follows Moresi et al. (2003) eqns. 23-32. However, an important distinction between this material model and the studies above is the use of compositional fields, rather than particles, to track individual components of the viscoelastic stress tensor. The material model will be updated when an option to track and calculate viscoelastic stresses with particles is implemented.

 Moresi et al. (2003) begins (eqn. 23) by writing the deviatoric rate of deformation ($\hat{D}$) as the sum of elastic ($\hat{D_{e}}$) and viscous ($\hat{D_{v}}$) components: $\hat{D} = \hat{D_{e}} + \hat{D_{v}}$.  These terms further decompose into $\hat{D_{v}} = \frac{\tau}{2\eta}$ and $\hat{D_{e}} = \frac{\overset{\nabla}{\tau}}{2\mu}$, where $\tau$ is the viscous deviatoric stress, $\eta$ is the shear viscosity, $\mu$ is the shear modulus and $\overset{\nabla}{\tau}$ is the Jaumann corotational stress rate. This later term (eqn. 24) contains the time derivative of the deviatoric stress ($\dot{\tau}$) and terms that account for material spin (e.g., rotation) due to advection: $\overset{\nabla}{\tau} = \dot{\tau} + {\tau}W -W\tau$. Above, $W$ is the material spin tensor (eqn. 25): $W_{ij} = \frac{1}{2} \left (\frac{\partial V_{i}}{\partial x_{j}} - \frac{\partial V_{j}}{\partial x_{i}} \right )$.

 The Jaumann stress-rate can also be approximated using terms from the previous time step ($t$) and current time step ($t + \Delta t^{e}$): $\smash[t]{\overset{\nabla}{\tau}}^{t + \Delta t^{e}} \approx \frac{\tau^{t + \Delta t^{e} - \tau^{t}}}{\Delta t^{e}} - W^{t}\tau^{t} + \tau^{t}W^{t}$. In this material model, the size of the time step above ($\Delta t^{e}$) can be specified as the numerical time step size or an independent fixed time step. If the latter case is selected, a linear interpolation will be appliedto account for the differences between the numerical and fixed elastic time step (eqn. 32). If one selects to use a fixed elastic time step throughout the model run, this can still be achieved by using CFL and maximum time step values that restrict the numerical time step to a specific time.

 The formulation above allows rewriting the total deviatoric stress (eqn. 29) as
 $\tau^{t + \Delta t^{e}} = \eta_\text{eff} \left ( 2\hat{D}^{t + \triangle t^{e}} + \frac{\tau^{t}}{\mu \Delta t^{e}} + \frac{W^{t}\tau^{t} - \tau^{t}W^{t}}{\mu}  \right )$.

 The effective viscosity (eqn. 28) is a function of the viscosity ($\eta$), elastic time step size ($\Delta t^{e}$) and shear relaxation time ($ \alpha = \frac{\eta}{\mu} $): $\eta_\text{eff} = \eta \frac{\Delta t^{e}}{\Delta t^{e} + \alpha}$ The magnitude of the shear modulus thus controls how much the effective viscosity is reduced relative to the initial viscosity.

 Elastic effects are introduced into the governing Stokes equations through an elastic force term (eqn. 30 updated to the term in eqn. 5 in Farrington et al. 2014) using stresses from the previous time step rotated and advected into the current time step: $F^{e,t} = -\frac{\eta_\text{eff}}{\mu \Delta t^{e}} \tau^{0adv}$. This force term is added onto the right-hand side force vector in the system of equations.

 The value of each compositional field representing distinct rock types at a point is interpreted to be a volume fraction of that rock type. If the sum of the compositional field volume fractions is less than one, then the remainder of the volume is assumed to be &rsquo;background material&rsquo;.

 Several model parameters (densities, elastic shear moduli, thermal expansivities, thermal conductivies, specific heats) can be defined per-compositional field. For each material parameter the user supplies a comma delimited list of length N+1, where N is the number of compositional fields. The additional field corresponds to the value for background material. They should be ordered &rdquo;background, composition1, composition2...&rdquo;. However, the first 3 (2d) or 6 (3d) composition fields correspond to components of the elastic stress tensor and their material values will not contribute to the volume fractions. If a single value is given, then all the compositional fields are given that value. Other lengths of lists are not allowed. For a given compositional field the material parameters are treated as constant, except density, which varies linearly with temperature according to the thermal expansivity.

 When more than one compositional field is present at a point, they are averaged arithmetically. An exception is viscosity, which may be averaged arithmetically, harmonically, geometrically, or by selecting the viscosity of the composition field with the greatest volume fraction.

(parameters:Material_20model/Ascii_20reference_20profile)=
## **Subsection:** Material model / Ascii reference profile
(parameters:Material_20model/Ascii_20reference_20profile/Thermal_20conductivity)=
### __Parameter name:__ Thermal conductivity
**Default value:** 4.0

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** Reference conductivity

(parameters:Material_20model/Ascii_20reference_20profile/Thermal_20viscosity_20exponent)=
### __Parameter name:__ Thermal viscosity exponent
**Default value:** 0.

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The temperature dependence of viscosity. Dimensionless exponent.

(parameters:Material_20model/Ascii_20reference_20profile/Transition_20depths)=
### __Parameter name:__ Transition depths
**Default value:** 1.5e5, 4.1e5, 6.6e5

**Pattern:** [List of <[Double 0...MAX_DOUBLE (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** A list of depths where the viscosity changes. Values must monotonically increase. Units: \si{\meter}.

(parameters:Material_20model/Ascii_20reference_20profile/Use_20TALA)=
### __Parameter name:__ Use TALA
**Default value:** false

**Pattern:** [Bool]

**Documentation:** Whether to use the TALA instead of the ALA approximation.

(parameters:Material_20model/Ascii_20reference_20profile/Viscosity)=
### __Parameter name:__ Viscosity
**Default value:** 1e21

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** Viscosity

(parameters:Material_20model/Ascii_20reference_20profile/Viscosity_20prefactors)=
### __Parameter name:__ Viscosity prefactors
**Default value:** 10., 0.1, 1., 10.

**Pattern:** [List of <[Double 0...MAX_DOUBLE (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** A list of prefactors for the viscosity that determine the viscosity profile. Each prefactor is applied in a depth range specified by the list of &lsquo;Transition depths&rsquo;, i.e. the first prefactor is applied above the first transition depth, the second one between the first and second transition depth, and so on. To compute the viscosity profile, this prefactor is multiplied by the reference viscosity specified through the parameter &lsquo;Viscosity&rsquo;. List must have one more entry than Transition depths. Units: non-dimensional.

(parameters:Material_20model/Ascii_20reference_20profile/Ascii_20data_20model)=
## **Subsection:** Material model / Ascii reference profile / Ascii data model
(parameters:Material_20model/Ascii_20reference_20profile/Ascii_20data_20model/Data_20directory)=
### __Parameter name:__ Data directory
**Default value:** $ASPECT_SOURCE_DIR/data/adiabatic-conditions/ascii-data/

**Pattern:** [DirectoryName]

**Documentation:** The name of a directory that contains the model data. This path may either be absolute (if starting with a &lsquo;/&rsquo;) or relative to the current directory. The path may also include the special text &lsquo;$ASPECT_SOURCE_DIR&rsquo; which will be interpreted as the path in which the ASPECT source files were located when ASPECT was compiled. This interpretation allows, for example, to reference files located in the &lsquo;data/&rsquo; subdirectory of ASPECT.

(parameters:Material_20model/Ascii_20reference_20profile/Ascii_20data_20model/Data_20file_20name)=
### __Parameter name:__ Data file name
**Default value:**

**Pattern:** [Anything]

**Documentation:** The file name of the model data.

(parameters:Material_20model/Ascii_20reference_20profile/Ascii_20data_20model/Scale_20factor)=
### __Parameter name:__ Scale factor
**Default value:** 1.

**Pattern:** [Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]

**Documentation:** Scalar factor, which is applied to the model data. You might want to use this to scale the input to a reference model. Another way to use this factor is to convert units of the input files. For instance, if you provide velocities in cm/yr set this factor to 0.01.

(parameters:Material_20model/Averaging)=
## **Subsection:** Material model / Averaging
(parameters:Material_20model/Averaging/Averaging_20operation)=
### __Parameter name:__ Averaging operation
**Default value:** none

**Pattern:** [Selection none|arithmetic average|harmonic average|geometric average|pick largest|log average|nwd arithmetic average|nwd harmonic average|nwd geometric average ]

**Documentation:** Choose the averaging operation to use.

(parameters:Material_20model/Averaging/Base_20model)=
### __Parameter name:__ Base model
**Default value:** simple

**Pattern:** [Selection Steinberger|ascii reference profile|averaging|compositing|composition reaction|depth dependent|diffusion dislocation|drucker prager|entropy model|grain size|latent heat|latent heat melt|melt boukare|melt global|melt simple|modified tait|multicomponent|multicomponent compressible|nondimensional|perplex lookup|prescribed viscosity|reactive fluid transport|replace lithosphere viscosity|simple|simple compressible|simpler|visco plastic|viscoelastic ]

**Documentation:** The name of a material model that will be modified by an averaging operation. Valid values for this parameter are the names of models that are also valid for the &ldquo;Material models/Model name&rdquo; parameter. See the documentation for that for more information.

(parameters:Material_20model/Averaging/Bell_20shape_20limit)=
### __Parameter name:__ Bell shape limit
**Default value:** 1.

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The limit normalized distance between 0 and 1 where the bell shape becomes zero. See the manual for a more information.

(parameters:Material_20model/Compositing)=
## **Subsection:** Material model / Compositing
(parameters:Material_20model/Compositing/Compressibility)=
### __Parameter name:__ Compressibility
**Default value:** unspecified

**Pattern:** [Selection Steinberger|ascii reference profile|averaging|compositing|composition reaction|depth dependent|diffusion dislocation|drucker prager|entropy model|grain size|latent heat|latent heat melt|melt boukare|melt global|melt simple|modified tait|multicomponent|multicomponent compressible|nondimensional|perplex lookup|prescribed viscosity|reactive fluid transport|replace lithosphere viscosity|simple|simple compressible|simpler|visco plastic|viscoelastic|unspecified ]

**Documentation:** Material model to use for Compressibility. Valid values for this parameter are the names of models that are also valid for the &ldquo;Material models/Model name&rdquo; parameter. See the documentation for that for more information.

(parameters:Material_20model/Compositing/Density)=
### __Parameter name:__ Density
**Default value:** unspecified

**Pattern:** [Selection Steinberger|ascii reference profile|averaging|compositing|composition reaction|depth dependent|diffusion dislocation|drucker prager|entropy model|grain size|latent heat|latent heat melt|melt boukare|melt global|melt simple|modified tait|multicomponent|multicomponent compressible|nondimensional|perplex lookup|prescribed viscosity|reactive fluid transport|replace lithosphere viscosity|simple|simple compressible|simpler|visco plastic|viscoelastic|unspecified ]

**Documentation:** Material model to use for Density. Valid values for this parameter are the names of models that are also valid for the &ldquo;Material models/Model name&rdquo; parameter. See the documentation for that for more information.

(parameters:Material_20model/Compositing/Entropy_20derivative_20pressure)=
### __Parameter name:__ Entropy derivative pressure
**Default value:** unspecified

**Pattern:** [Selection Steinberger|ascii reference profile|averaging|compositing|composition reaction|depth dependent|diffusion dislocation|drucker prager|entropy model|grain size|latent heat|latent heat melt|melt boukare|melt global|melt simple|modified tait|multicomponent|multicomponent compressible|nondimensional|perplex lookup|prescribed viscosity|reactive fluid transport|replace lithosphere viscosity|simple|simple compressible|simpler|visco plastic|viscoelastic|unspecified ]

**Documentation:** Material model to use for Entropy derivative pressure. Valid values for this parameter are the names of models that are also valid for the &ldquo;Material models/Model name&rdquo; parameter. See the documentation for that for more information.

(parameters:Material_20model/Compositing/Entropy_20derivative_20temperature)=
### __Parameter name:__ Entropy derivative temperature
**Default value:** unspecified

**Pattern:** [Selection Steinberger|ascii reference profile|averaging|compositing|composition reaction|depth dependent|diffusion dislocation|drucker prager|entropy model|grain size|latent heat|latent heat melt|melt boukare|melt global|melt simple|modified tait|multicomponent|multicomponent compressible|nondimensional|perplex lookup|prescribed viscosity|reactive fluid transport|replace lithosphere viscosity|simple|simple compressible|simpler|visco plastic|viscoelastic|unspecified ]

**Documentation:** Material model to use for Entropy derivative temperature. Valid values for this parameter are the names of models that are also valid for the &ldquo;Material models/Model name&rdquo; parameter. See the documentation for that for more information.

(parameters:Material_20model/Compositing/Reaction_20terms)=
### __Parameter name:__ Reaction terms
**Default value:** unspecified

**Pattern:** [Selection Steinberger|ascii reference profile|averaging|compositing|composition reaction|depth dependent|diffusion dislocation|drucker prager|entropy model|grain size|latent heat|latent heat melt|melt boukare|melt global|melt simple|modified tait|multicomponent|multicomponent compressible|nondimensional|perplex lookup|prescribed viscosity|reactive fluid transport|replace lithosphere viscosity|simple|simple compressible|simpler|visco plastic|viscoelastic|unspecified ]

**Documentation:** Material model to use for Reaction terms. Valid values for this parameter are the names of models that are also valid for the &ldquo;Material models/Model name&rdquo; parameter. See the documentation for that for more information.

(parameters:Material_20model/Compositing/Specific_20heat)=
### __Parameter name:__ Specific heat
**Default value:** unspecified

**Pattern:** [Selection Steinberger|ascii reference profile|averaging|compositing|composition reaction|depth dependent|diffusion dislocation|drucker prager|entropy model|grain size|latent heat|latent heat melt|melt boukare|melt global|melt simple|modified tait|multicomponent|multicomponent compressible|nondimensional|perplex lookup|prescribed viscosity|reactive fluid transport|replace lithosphere viscosity|simple|simple compressible|simpler|visco plastic|viscoelastic|unspecified ]

**Documentation:** Material model to use for Specific heat. Valid values for this parameter are the names of models that are also valid for the &ldquo;Material models/Model name&rdquo; parameter. See the documentation for that for more information.

(parameters:Material_20model/Compositing/Thermal_20conductivity)=
### __Parameter name:__ Thermal conductivity
**Default value:** unspecified

**Pattern:** [Selection Steinberger|ascii reference profile|averaging|compositing|composition reaction|depth dependent|diffusion dislocation|drucker prager|entropy model|grain size|latent heat|latent heat melt|melt boukare|melt global|melt simple|modified tait|multicomponent|multicomponent compressible|nondimensional|perplex lookup|prescribed viscosity|reactive fluid transport|replace lithosphere viscosity|simple|simple compressible|simpler|visco plastic|viscoelastic|unspecified ]

**Documentation:** Material model to use for Thermal conductivity. Valid values for this parameter are the names of models that are also valid for the &ldquo;Material models/Model name&rdquo; parameter. See the documentation for that for more information.

(parameters:Material_20model/Compositing/Thermal_20expansion_20coefficient)=
### __Parameter name:__ Thermal expansion coefficient
**Default value:** unspecified

**Pattern:** [Selection Steinberger|ascii reference profile|averaging|compositing|composition reaction|depth dependent|diffusion dislocation|drucker prager|entropy model|grain size|latent heat|latent heat melt|melt boukare|melt global|melt simple|modified tait|multicomponent|multicomponent compressible|nondimensional|perplex lookup|prescribed viscosity|reactive fluid transport|replace lithosphere viscosity|simple|simple compressible|simpler|visco plastic|viscoelastic|unspecified ]

**Documentation:** Material model to use for Thermal expansion coefficient. Valid values for this parameter are the names of models that are also valid for the &ldquo;Material models/Model name&rdquo; parameter. See the documentation for that for more information.

(parameters:Material_20model/Compositing/Viscosity)=
### __Parameter name:__ Viscosity
**Default value:** unspecified

**Pattern:** [Selection Steinberger|ascii reference profile|averaging|compositing|composition reaction|depth dependent|diffusion dislocation|drucker prager|entropy model|grain size|latent heat|latent heat melt|melt boukare|melt global|melt simple|modified tait|multicomponent|multicomponent compressible|nondimensional|perplex lookup|prescribed viscosity|reactive fluid transport|replace lithosphere viscosity|simple|simple compressible|simpler|visco plastic|viscoelastic|unspecified ]

**Documentation:** Material model to use for Viscosity. Valid values for this parameter are the names of models that are also valid for the &ldquo;Material models/Model name&rdquo; parameter. See the documentation for that for more information.

(parameters:Material_20model/Composition_20reaction_20model)=
## **Subsection:** Material model / Composition reaction model
(parameters:Material_20model/Composition_20reaction_20model/Composition_20viscosity_20prefactor_201)=
### __Parameter name:__ Composition viscosity prefactor 1
**Default value:** 1.0

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** A linear dependency of viscosity on the first compositional field. Dimensionless prefactor. With a value of 1.0 (the default) the viscosity does not depend on the composition.

(parameters:Material_20model/Composition_20reaction_20model/Composition_20viscosity_20prefactor_202)=
### __Parameter name:__ Composition viscosity prefactor 2
**Default value:** 1.0

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** A linear dependency of viscosity on the second compositional field. Dimensionless prefactor. With a value of 1.0 (the default) the viscosity does not depend on the composition.

(parameters:Material_20model/Composition_20reaction_20model/Density_20differential_20for_20compositional_20field_201)=
### __Parameter name:__ Density differential for compositional field 1
**Default value:** 0.

**Pattern:** [Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]

**Documentation:** If compositional fields are used, then one would frequently want to make the density depend on these fields. In this simple material model, we make the following assumptions: if no compositional fields are used in the current simulation, then the density is simply the usual one with its linear dependence on the temperature. If there are compositional fields, then the material model determines how many of them influence the density. The composition-dependence adds a term of the kind $+\Delta \rho \; c_1(\mathbf x)$. This parameter describes the value of $\Delta \rho$. Units: $\frac{\text{kg}}{\text{m}^3}$/unit change in composition.

(parameters:Material_20model/Composition_20reaction_20model/Density_20differential_20for_20compositional_20field_202)=
### __Parameter name:__ Density differential for compositional field 2
**Default value:** 0.

**Pattern:** [Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]

**Documentation:** If compositional fields are used, then one would frequently want to make the density depend on these fields. In this simple material model, we make the following assumptions: if no compositional fields are used in the current simulation, then the density is simply the usual one with its linear dependence on the temperature. If there are compositional fields, then the material model determines how many of them influence the density. The composition-dependence adds a term of the kind $+\Delta \rho \; c_2(\mathbf x)$. This parameter describes the value of $\Delta \rho$. Units: $\frac{\text{kg}}{\text{m}^3}$/unit change in composition.

(parameters:Material_20model/Composition_20reaction_20model/Reaction_20depth)=
### __Parameter name:__ Reaction depth
**Default value:** 0.

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** Above this depth the compositional fields react: The first field gets converted to the second field. Units: $\text{m}$.

(parameters:Material_20model/Composition_20reaction_20model/Reference_20density)=
### __Parameter name:__ Reference density
**Default value:** 3300.

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** Reference density $\rho_0$. Units: $\frac{\text{kg}}{\text{m}^3}$.

(parameters:Material_20model/Composition_20reaction_20model/Reference_20specific_20heat)=
### __Parameter name:__ Reference specific heat
**Default value:** 1250.

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the specific heat $C_p$. Units: $\frac{\text{J}}{\text{K}\text{kg}}$.

(parameters:Material_20model/Composition_20reaction_20model/Reference_20temperature)=
### __Parameter name:__ Reference temperature
**Default value:** 293.

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The reference temperature $T_0$. Units: $\text{K}$.

(parameters:Material_20model/Composition_20reaction_20model/Thermal_20conductivity)=
### __Parameter name:__ Thermal conductivity
**Default value:** 4.7

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the thermal conductivity $k$. Units: $\frac{\text{W}}{\text{m}\text{K}}$$\frac{\text{W}{\text{m}\text{K}}$.

(parameters:Material_20model/Composition_20reaction_20model/Thermal_20expansion_20coefficient)=
### __Parameter name:__ Thermal expansion coefficient
**Default value:** 2e-5

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the thermal expansion coefficient $\alpha$. Units: $\frac{1}{\text{K}}$.

(parameters:Material_20model/Composition_20reaction_20model/Thermal_20viscosity_20exponent)=
### __Parameter name:__ Thermal viscosity exponent
**Default value:** 0.0

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The temperature dependence of viscosity. Dimensionless exponent.

(parameters:Material_20model/Composition_20reaction_20model/Viscosity)=
### __Parameter name:__ Viscosity
**Default value:** 5e24

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the constant viscosity. Units: $\frac{\text{kg}}{\text{m}\test{s}}$.

(parameters:Material_20model/Depth_20dependent_20model)=
## **Subsection:** Material model / Depth dependent model
(parameters:Material_20model/Depth_20dependent_20model/Base_20model)=
### __Parameter name:__ Base model
**Default value:** simple

**Pattern:** [Selection Steinberger|ascii reference profile|averaging|compositing|composition reaction|depth dependent|diffusion dislocation|drucker prager|entropy model|grain size|latent heat|latent heat melt|melt boukare|melt global|melt simple|modified tait|multicomponent|multicomponent compressible|nondimensional|perplex lookup|prescribed viscosity|reactive fluid transport|replace lithosphere viscosity|simple|simple compressible|simpler|visco plastic|viscoelastic ]

**Documentation:** The name of a material model that will be modified by a depth dependent viscosity. Valid values for this parameter are the names of models that are also valid for the &ldquo;Material models/Model name&rdquo; parameter. See the documentation for that for more information.

(parameters:Material_20model/Depth_20dependent_20model/Data_20directory)=
### __Parameter name:__ Data directory
**Default value:** $ASPECT_SOURCE_DIR/data/material-model/rheology/

**Pattern:** [DirectoryName]

**Documentation:** The name of a directory that contains the model data. This path may either be absolute (if starting with a &lsquo;/&rsquo;) or relative to the current directory. The path may also include the special text &lsquo;$ASPECT_SOURCE_DIR&rsquo; which will be interpreted as the path in which the ASPECT source files were located when ASPECT was compiled. This interpretation allows, for example, to reference files located in the &lsquo;data/&rsquo; subdirectory of ASPECT.

(parameters:Material_20model/Depth_20dependent_20model/Data_20file_20name)=
### __Parameter name:__ Data file name
**Default value:** ascii_depth_profile.txt

**Pattern:** [Anything]

**Documentation:** The file name of the model data.

(parameters:Material_20model/Depth_20dependent_20model/Depth_20dependence_20method)=
### __Parameter name:__ Depth dependence method
**Default value:** None

**Pattern:** [Selection Function|File|List|None ]

**Documentation:** Method that is used to specify how the viscosity should vary with depth.

(parameters:Material_20model/Depth_20dependent_20model/Depth_20list)=
### __Parameter name:__ Depth list
**Default value:**

**Pattern:** [List of <[Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** A comma-separated list of depth values for use with the &ldquo;List&rdquo; &ldquo;Depth dependence method&rdquo;. The list must be provided in order of increasing depth, and the last value must be greater than or equal to the maximal depth of the model. The depth list is interpreted as a layered viscosity structure and the depth values specify the maximum depths of each layer.

(parameters:Material_20model/Depth_20dependent_20model/Reference_20viscosity)=
### __Parameter name:__ Reference viscosity
**Default value:** 1.7976931348623157e+308

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the constant reference viscosity $\eta_r$ that is used to scale the non-dimensional depth-dependent viscosity prefactor. Units: $\text{Pa}\text{s}$.

(parameters:Material_20model/Depth_20dependent_20model/Scale_20factor)=
### __Parameter name:__ Scale factor
**Default value:** 1.

**Pattern:** [Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]

**Documentation:** Scalar factor, which is applied to the model data. You might want to use this to scale the input to a reference model. Another way to use this factor is to convert units of the input files. For instance, if you provide velocities in cm/yr set this factor to 0.01.

(parameters:Material_20model/Depth_20dependent_20model/Viscosity_20depth_20file)=
### __Parameter name__: Viscosity depth file
**Alias:** [Data file name](parameters:Material_20model/Depth_20dependent_20model/Data_20file_20name)

**Deprecation Status:** false

(parameters:Material_20model/Depth_20dependent_20model/Viscosity_20list)=
### __Parameter name:__ Viscosity list
**Default value:**

**Pattern:** [List of <[Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** A comma-separated list of viscosity values, corresponding to the depth values provided in &ldquo;Depth list&rdquo;. The number of viscosity values specified here must be the same as the number of depths provided in &ldquo;Depth list&rdquo;.

(parameters:Material_20model/Depth_20dependent_20model/Viscosity_20depth_20function)=
## **Subsection:** Material model / Depth dependent model / Viscosity depth function
(parameters:Material_20model/Depth_20dependent_20model/Viscosity_20depth_20function/Function_20constants)=
### __Parameter name:__ Function constants
**Default value:**

**Pattern:** [Anything]

**Documentation:** Sometimes it is convenient to use symbolic constants in the expression that describes the function, rather than having to use its numeric value everywhere the constant appears. These values can be defined using this parameter, in the form &lsquo;var1=value1, var2=value2, ...&rsquo;.

A typical example would be to set this runtime parameter to &lsquo;pi=3.1415926536&rsquo; and then use &lsquo;pi&rsquo; in the expression of the actual formula. (That said, for convenience this class actually defines both &lsquo;pi&rsquo; and &lsquo;Pi&rsquo; by default, but you get the idea.)

(parameters:Material_20model/Depth_20dependent_20model/Viscosity_20depth_20function/Function_20expression)=
### __Parameter name:__ Function expression
**Default value:** 1.0e21

**Pattern:** [Anything]

**Documentation:**

(parameters:Material_20model/Depth_20dependent_20model/Viscosity_20depth_20function/Variable_20names)=
### __Parameter name:__ Variable names
**Default value:** x,t

**Pattern:** [Anything]

**Documentation:** The names of the variables as they will be used in the function, separated by commas. By default, the names of variables at which the function will be evaluated are &lsquo;x&rsquo; (in 1d), &lsquo;x,y&rsquo; (in 2d) or &lsquo;x,y,z&rsquo; (in 3d) for spatial coordinates and &lsquo;t&rsquo; for time. You can then use these variable names in your function expression and they will be replaced by the values of these variables at which the function is currently evaluated. However, you can also choose a different set of names for the independent variables at which to evaluate your function expression. For example, if you work in spherical coordinates, you may wish to set this input parameter to &lsquo;r,phi,theta,t&rsquo; and then use these variable names in your function expression.

(parameters:Material_20model/Depth_20dependent_20viscosity)=
## **Subsection:** Material model / Depth dependent viscosity
(parameters:Material_20model/Depth_20dependent_20viscosity/Data_20directory)=
### __Parameter name:__ Data directory
**Default value:** $ASPECT_SOURCE_DIR/data/material-model/rheology/

**Pattern:** [DirectoryName]

**Documentation:** The name of a directory that contains the model data. This path may either be absolute (if starting with a &lsquo;/&rsquo;) or relative to the current directory. The path may also include the special text &lsquo;$ASPECT_SOURCE_DIR&rsquo; which will be interpreted as the path in which the ASPECT source files were located when ASPECT was compiled. This interpretation allows, for example, to reference files located in the &lsquo;data/&rsquo; subdirectory of ASPECT.

(parameters:Material_20model/Depth_20dependent_20viscosity/Data_20file_20name)=
### __Parameter name:__ Data file name
**Default value:** ascii_depth_profile.txt

**Pattern:** [Anything]

**Documentation:** The file name of the model data.

(parameters:Material_20model/Depth_20dependent_20viscosity/Scale_20factor)=
### __Parameter name:__ Scale factor
**Default value:** 1.

**Pattern:** [Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]

**Documentation:** Scalar factor, which is applied to the model data. You might want to use this to scale the input to a reference model. Another way to use this factor is to convert units of the input files. For instance, if you provide velocities in cm/yr set this factor to 0.01.

(parameters:Material_20model/Diffusion_20dislocation)=
## **Subsection:** Material model / Diffusion dislocation
(parameters:Material_20model/Diffusion_20dislocation/Activation_20energies_20for_20diffusion_20creep)=
### __Parameter name:__ Activation energies for diffusion creep
**Default value:** 375e3

**Pattern:** [Anything]

**Documentation:** List of activation energies, $E_a$, for background material and compositional fields, for a total of N+1 values, where N is the number of all compositional fields or only those corresponding to chemical compositions. If only one value is given, then all use the same value. Units: \si{\joule\per\mole}.

(parameters:Material_20model/Diffusion_20dislocation/Activation_20energies_20for_20dislocation_20creep)=
### __Parameter name:__ Activation energies for dislocation creep
**Default value:** 530e3

**Pattern:** [Anything]

**Documentation:** List of activation energies, $E_a$, for background material and compositional fields, for a total of N+1 values, where N is the number of all compositional fields or only those corresponding to chemical compositions. If only one value is given, then all use the same value. Units: \si{\joule\per\mole}.

(parameters:Material_20model/Diffusion_20dislocation/Activation_20volumes_20for_20diffusion_20creep)=
### __Parameter name:__ Activation volumes for diffusion creep
**Default value:** 6e-6

**Pattern:** [Anything]

**Documentation:** List of activation volumes, $V_a$, for background material and compositional fields, for a total of N+1 values, where N is the number of all compositional fields or only those corresponding to chemical compositions. If only one value is given, then all use the same value. Units: \si{\meter\cubed\per\mole}.

(parameters:Material_20model/Diffusion_20dislocation/Activation_20volumes_20for_20dislocation_20creep)=
### __Parameter name:__ Activation volumes for dislocation creep
**Default value:** 1.4e-5

**Pattern:** [Anything]

**Documentation:** List of activation volumes, $V_a$, for background material and compositional fields, for a total of N+1 values, where N is the number of all compositional fields or only those corresponding to chemical compositions. If only one value is given, then all use the same value. Units: \si{\meter\cubed\per\mole}.

(parameters:Material_20model/Diffusion_20dislocation/Densities)=
### __Parameter name:__ Densities
**Default value:** 3300.

**Pattern:** [List of <[Double 0...MAX_DOUBLE (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** List of densities, $\rho$, for background mantle and compositional fields, for a total of N+1 values, where N is the number of all compositional fields or only those corresponding to chemical compositions. If only one value is given, then all use the same value. Units: $\frac{\text{kg}}{\text{m}^3}$.

(parameters:Material_20model/Diffusion_20dislocation/Effective_20viscosity_20coefficient)=
### __Parameter name:__ Effective viscosity coefficient
**Default value:** 1.0

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** Scaling coefficient for effective viscosity.

(parameters:Material_20model/Diffusion_20dislocation/Grain_20size)=
### __Parameter name:__ Grain size
**Default value:** 1e-3

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The fixed grain size of the material. This grain size is only used if the parent material model does not provide its own (possibly variable) grain size when calling this rheology.Units: \si{\meter}.

(parameters:Material_20model/Diffusion_20dislocation/Grain_20size_20exponents_20for_20diffusion_20creep)=
### __Parameter name:__ Grain size exponents for diffusion creep
**Default value:** 3.

**Pattern:** [Anything]

**Documentation:** List of grain size exponents, $m_{\text{diffusion}}$, for background material and compositional fields, for a total of N+1 values, where N is the number of all compositional fields or only those corresponding to chemical compositions. If only one value is given, then all use the same value. Units: None.

(parameters:Material_20model/Diffusion_20dislocation/Heat_20capacity)=
### __Parameter name:__ Heat capacity
**Default value:** 1.25e3

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the specific heat $C_p$. Units: $\frac{\text{J}}{\text{K}\text{kg}}$.

(parameters:Material_20model/Diffusion_20dislocation/Maximum_20strain_20rate_20ratio_20iterations)=
### __Parameter name:__ Maximum strain rate ratio iterations
**Default value:** 40

**Pattern:** [Integer range 0...2147483647 (inclusive)]

**Documentation:** Maximum number of iterations to find the correct diffusion/dislocation strain rate ratio.

(parameters:Material_20model/Diffusion_20dislocation/Maximum_20viscosity)=
### __Parameter name:__ Maximum viscosity
**Default value:** 1e28

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** Upper cutoff for effective viscosity. Units: $\text{Pa}\text{s}$.

(parameters:Material_20model/Diffusion_20dislocation/Minimum_20strain_20rate)=
### __Parameter name:__ Minimum strain rate
**Default value:** 1.4e-20

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** Stabilizes strain dependent viscosity. Units: \si{\per\second}.

(parameters:Material_20model/Diffusion_20dislocation/Minimum_20viscosity)=
### __Parameter name:__ Minimum viscosity
**Default value:** 1e17

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** Lower cutoff for effective viscosity. Units: $\text{Pa}\text{s}$.

(parameters:Material_20model/Diffusion_20dislocation/Prefactors_20for_20diffusion_20creep)=
### __Parameter name:__ Prefactors for diffusion creep
**Default value:** 1.5e-15

**Pattern:** [Anything]

**Documentation:** List of viscosity prefactors, $A$, for background material and compositional fields, for a total of N+1 values, where N is the number of all compositional fields or only those corresponding to chemical compositions. If only one value is given, then all use the same value. Units: \si{\per\pascal\meter}$^{m_{\text{diffusion}}}$\si{\per\second}.

(parameters:Material_20model/Diffusion_20dislocation/Prefactors_20for_20dislocation_20creep)=
### __Parameter name:__ Prefactors for dislocation creep
**Default value:** 1.1e-16

**Pattern:** [Anything]

**Documentation:** List of viscosity prefactors, $A$, for background material and compositional fields, for a total of N+1 values, where N is the number of all compositional fields or only those corresponding to chemical compositions. If only one value is given, then all use the same value. Units: \si{\pascal}$^{-n_{\text{dislocation}}}$ \si{\per\second}.

(parameters:Material_20model/Diffusion_20dislocation/Reference_20temperature)=
### __Parameter name:__ Reference temperature
**Default value:** 293.

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** For calculating density by thermal expansivity. Units: $\text{K}$.

(parameters:Material_20model/Diffusion_20dislocation/Strain_20rate_20residual_20tolerance)=
### __Parameter name:__ Strain rate residual tolerance
**Default value:** 1e-10

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** Tolerance for determining the correct stress and viscosity from the strain rate by internal iteration. The tolerance is expressed as the difference between the natural logarithm of the input strain rate and the strain rate at the current iteration. This determines that strain rate is correctly partitioned between diffusion and dislocation creep assuming that both mechanisms experience the same stress.

(parameters:Material_20model/Diffusion_20dislocation/Stress_20exponents_20for_20diffusion_20creep)=
### __Parameter name:__ Stress exponents for diffusion creep
**Default value:** 1.

**Pattern:** [List of <[Double 0...MAX_DOUBLE (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** List of stress exponents, $n_{\text{diffusion}}$, for background mantle and compositional fields, for a total of N+1 values, where N is the number of all compositional fields or only those corresponding to chemical compositions. The stress exponent for diffusion creep is almost always equal to one. If only one value is given, then all use the same value.  Units: None.

(parameters:Material_20model/Diffusion_20dislocation/Stress_20exponents_20for_20dislocation_20creep)=
### __Parameter name:__ Stress exponents for dislocation creep
**Default value:** 3.5

**Pattern:** [Anything]

**Documentation:** List of stress exponents, $n_{\text{dislocation}}$, for background material and compositional fields, for a total of N+1 values, where N is the number of all compositional fields or only those corresponding to chemical compositions. If only one value is given, then all use the same value.  Units: None.

(parameters:Material_20model/Diffusion_20dislocation/Thermal_20diffusivity)=
### __Parameter name:__ Thermal diffusivity
**Default value:** 0.8e-6

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** Units: \si{\meter\squared\per\second}.

(parameters:Material_20model/Diffusion_20dislocation/Thermal_20expansivities)=
### __Parameter name:__ Thermal expansivities
**Default value:** 3.5e-5

**Pattern:** [List of <[Double 0...MAX_DOUBLE (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** List of thermal expansivities for background mantle and compositional fields, for a total of N+1 values, where N is the number of all compositional fields or only those corresponding to chemical compositions. If only one value is given, then all use the same value.  Units: $\frac{1}{\text{K}}$.

(parameters:Material_20model/Diffusion_20dislocation/Viscosity_20averaging_20scheme)=
### __Parameter name:__ Viscosity averaging scheme
**Default value:** harmonic

**Pattern:** [Selection arithmetic|harmonic|geometric|maximum composition ]

**Documentation:** When more than one compositional field is present at a point with different viscosities, we need to come up with an average viscosity at that point.  Select a weighted harmonic, arithmetic, geometric, or maximum composition.

(parameters:Material_20model/Drucker_20Prager)=
## **Subsection:** Material model / Drucker Prager
(parameters:Material_20model/Drucker_20Prager/Reference_20density)=
### __Parameter name:__ Reference density
**Default value:** 3300.

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** Reference density $\rho_0$. Units: $\frac{\text{kg}}{\text{m}^3}$.

(parameters:Material_20model/Drucker_20Prager/Reference_20specific_20heat)=
### __Parameter name:__ Reference specific heat
**Default value:** 1250.

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the specific heat $C_p$. Units: $\frac{\text{J}}{\text{K}\text{kg}}$.

(parameters:Material_20model/Drucker_20Prager/Reference_20temperature)=
### __Parameter name:__ Reference temperature
**Default value:** 293.

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The reference temperature $T_0$. The reference temperature is used in the density calculation. Units: \si{\kelvin}.

(parameters:Material_20model/Drucker_20Prager/Thermal_20conductivity)=
### __Parameter name:__ Thermal conductivity
**Default value:** 4.7

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the thermal conductivity $k$. Units: \si{\watt\per\meter\per\kelvin}.

(parameters:Material_20model/Drucker_20Prager/Thermal_20expansion_20coefficient)=
### __Parameter name:__ Thermal expansion coefficient
**Default value:** 2e-5

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the thermal expansion coefficient $\alpha$. Units: $\frac{1}{\text{K}}$.

(parameters:Material_20model/Drucker_20Prager/Viscosity)=
## **Subsection:** Material model / Drucker Prager / Viscosity
(parameters:Material_20model/Drucker_20Prager/Viscosity/Angle_20of_20internal_20friction)=
### __Parameter name:__ Angle of internal friction
**Default value:** 0.

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the angle of internal friction $\phi$. For a value of zero, in 2d the von Mises criterion is retrieved. Angles higher than 30 degrees are harder to solve numerically. Units: degrees.

(parameters:Material_20model/Drucker_20Prager/Viscosity/Cohesion)=
### __Parameter name:__ Cohesion
**Default value:** 2e7

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the cohesion $C$. Units: \si{\pascal}.

(parameters:Material_20model/Drucker_20Prager/Viscosity/Maximum_20viscosity)=
### __Parameter name:__ Maximum viscosity
**Default value:** 1e24

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the maximum viscosity cutoff $\eta_max$. Units: \si{\pascal\second}.

(parameters:Material_20model/Drucker_20Prager/Viscosity/Minimum_20viscosity)=
### __Parameter name:__ Minimum viscosity
**Default value:** 1e19

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the minimum viscosity cutoff $\eta_min$. Units: \si{\pascal\second}.

(parameters:Material_20model/Drucker_20Prager/Viscosity/Reference_20strain_20rate)=
### __Parameter name:__ Reference strain rate
**Default value:** 1e-15

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the initial strain rate prescribed during the first nonlinear iteration $\dot{\epsilon}_ref$. Units: \si{\per\second}.

(parameters:Material_20model/Entropy_20model)=
## **Subsection:** Material model / Entropy model
(parameters:Material_20model/Entropy_20model/Angle_20of_20internal_20friction)=
### __Parameter name:__ Angle of internal friction
**Default value:** 0.

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the angle of internal friction, $\phi$.For a value of zero, in 2D the von Mises criterion is retrieved. Angles higher than 30 degrees are harder to solve numerically.Units: degrees.

(parameters:Material_20model/Entropy_20model/Cohesion)=
### __Parameter name:__ Cohesion
**Default value:** 1e20

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the cohesion, $C$. The extremely large defaultcohesion value (1e20 Pa) prevents the viscous stress from exceeding the yield stress. Units: \si{\pascal}.

(parameters:Material_20model/Entropy_20model/Data_20directory)=
### __Parameter name:__ Data directory
**Default value:** $ASPECT_SOURCE_DIR/data/material-model/entropy-table/opxtable/

**Pattern:** [DirectoryName]

**Documentation:** The path to the model data. The path may also include the special text &rsquo;$ASPECT_SOURCE_DIR&rsquo; which will be interpreted as the path in which the ASPECT source files were located when ASPECT was compiled. This interpretation allows, for example, to reference files located in the &lsquo;data/&rsquo; subdirectory of ASPECT.

(parameters:Material_20model/Entropy_20model/Lateral_20viscosity_20file_20name)=
### __Parameter name:__ Lateral viscosity file name
**Default value:** constant_lateral_vis_prefactor.txt

**Pattern:** [Anything]

**Documentation:** The file name of the lateral viscosity prefactor.

(parameters:Material_20model/Entropy_20model/Material_20file_20name)=
### __Parameter name:__ Material file name
**Default value:** material_table.txt

**Pattern:** [List of <[Anything]> of length 0...4294967295 (inclusive)]

**Documentation:** The file name of the material data. The first material data file is intended for the background composition.

(parameters:Material_20model/Entropy_20model/Maximum_20iteration_20for_20multicomponent_20equilibration)=
### __Parameter name:__ Maximum iteration for multicomponent equilibration
**Default value:** 50

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The maximum allowed number of iterations for the multicomponent equlibration to reach the tolerance value. If the maximum iteration is reached but thetemperature has not been equilibrated, the model run will abort.

(parameters:Material_20model/Entropy_20model/Maximum_20lateral_20viscosity_20variation)=
### __Parameter name:__ Maximum lateral viscosity variation
**Default value:** 1e2

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The relative cutoff value for lateral viscosity variations caused by temperature deviations. The viscosity may vary laterally by this factor squared.

(parameters:Material_20model/Entropy_20model/Maximum_20thermal_20conductivity)=
### __Parameter name:__ Maximum thermal conductivity
**Default value:** 1000

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The maximum thermal conductivity that is allowed in the model. Larger values will be cut off.

(parameters:Material_20model/Entropy_20model/Maximum_20viscosity)=
### __Parameter name:__ Maximum viscosity
**Default value:** 1e23

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The maximum viscosity that is allowed in the viscosity calculation. Larger values will be cut off.

(parameters:Material_20model/Entropy_20model/Minimum_20viscosity)=
### __Parameter name:__ Minimum viscosity
**Default value:** 1e19

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The minimum viscosity that is allowed in the viscosity calculation. Smaller values will be cut off.

(parameters:Material_20model/Entropy_20model/Multicomponent_20equilibration_20tolerance)=
### __Parameter name:__ Multicomponent equilibration tolerance
**Default value:** 1e-7

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** This is the maximum temperature difference between the different compositions when they are considered in equilibrium.

(parameters:Material_20model/Entropy_20model/Pressure_20dependencies_20of_20thermal_20conductivity)=
### __Parameter name:__ Pressure dependencies of thermal conductivity
**Default value:** 3.3e-10, 3.4e-10, 3.6e-10, 1.05e-10

**Pattern:** [List of <[Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** A list of values that determine the linear scaling of the thermal conductivity with pressure. Units: \si{\watt\per\meter\per\kelvin\per\pascal}.

(parameters:Material_20model/Entropy_20model/Reference_20temperatures_20for_20thermal_20conductivity)=
### __Parameter name:__ Reference temperatures for thermal conductivity
**Default value:** 300, 300, 300, 1200

**Pattern:** [List of <[Double 0...MAX_DOUBLE (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** A list of values of reference temperatures used to determine the temperature-dependence of the thermal conductivity. Units: $\text{K}$.

(parameters:Material_20model/Entropy_20model/Reference_20thermal_20conductivities)=
### __Parameter name:__ Reference thermal conductivities
**Default value:** 2.47, 3.81, 3.52, 4.9

**Pattern:** [List of <[Double 0...MAX_DOUBLE (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** A list of base values of the thermal conductivity for each of the horizontal layers. Pressure- and temperature-dependence will be applied on top of this base value, according to the parameters &rsquo;Pressure dependencies of thermal conductivity&rsquo; and &rsquo;Reference temperatures for thermal conductivity&rsquo;. Units: $\frac{\text{W}{\text{m}\text{K}}$

(parameters:Material_20model/Entropy_20model/Reference_20viscosity)=
### __Parameter name:__ Reference viscosity
**Default value:** 1e22

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The viscosity that is used in this model.

Units: \si{\pascal\second}

(parameters:Material_20model/Entropy_20model/Saturation_20prefactors)=
### __Parameter name:__ Saturation prefactors
**Default value:** 0, 0, 0, 1

**Pattern:** [List of <[Double 0...1 (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** A list of values that indicate how a given layer should take into account the effects of saturation on the temperature-dependence of the thermal conductivity. This factor is multiplied with a saturation function based on the theory of Roufosse and Klemens, 1974. A value of 1 reproduces the formulation of Stackhouse et al. (2015), a value of 0 reproduces the formulation of Tosi et al., (2013). Units: none.

(parameters:Material_20model/Entropy_20model/Thermal_20conductivity)=
### __Parameter name:__ Thermal conductivity
**Default value:** 4.7

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the thermal conductivity $k$. Units: $\frac{\text{W}{\text{m}\text{K}}$.

(parameters:Material_20model/Entropy_20model/Thermal_20conductivity_20exponents)=
### __Parameter name:__ Thermal conductivity exponents
**Default value:** 0.48, 0.56, 0.61, 1.0

**Pattern:** [List of <[Double 0...MAX_DOUBLE (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** A list of exponents in the temperature-dependent term of the conductivity formulation. Note that this exponent is not used (and should have a value of 1) in the formulation of Stackhouse et al. (2015). Units: none.

(parameters:Material_20model/Entropy_20model/Thermal_20conductivity_20formulation)=
### __Parameter name:__ Thermal conductivity formulation
**Default value:** constant

**Pattern:** [Selection constant|p-T-dependent ]

**Documentation:** Which law should be used to compute the thermal conductivity. The &rsquo;constant&rsquo; law uses a constant value for the thermal conductivity. The &rsquo;p-T-dependent&rsquo; formulation uses equations from Stackhouse et al. (2015): First-principles calculations of the lattice thermal conductivity of the lower mantle (https://doi.org/10.1016/j.epsl.2015.06.050), and Tosi et al. (2013): Mantle dynamics with pressure- and temperature-dependent thermal expansivity and conductivity (https://doi.org/10.1016/j.pepi.2013.02.004) to compute the thermal conductivity in dependence of temperature and pressure. The thermal conductivity parameter sets can be chosen in such a way that either the Stackhouse or the Tosi relations are used. The conductivity description can consist of several layers with different sets of parameters. Note that the Stackhouse parametrization is only valid for the lower mantle (bridgmanite).

(parameters:Material_20model/Entropy_20model/Thermal_20conductivity_20transition_20depths)=
### __Parameter name:__ Thermal conductivity transition depths
**Default value:** 410000, 520000, 660000

**Pattern:** [List of <[Double 0...MAX_DOUBLE (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** A list of depth values that indicate where the transitions between the different conductivity parameter sets should occur (in most cases, these will be the depths of major phase transitions). Units: \si{\meter}.

(parameters:Material_20model/Grain_20size_20model)=
## **Subsection:** Material model / Grain size model
(parameters:Material_20model/Grain_20size_20model/ARKode_20initial_20step_20size)=
### __Parameter name:__ ARKode initial step size
**Default value:** 1e-3

**Pattern:** [Double 1e-12...1 (inclusive)]

**Documentation:** The initial step size that the ODE solver uses when solving the grain size evolution equation. The step size is relative to the ASPECT time step, i.e. the default value of 1e-3 means the initial step size will be 1e-3 times the current ASPECT time step.

(parameters:Material_20model/Grain_20size_20model/ARKode_20minimum_20step_20size)=
### __Parameter name:__ ARKode minimum step size
**Default value:** 1e-6

**Pattern:** [Double 1e-12...1 (inclusive)]

**Documentation:** The minimum step size that the ODE solver uses when solving the grain size evolution equation. The step size is relative to the ASPECT time step, i.e. the default value of 1e-6 means the step size will never be smaller than 1e-6 times the current ASPECT time step.

(parameters:Material_20model/Grain_20size_20model/Advect_20logarithm_20of_20grain_20size)=
### __Parameter name:__ Advect logarithm of grain size
**Default value:** false

**Pattern:** [Bool]

**Documentation:** This option does not exist any more.

(parameters:Material_20model/Grain_20size_20model/Angles_20of_20dilation)=
### __Parameter name:__ Angles of dilation
**Default value:** 0.

**Pattern:** [Anything]

**Documentation:** List of angles of plastic dilation, $\psi$, for background material and compositional fields, for a total of N+1 values, where N is the number of all compositional fields or only those corresponding to chemical compositions. For a value of zero, the von Mises flow rule is retrieved. The dilation angle should never exceed the internal friction angle.

(parameters:Material_20model/Grain_20size_20model/Angles_20of_20internal_20friction)=
### __Parameter name:__ Angles of internal friction
**Default value:** 0.

**Pattern:** [Anything]

**Documentation:** List of angles of internal friction, $\phi$, for background material and compositional fields, for a total of N+1 values, where N is the number of all compositional fields or only those corresponding to chemical compositions. For a value of zero, in 2d the von Mises criterion is retrieved. Angles higher than 30 degrees are harder to solve numerically. Units: degrees.

(parameters:Material_20model/Grain_20size_20model/Average_20specific_20grain_20boundary_20energy)=
### __Parameter name:__ Average specific grain boundary energy
**Default value:** 1.0

**Pattern:** [List of <[Double 0...MAX_DOUBLE (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** The average specific grain boundary energy $\gamma$. List must have one more entry than the Phase transition depths. Units: \si{\joule\per\meter\squared}.

(parameters:Material_20model/Grain_20size_20model/Bilinear_20interpolation)=
### __Parameter name:__ Bilinear interpolation
**Default value:** true

**Pattern:** [Bool]

**Documentation:** This parameter determines whether to use bilinear interpolation to compute material properties (slower but more accurate).

(parameters:Material_20model/Grain_20size_20model/Cohesions)=
### __Parameter name:__ Cohesions
**Default value:** 1e20

**Pattern:** [Anything]

**Documentation:** List of cohesions, $C$, for background material and compositional fields, for a total of N+1 values, where N is the number of all compositional fields or only those corresponding to chemical compositions. The extremely large default cohesion value (1e20 Pa) prevents the viscous stress from exceeding the yield stress. Units: \si{\pascal}.

(parameters:Material_20model/Grain_20size_20model/Data_20directory)=
### __Parameter name:__ Data directory
**Default value:** $ASPECT_SOURCE_DIR/data/material-model/steinberger/

**Pattern:** [DirectoryName]

**Documentation:** The path to the model data. The path may also include the special text &rsquo;$ASPECT_SOURCE_DIR&rsquo; which will be interpreted as the path in which the ASPECT source files were located when ASPECT was compiled. This interpretation allows, for example, to reference files located in the &rsquo;data/&rsquo; subdirectory of ASPECT.

(parameters:Material_20model/Grain_20size_20model/Define_20transition_20by_20depth_20instead_20of_20pressure)=
### __Parameter name:__ Define transition by depth instead of pressure
**Default value:** true

**Pattern:** [Bool]

**Documentation:** Whether to list phase transitions by depth or pressure. If this parameter is true, then the input file will use Phase transitions depths and Phase transition widths to define the phase transition. If it is false, the parameter file will read in phase transition data from Phase transition pressures and Phase transition pressure widths.

(parameters:Material_20model/Grain_20size_20model/Derivatives_20file_20names)=
### __Parameter name:__ Derivatives file names
**Default value:**

**Pattern:** [List of <[Anything]> of length 0...4294967295 (inclusive)]

**Documentation:** The file names of the enthalpy derivatives data. List with as many components as active compositional fields (material data is assumed to be in order with the ordering of the fields).

(parameters:Material_20model/Grain_20size_20model/Diffusion_20activation_20energy)=
### __Parameter name:__ Diffusion activation energy
**Default value:** 3.35e5

**Pattern:** [List of <[Double 0...MAX_DOUBLE (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** The activation energy for diffusion creep $E_{diff}$. List must have one more entry than the Phase transition depths. Units: $\frac{\text{J}}{//text{mol}}$.

(parameters:Material_20model/Grain_20size_20model/Diffusion_20activation_20volume)=
### __Parameter name:__ Diffusion activation volume
**Default value:** 4e-6

**Pattern:** [List of <[Double 0...MAX_DOUBLE (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** The activation volume for diffusion creep $V_{diff}$. List must have one more entry than the Phase transition depths. Units: $\frac{\text{m}^3}{\text{mol}}$.

(parameters:Material_20model/Grain_20size_20model/Diffusion_20creep_20exponent)=
### __Parameter name:__ Diffusion creep exponent
**Default value:** 1.

**Pattern:** [List of <[Double 0...MAX_DOUBLE (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** The power-law exponent $n_{diff}$ for diffusion creep. List must have one more entry than the Phase transition depths. Units: none.

(parameters:Material_20model/Grain_20size_20model/Diffusion_20creep_20grain_20size_20exponent)=
### __Parameter name:__ Diffusion creep grain size exponent
**Default value:** 3.

**Pattern:** [List of <[Double 0...MAX_DOUBLE (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** The diffusion creep grain size exponent $p_{diff}$ that determines the dependence of viscosity on grain size. List must have one more entry than the Phase transition depths. Units: none.

(parameters:Material_20model/Grain_20size_20model/Diffusion_20creep_20prefactor)=
### __Parameter name:__ Diffusion creep prefactor
**Default value:** 7.4e-15

**Pattern:** [List of <[Double 0...MAX_DOUBLE (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** The prefactor for the diffusion creep law $A_{diff}$. List must have one more entry than the Phase transition depths. Units: $\frac{ \text{m}^\text{p_{diff}}\text{Pa}^\text{-n_{diff}} }{\text{s}}$.

(parameters:Material_20model/Grain_20size_20model/Dislocation_20activation_20energy)=
### __Parameter name:__ Dislocation activation energy
**Default value:** 4.8e5

**Pattern:** [List of <[Double 0...MAX_DOUBLE (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** The activation energy for dislocation creep $E_{dis}$. List must have one more entry than the Phase transition depths. Units: $\frac{\text{J}}{\text{mol}}$.

(parameters:Material_20model/Grain_20size_20model/Dislocation_20activation_20volume)=
### __Parameter name:__ Dislocation activation volume
**Default value:** 1.1e-5

**Pattern:** [List of <[Double 0...MAX_DOUBLE (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** The activation volume for dislocation creep $V_{dis}$. List must have one more entry than the Phase transition depths. Units: $\frac{\text{m}^3}{\text{mol}}$.

(parameters:Material_20model/Grain_20size_20model/Dislocation_20creep_20exponent)=
### __Parameter name:__ Dislocation creep exponent
**Default value:** 3.5

**Pattern:** [List of <[Double 0...MAX_DOUBLE (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** The power-law exponent $n_{dis}$ for dislocation creep. List must have one more entry than the Phase transition depths. Units: none.

(parameters:Material_20model/Grain_20size_20model/Dislocation_20creep_20prefactor)=
### __Parameter name:__ Dislocation creep prefactor
**Default value:** 4.5e-15

**Pattern:** [List of <[Double 0...MAX_DOUBLE (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** The prefactor for the dislocation creep law $A_{dis}$. List must have one more entry than the Phase transition depths. Units: $\frac{\text{Pa}^\text{-n_{dis}}}{\text{s}}$.

(parameters:Material_20model/Grain_20size_20model/Dislocation_20viscosity_20iteration_20number)=
### __Parameter name:__ Dislocation viscosity iteration number
**Default value:** 100

**Pattern:** [Integer range 0...2147483647 (inclusive)]

**Documentation:** We need to perform an iteration inside the computation of the dislocation viscosity, because it depends on the dislocation strain rate, which depends on the dislocation viscosity itself. This number determines the maximum number of iterations that are performed.

(parameters:Material_20model/Grain_20size_20model/Dislocation_20viscosity_20iteration_20threshold)=
### __Parameter name:__ Dislocation viscosity iteration threshold
**Default value:** 1e-3

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** We need to perform an iteration inside the computation of the dislocation viscosity, because it depends on the dislocation strain rate, which depends on the dislocation viscosity itself. This number determines the termination accuracy, i.e. if the dislocation viscosity changes by less than this factor we terminate the iteration.

(parameters:Material_20model/Grain_20size_20model/Geometric_20constant)=
### __Parameter name:__ Geometric constant
**Default value:** 3.

**Pattern:** [List of <[Double 0...MAX_DOUBLE (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** The geometric constant $c$ used in the paleowattmeter grain size reduction law. List must have one more entry than the Phase transition depths. Units: none.

(parameters:Material_20model/Grain_20size_20model/Grain_20growth_20activation_20energy)=
### __Parameter name:__ Grain growth activation energy
**Default value:** 3.5e5

**Pattern:** [List of <[Double 0...MAX_DOUBLE (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** The activation energy for grain growth $E_g$. List must have one more entry than the Phase transition depths. Units: \si{\joule\per\mole}.

(parameters:Material_20model/Grain_20size_20model/Grain_20growth_20activation_20volume)=
### __Parameter name:__ Grain growth activation volume
**Default value:** 8e-6

**Pattern:** [List of <[Double 0...MAX_DOUBLE (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** The activation volume for grain growth $V_g$. List must have one more entry than the Phase transition depths. Units: \si{\meter\cubed\per\mole}.

(parameters:Material_20model/Grain_20size_20model/Grain_20growth_20exponent)=
### __Parameter name:__ Grain growth exponent
**Default value:** 3.

**Pattern:** [List of <[Double 0...MAX_DOUBLE (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** The exponent of the grain growth law $p_g$. This is an experimentally determined grain growth constant. List must have one more entry than the Phase transition depths. Units: none.

(parameters:Material_20model/Grain_20size_20model/Grain_20growth_20rate_20constant)=
### __Parameter name:__ Grain growth rate constant
**Default value:** 1.5e-5

**Pattern:** [List of <[Double 0...MAX_DOUBLE (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** The prefactor for the Ostwald ripening grain growth law $G_0$. This is dependent on water content, which is assumed to be 50 H/$10^6$ Si for the default value. List must have one more entry than the Phase transition depths. Units: \si{\meter}$^{p_g}$\si{\per\second}.

(parameters:Material_20model/Grain_20size_20model/Grain_20size_20evolution_20formulation)=
### __Parameter name:__ Grain size evolution formulation
**Default value:** paleowattmeter

**Pattern:** [Selection paleowattmeter|paleopiezometer|pinned grain damage ]

**Documentation:** A flag indicating whether the material model should use the paleowattmeter approach of Austin and Evans (2007) for grain size reduction in the dislocation creep regime, the paleopiezometer approach from Hall and Parmetier (2003), or the pinned grain damage approach from Mulyukova and Bercovici (2018).

(parameters:Material_20model/Grain_20size_20model/Lower_20mantle_20grain_20size_20scaling)=
### __Parameter name:__ Lower mantle grain size scaling
**Default value:** 1.0

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** This option does not exist any more.

(parameters:Material_20model/Grain_20size_20model/Material_20file_20format)=
### __Parameter name:__ Material file format
**Default value:** perplex

**Pattern:** [Selection perplex|hefesto ]

**Documentation:** The material file format to be read in the property tables.

(parameters:Material_20model/Grain_20size_20model/Material_20file_20names)=
### __Parameter name:__ Material file names
**Default value:** pyr-ringwood88.txt

**Pattern:** [List of <[Anything]> of length 0...4294967295 (inclusive)]

**Documentation:** The file names of the material data. List with as many components as active compositional fields (material data is assumed to be in order with the ordering of the fields).

(parameters:Material_20model/Grain_20size_20model/Maximum_20latent_20heat_20substeps)=
### __Parameter name:__ Maximum latent heat substeps
**Default value:** 1

**Pattern:** [Integer range 1...2147483647 (inclusive)]

**Documentation:** The maximum number of substeps over the temperature pressure range to calculate the averaged enthalpy gradient over a cell.

(parameters:Material_20model/Grain_20size_20model/Maximum_20specific_20heat)=
### __Parameter name:__ Maximum specific heat
**Default value:** 6000.

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The maximum specific heat that is allowed in the whole model domain. Units: J/kg/K.

(parameters:Material_20model/Grain_20size_20model/Maximum_20temperature_20dependence_20of_20viscosity)=
### __Parameter name:__ Maximum temperature dependence of viscosity
**Default value:** 100.

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The factor by which viscosity at adiabatic temperature and ambient temperature are allowed to differ (a value of x means that the viscosity can be x times higher or x times lower compared to the value at adiabatic temperature. This parameter is introduced to limit local viscosity contrasts, but still allow for a widely varying viscosity over the whole mantle range. Units: none.

(parameters:Material_20model/Grain_20size_20model/Maximum_20thermal_20expansivity)=
### __Parameter name:__ Maximum thermal expansivity
**Default value:** 1e-3

**Pattern:** [Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]

**Documentation:** The maximum thermal expansivity that is allowed in the whole model domain. Units: 1/K.

(parameters:Material_20model/Grain_20size_20model/Maximum_20viscosity)=
### __Parameter name:__ Maximum viscosity
**Default value:** 1e26

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The maximum viscosity that is allowed in the whole model domain. Units: Pa \, s.

(parameters:Material_20model/Grain_20size_20model/Maximum_20yield_20stress)=
### __Parameter name:__ Maximum yield stress
**Default value:** 1e12

**Pattern:** [Anything]

**Documentation:** List of maximum yield stresses, for background material and compositional fields, , which limits the maximum value of the yield stress determined by the Drucker-Prager plasticity parameters. Default value is chosen so this is not automatically used. Values of 100e6--1000e6 $Pa$ have been used in previous models. Units: \si{\pascal}.

(parameters:Material_20model/Grain_20size_20model/Minimum_20grain_20size)=
### __Parameter name:__ Minimum grain size
**Default value:** 1e-5

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The minimum grain size that is used for the material model. This parameter is introduced to limit local viscosity contrasts, but still allows for a widely varying viscosity over the whole mantle range. Units: \si{\meter}.

(parameters:Material_20model/Grain_20size_20model/Minimum_20specific_20heat)=
### __Parameter name:__ Minimum specific heat
**Default value:** 500.

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The minimum specific heat that is allowed in the whole model domain. Units: J/kg/K.

(parameters:Material_20model/Grain_20size_20model/Minimum_20thermal_20expansivity)=
### __Parameter name:__ Minimum thermal expansivity
**Default value:** 1e-5

**Pattern:** [Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]

**Documentation:** The minimum thermal expansivity that is allowed in the whole model domain. Units: 1/K.

(parameters:Material_20model/Grain_20size_20model/Minimum_20viscosity)=
### __Parameter name:__ Minimum viscosity
**Default value:** 1e18

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The minimum viscosity that is allowed in the whole model domain. Units: Pa \, s.

(parameters:Material_20model/Grain_20size_20model/Phase_20transition_20Clapeyron_20slopes)=
### __Parameter name:__ Phase transition Clapeyron slopes
**Default value:**

**Pattern:** [Anything]

**Documentation:** A list of Clapeyron slopes for each phase transition. A positive Clapeyron slope indicates that the phase transition will occur in a greater depth, if the temperature is higher than the one given in Phase transition temperatures and in a smaller depth, if the temperature is smaller than the one given in Phase transition temperatures. For negative slopes the other way round. List must have the same number of entries as Phase transition depths. Units: \si{\pascal\per\kelvin}.

(parameters:Material_20model/Grain_20size_20model/Phase_20transition_20depths)=
### __Parameter name:__ Phase transition depths
**Default value:**

**Pattern:** [Anything]

**Documentation:** A list of depths where phase transitions occur. Values must monotonically increase. Units: \si{\meter}.

(parameters:Material_20model/Grain_20size_20model/Phase_20transition_20pressure_20widths)=
### __Parameter name:__ Phase transition pressure widths
**Default value:**

**Pattern:** [Anything]

**Documentation:** A list of widths for each phase transition, in terms of pressure. The phase functions are scaled with these values, leading to a jump between phases for a value of zero and a gradual transition for larger values. List must have the same number of entries as Phase transition pressures. Define transition by depth instead of pressure must be set to false to use this parameter. Units: \si{\pascal}.

(parameters:Material_20model/Grain_20size_20model/Phase_20transition_20pressures)=
### __Parameter name:__ Phase transition pressures
**Default value:**

**Pattern:** [Anything]

**Documentation:** A list of pressures where phase transitions occur. Values must monotonically increase. Define transition by depth instead of pressure must be set to false to use this parameter. Units: \si{\pascal}.

(parameters:Material_20model/Grain_20size_20model/Phase_20transition_20temperature_20lower_20limits)=
### __Parameter name:__ Phase transition temperature lower limits
**Default value:** -1.7976931348623157e+308

**Pattern:** [Anything]

**Documentation:** A list of lower temperature limits for each phase transition. Below this temperature the respective phase transition is deactivated. The default value means there is no lower limit for any phase transition. List must have the same number of entries as Phase transition depths. When the optional temperature limits are applied, the user has to be careful about the consistency between adjacent phases. Phase transitions should be continuous in pressure-temperature space. We recommend producing a phase diagram with simple model setups to check the implementation as a starting point.Units: \si{\kelvin}.

(parameters:Material_20model/Grain_20size_20model/Phase_20transition_20temperature_20upper_20limits)=
### __Parameter name:__ Phase transition temperature upper limits
**Default value:** 1.7976931348623157e+308

**Pattern:** [Anything]

**Documentation:** A list of upper temperature limits for each phase transition. Above this temperature the respective phase transition is deactivated. The default value means there is no upper limit for any phase transitions. List must have the same number of entries as Phase transition depths. When the optional temperature limits are applied, the user has to be careful about the consistency between adjacent phases. Phase transitions should be continuous in pressure-temperature space. We recommend producing a phase diagram with simple model setups to check the implementation as a starting point.Units: \si{\kelvin}.

(parameters:Material_20model/Grain_20size_20model/Phase_20transition_20temperatures)=
### __Parameter name:__ Phase transition temperatures
**Default value:**

**Pattern:** [Anything]

**Documentation:** A list of temperatures where phase transitions occur. Higher or lower temperatures lead to phase transition occurring in smaller or greater depths than given in Phase transition depths, depending on the Clapeyron slope given in Phase transition Clapeyron slopes. List must have the same number of entries as Phase transition depths. Units: \si{\kelvin}.

(parameters:Material_20model/Grain_20size_20model/Phase_20transition_20widths)=
### __Parameter name:__ Phase transition widths
**Default value:**

**Pattern:** [Anything]

**Documentation:** A list of widths for each phase transition, in terms of depth. The phase functions are scaled with these values, leading to a jump between phases for a value of zero and a gradual transition for larger values. List must have the same number of entries as Phase transition depths. Units: \si{\meter}.

(parameters:Material_20model/Grain_20size_20model/Phase_20volume_20fraction)=
### __Parameter name:__ Phase volume fraction
**Default value:** 0.4

**Pattern:** [Double 0...1 (inclusive)]

**Documentation:** The volume fraction of one of the phases in the two-phase damage model of Bercovici and Ricard (2012). The volume fraction of the other phase can be simply calculated by subtracting from one. This parameter is only used in the pinned state grain damage formulation.Units: none.

(parameters:Material_20model/Grain_20size_20model/Plastic_20damper_20viscosity)=
### __Parameter name:__ Plastic damper viscosity
**Default value:** 0.0

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** Viscosity of the damper that acts in parallel with the plastic viscosity to produce mesh-independent behavior at sufficient resolutions. Units: \si{\pascal\second}

(parameters:Material_20model/Grain_20size_20model/Prefactors_20for_20yield_20stress)=
### __Parameter name:__ Prefactors for yield stress
**Default value:** 1.0

**Pattern:** [Anything]

**Documentation:** List of prefactors for the yield stress, for background material and compositional fields, for a total of N+1 values, where N is the number of all compositional fields or only those corresponding to chemical compositions. The prefactor is multiplied with the yield stress computed from the Drucker-Prager plasticity parameters. Default value is 1.0.

(parameters:Material_20model/Grain_20size_20model/Reciprocal_20required_20strain)=
### __Parameter name:__ Reciprocal required strain
**Default value:** 10.

**Pattern:** [List of <[Double 0...MAX_DOUBLE (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** This parameter ($\lambda$) gives an estimate of the strain necessary to achieve a new grain size. List must have one more entry than the Phase transition depths.

(parameters:Material_20model/Grain_20size_20model/Recrystallized_20grain_20size)=
### __Parameter name:__ Recrystallized grain size
**Default value:**

**Pattern:** [List of <[Double 0...MAX_DOUBLE (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** The grain size $d_{ph}$ to that a phase will be reduced to when crossing a phase transition. When set to zero, grain size will not be reduced. List must have the same number of entries as Phase transition depths. Units: \si{\meter}.

(parameters:Material_20model/Grain_20size_20model/Reference_20compressibility)=
### __Parameter name:__ Reference compressibility
**Default value:** 4e-12

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the reference compressibility. Units: $\frac{1}{\text{Pa}}$.

(parameters:Material_20model/Grain_20size_20model/Reference_20density)=
### __Parameter name:__ Reference density
**Default value:** 3300

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The reference density $\rho_0$. Units: $\frac{\text{kg}}{\text{m}^3}$.

(parameters:Material_20model/Grain_20size_20model/Reference_20specific_20heat)=
### __Parameter name:__ Reference specific heat
**Default value:** 1250.

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the specific heat $cp$. Units: $\frac{\text{J}}{\text{K}\text{kg}}$.

(parameters:Material_20model/Grain_20size_20model/Reference_20temperature)=
### __Parameter name:__ Reference temperature
**Default value:** 293.

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The reference temperature $T_0$. Units: $\text{K}$.

(parameters:Material_20model/Grain_20size_20model/Thermal_20conductivity)=
### __Parameter name:__ Thermal conductivity
**Default value:** 4.7

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the thermal conductivity $k$. Units: $\frac{\text{W}}{\text{m}\text{K}}$$\frac{\text{W}{\text{m}\text{K}}$.

(parameters:Material_20model/Grain_20size_20model/Thermal_20expansion_20coefficient)=
### __Parameter name:__ Thermal expansion coefficient
**Default value:** 2e-5

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the thermal expansion coefficient $\alpha$. Units: $\frac{1}{\text{K}}$.

(parameters:Material_20model/Grain_20size_20model/Use_20Drucker_2dPrager_20rheology)=
### __Parameter name:__ Use Drucker-Prager rheology
**Default value:** false

**Pattern:** [Bool]

**Documentation:** This parameter determines whether to apply plastic yielding according to a Drucker-Prager rheology after computing the viscosity from the (grain-size dependent) viscous creep flow laws (if true) or not (if false).

(parameters:Material_20model/Grain_20size_20model/Use_20adiabatic_20pressure_20for_20yield_20stress)=
### __Parameter name:__ Use adiabatic pressure for yield stress
**Default value:** false

**Pattern:** [Bool]

**Documentation:** Whether to use the adiabatic pressure (if true) instead of the full (non-negative) pressure (if false) when calculating the yield stress. Using the adiabatic pressure (which is analogous to the depth-dependent von Mises model) can be useful to avoid the strong non-linearity associated with dynamic pressure variations affecting the yield strength, which can make the problem ill-posed. However, dynamic pressure can affect the localization of the strain rate and the resulting deformation, and neglecting it therefore changes the solution.

(parameters:Material_20model/Grain_20size_20model/Use_20enthalpy_20for_20material_20properties)=
### __Parameter name:__ Use enthalpy for material properties
**Default value:** true

**Pattern:** [Bool]

**Documentation:** This parameter determines whether to use the enthalpy to calculate the thermal expansivity and specific heat (if true) or use the thermal expansivity and specific heat values from the material properties table directly (if false).

(parameters:Material_20model/Grain_20size_20model/Use_20paleowattmeter)=
### __Parameter name:__ Use paleowattmeter
**Default value:** default

**Pattern:** [Selection true|false|default ]

**Documentation:** A flag indicating whether the computation should use the paleowattmeter approach of Austin and Evans (2007) for grain size reduction in the dislocation creep regime (if true) or the paleopiezometer approach from Hall and Parmetier (2003) (if false). This parameter has been removed. Use &rsquo;Grain size evolution formulation&rsquo; instead.

(parameters:Material_20model/Grain_20size_20model/Use_20plastic_20damper)=
### __Parameter name:__ Use plastic damper
**Default value:** false

**Pattern:** [Bool]

**Documentation:** Whether to use a plastic damper when computing the Drucker-Prager plastic viscosity. The damper acts to stabilize the plastic shear band width and remove associated mesh-dependent behavior at sufficient resolutions.

(parameters:Material_20model/Grain_20size_20model/Use_20table_20properties)=
### __Parameter name:__ Use table properties
**Default value:** false

**Pattern:** [Bool]

**Documentation:** This parameter determines whether to use the table properties also for density, thermal expansivity and specific heat. If false the properties are generated as in the simple compressible plugin.

(parameters:Material_20model/Grain_20size_20model/Viscosity)=
### __Parameter name:__ Viscosity
**Default value:** 5e24

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the constant viscosity. Units: $\text{Pa}\text{s}$.

(parameters:Material_20model/Grain_20size_20model/Work_20fraction_20for_20boundary_20area_20change)=
### __Parameter name:__ Work fraction for boundary area change
**Default value:** 0.1

**Pattern:** [List of <[Double 0...MAX_DOUBLE (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** The fraction $\chi$ of work done by dislocation creep to change the grain boundary area. List must have one more entry than the Phase transition depths. Units: \si{\joule\per\meter\squared}.

(parameters:Material_20model/Grain_20size_20model/Grain_20damage_20partitioning)=
## **Subsection:** Material model / Grain size model / Grain damage partitioning
(parameters:Material_20model/Grain_20size_20model/Grain_20damage_20partitioning/Grain_20size_20reduction_20work_20fraction_20exponent)=
### __Parameter name:__ Grain size reduction work fraction exponent
**Default value:** 10

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** This parameter determines the variability in how much shear heating is partitioned into grain damage. A higher value suggests a wider temperature range over which the partitioning coefficient is high.

(parameters:Material_20model/Grain_20size_20model/Grain_20damage_20partitioning/Maximum_20grain_20size_20reduction_20work_20fraction)=
### __Parameter name:__ Maximum grain size reduction work fraction
**Default value:** 1e-1

**Pattern:** [Double 0...1 (inclusive)]

**Documentation:** This parameter determines the maximum value of the partitioning coefficient, which governs the amount of shear heating partitioned into grain damage in the pinned state limit.

(parameters:Material_20model/Grain_20size_20model/Grain_20damage_20partitioning/Minimum_20grain_20size_20reduction_20work_20fraction)=
### __Parameter name:__ Minimum grain size reduction work fraction
**Default value:** 1e-12

**Pattern:** [Double 0...1 (inclusive)]

**Documentation:** This parameter determines the minimum value of the partitioning coefficient, which governs the amount of shear heating partitioned into grain damage in the pinned state limit.

(parameters:Material_20model/Grain_20size_20model/Grain_20damage_20partitioning/Temperature_20for_20maximum_20grain_20damage_20partitioning)=
### __Parameter name:__ Temperature for maximum grain damage partitioning
**Default value:** 283

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** This parameter determines the temperature at which the computed coefficient of shear energy partitioned into grain damage is maximum. This is used in the pinned state limit of the grain size evolution. One choice of this parameter is the surface temperature of the seafloor, see Mulyukova and Bercovici (2018) for details.

(parameters:Material_20model/Grain_20size_20model/Grain_20damage_20partitioning/Temperature_20for_20minimum_20grain_20damage_20partitioning)=
### __Parameter name:__ Temperature for minimum grain damage partitioning
**Default value:** 1600

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** This parameter determines the temperature at which the computed coefficient of shear energy partitioned into grain damage is minimum. This is used in the pinned state limit of the grain size evolution. One choice of this parameter is the mantle temperature at the ridge axis, see Mulyukova and Bercovici (2018) for details.

(parameters:Material_20model/Latent_20heat)=
## **Subsection:** Material model / Latent heat
(parameters:Material_20model/Latent_20heat/Composition_20viscosity_20prefactor)=
### __Parameter name:__ Composition viscosity prefactor
**Default value:** 1.0

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** A linear dependency of viscosity on composition. Dimensionless prefactor.

(parameters:Material_20model/Latent_20heat/Compressibility)=
### __Parameter name:__ Compressibility
**Default value:** 5.124e-12

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the compressibility $\kappa$. Units: $\frac{1}{\text{Pa}}$.

(parameters:Material_20model/Latent_20heat/Corresponding_20phase_20for_20density_20jump)=
### __Parameter name:__ Corresponding phase for density jump
**Default value:**

**Pattern:** [List of <[Integer range 0...2147483647 (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** A list of phases, which correspond to the Phase transition density jumps. The density jumps occur only in the phase that is given by this phase value. 0 stands for the 1st compositional fields, 1 for the second compositional field and -1 for none of them. List must have the same number of entries as Phase transition depths. Units: \si{\pascal\per\kelvin}.

(parameters:Material_20model/Latent_20heat/Define_20transition_20by_20depth_20instead_20of_20pressure)=
### __Parameter name:__ Define transition by depth instead of pressure
**Default value:** true

**Pattern:** [Bool]

**Documentation:** Whether to list phase transitions by depth or pressure. If this parameter is true, then the input file will use Phase transitions depths and Phase transition widths to define the phase transition. If it is false, the parameter file will read in phase transition data from Phase transition pressures and Phase transition pressure widths.

(parameters:Material_20model/Latent_20heat/Density_20differential_20for_20compositional_20field_201)=
### __Parameter name:__ Density differential for compositional field 1
**Default value:** 0.

**Pattern:** [Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]

**Documentation:** If compositional fields are used, then one would frequently want to make the density depend on these fields. In this simple material model, we make the following assumptions: if no compositional fields are used in the current simulation, then the density is simply the usual one with its linear dependence on the temperature. If there are compositional fields, then the density only depends on the first one in such a way that the density has an additional term of the kind $+\Delta \rho \; c_1(\mathbf x)$. This parameter describes the value of $\Delta \rho$. Units: $\frac{\text{kg}}{\text{m}^3}$/unit change in composition.

(parameters:Material_20model/Latent_20heat/Maximum_20viscosity)=
### __Parameter name:__ Maximum viscosity
**Default value:** 1e24

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** Limit for the maximum viscosity in the model. Units: Pa \, s.

(parameters:Material_20model/Latent_20heat/Minimum_20viscosity)=
### __Parameter name:__ Minimum viscosity
**Default value:** 1e19

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** Limit for the minimum viscosity in the model. Units: Pa \, s.

(parameters:Material_20model/Latent_20heat/Phase_20transition_20Clapeyron_20slopes)=
### __Parameter name:__ Phase transition Clapeyron slopes
**Default value:**

**Pattern:** [Anything]

**Documentation:** A list of Clapeyron slopes for each phase transition. A positive Clapeyron slope indicates that the phase transition will occur in a greater depth, if the temperature is higher than the one given in Phase transition temperatures and in a smaller depth, if the temperature is smaller than the one given in Phase transition temperatures. For negative slopes the other way round. List must have the same number of entries as Phase transition depths. Units: \si{\pascal\per\kelvin}.

(parameters:Material_20model/Latent_20heat/Phase_20transition_20density_20jumps)=
### __Parameter name:__ Phase transition density jumps
**Default value:**

**Pattern:** [List of <[Double 0...MAX_DOUBLE (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** A list of density jumps at each phase transition. A positive value means that the density increases with depth. The corresponding entry in Corresponding phase for density jump determines if the density jump occurs in peridotite, eclogite or none of them.List must have the same number of entries as Phase transition depths. Units: $\frac{\text{kg}}{\text{m}^3}$.

(parameters:Material_20model/Latent_20heat/Phase_20transition_20depths)=
### __Parameter name:__ Phase transition depths
**Default value:**

**Pattern:** [Anything]

**Documentation:** A list of depths where phase transitions occur. Values must monotonically increase. Units: \si{\meter}.

(parameters:Material_20model/Latent_20heat/Phase_20transition_20pressure_20widths)=
### __Parameter name:__ Phase transition pressure widths
**Default value:**

**Pattern:** [Anything]

**Documentation:** A list of widths for each phase transition, in terms of pressure. The phase functions are scaled with these values, leading to a jump between phases for a value of zero and a gradual transition for larger values. List must have the same number of entries as Phase transition pressures. Define transition by depth instead of pressure must be set to false to use this parameter. Units: \si{\pascal}.

(parameters:Material_20model/Latent_20heat/Phase_20transition_20pressures)=
### __Parameter name:__ Phase transition pressures
**Default value:**

**Pattern:** [Anything]

**Documentation:** A list of pressures where phase transitions occur. Values must monotonically increase. Define transition by depth instead of pressure must be set to false to use this parameter. Units: \si{\pascal}.

(parameters:Material_20model/Latent_20heat/Phase_20transition_20temperature_20lower_20limits)=
### __Parameter name:__ Phase transition temperature lower limits
**Default value:** -1.7976931348623157e+308

**Pattern:** [Anything]

**Documentation:** A list of lower temperature limits for each phase transition. Below this temperature the respective phase transition is deactivated. The default value means there is no lower limit for any phase transition. List must have the same number of entries as Phase transition depths. When the optional temperature limits are applied, the user has to be careful about the consistency between adjacent phases. Phase transitions should be continuous in pressure-temperature space. We recommend producing a phase diagram with simple model setups to check the implementation as a starting point.Units: \si{\kelvin}.

(parameters:Material_20model/Latent_20heat/Phase_20transition_20temperature_20upper_20limits)=
### __Parameter name:__ Phase transition temperature upper limits
**Default value:** 1.7976931348623157e+308

**Pattern:** [Anything]

**Documentation:** A list of upper temperature limits for each phase transition. Above this temperature the respective phase transition is deactivated. The default value means there is no upper limit for any phase transitions. List must have the same number of entries as Phase transition depths. When the optional temperature limits are applied, the user has to be careful about the consistency between adjacent phases. Phase transitions should be continuous in pressure-temperature space. We recommend producing a phase diagram with simple model setups to check the implementation as a starting point.Units: \si{\kelvin}.

(parameters:Material_20model/Latent_20heat/Phase_20transition_20temperatures)=
### __Parameter name:__ Phase transition temperatures
**Default value:**

**Pattern:** [Anything]

**Documentation:** A list of temperatures where phase transitions occur. Higher or lower temperatures lead to phase transition occurring in smaller or greater depths than given in Phase transition depths, depending on the Clapeyron slope given in Phase transition Clapeyron slopes. List must have the same number of entries as Phase transition depths. Units: \si{\kelvin}.

(parameters:Material_20model/Latent_20heat/Phase_20transition_20widths)=
### __Parameter name:__ Phase transition widths
**Default value:**

**Pattern:** [Anything]

**Documentation:** A list of widths for each phase transition, in terms of depth. The phase functions are scaled with these values, leading to a jump between phases for a value of zero and a gradual transition for larger values. List must have the same number of entries as Phase transition depths. Units: \si{\meter}.

(parameters:Material_20model/Latent_20heat/Reference_20density)=
### __Parameter name:__ Reference density
**Default value:** 3300.

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** Reference density $\rho_0$. Units: $\frac{\text{kg}}{\text{m}^3}$.

(parameters:Material_20model/Latent_20heat/Reference_20specific_20heat)=
### __Parameter name:__ Reference specific heat
**Default value:** 1250.

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the specific heat $C_p$. Units: $\frac{\text{J}}{\text{K}\text{kg}}$.

(parameters:Material_20model/Latent_20heat/Reference_20temperature)=
### __Parameter name:__ Reference temperature
**Default value:** 293.

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The reference temperature $T_0$. Units: $\text{K}$.

(parameters:Material_20model/Latent_20heat/Thermal_20conductivity)=
### __Parameter name:__ Thermal conductivity
**Default value:** 2.38

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the thermal conductivity $k$. Units: $\frac{\text{W}{\text{m}\text{K}}$.

(parameters:Material_20model/Latent_20heat/Thermal_20expansion_20coefficient)=
### __Parameter name:__ Thermal expansion coefficient
**Default value:** 4e-5

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the thermal expansion coefficient $\beta$. Units: $\frac{1}{\text{K}}$.

(parameters:Material_20model/Latent_20heat/Thermal_20viscosity_20exponent)=
### __Parameter name:__ Thermal viscosity exponent
**Default value:** 0.0

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The temperature dependence of viscosity. Dimensionless exponent.

(parameters:Material_20model/Latent_20heat/Viscosity)=
### __Parameter name:__ Viscosity
**Default value:** 5e24

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the constant viscosity. Units: $\text{Pa}\text{s}$.

(parameters:Material_20model/Latent_20heat/Viscosity_20prefactors)=
### __Parameter name:__ Viscosity prefactors
**Default value:** all:1

**Pattern:** [Anything]

**Documentation:** A list of prefactors for the viscosity for each phase. The &ldquo;Viscosity&rdquo; parameter (modified by the &ldquo;Composition viscosity prefactor&rdquo;, depending on composition) will be multiplied by this factor to get the corresponding viscosity for each phase. List must have the same number of entries as there are phases, that is one more than &ldquo;Phase transition depths&rdquo; for each composition that is used in the model. Units: non-dimensional.

(parameters:Material_20model/Latent_20heat_20melt)=
## **Subsection:** Material model / Latent heat melt
(parameters:Material_20model/Latent_20heat_20melt/A1)=
### __Parameter name:__ A1
**Default value:** 1085.7

**Pattern:** [Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]

**Documentation:** Constant parameter in the quadratic function that approximates the solidus of peridotite. Units: $^{\circ}C$.

(parameters:Material_20model/Latent_20heat_20melt/A2)=
### __Parameter name:__ A2
**Default value:** 1.329e-7

**Pattern:** [Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]

**Documentation:** Prefactor of the linear pressure term in the quadratic function that approximates the solidus of peridotite. Units: $\frac{^{\circ}C}{\text{Pa}}$.

(parameters:Material_20model/Latent_20heat_20melt/A3)=
### __Parameter name:__ A3
**Default value:** -5.1e-18

**Pattern:** [Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]

**Documentation:** Prefactor of the quadratic pressure term in the quadratic function that approximates the solidus of peridotite. Units: $\frac{^{\circ}C}{\text{Pa}^2}$.

(parameters:Material_20model/Latent_20heat_20melt/B1)=
### __Parameter name:__ B1
**Default value:** 1475.0

**Pattern:** [Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]

**Documentation:** Constant parameter in the quadratic function that approximates the lherzolite liquidus used for calculating the fraction of peridotite-derived melt. Units: $^{\circ}C$.

(parameters:Material_20model/Latent_20heat_20melt/B2)=
### __Parameter name:__ B2
**Default value:** 8.0e-8

**Pattern:** [Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]

**Documentation:** Prefactor of the linear pressure term in the quadratic function that approximates the  lherzolite liquidus used for calculating the fraction of peridotite-derived melt. Units: $\frac{^{\circ}C}{\text{Pa}}$.

(parameters:Material_20model/Latent_20heat_20melt/B3)=
### __Parameter name:__ B3
**Default value:** -3.2e-18

**Pattern:** [Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]

**Documentation:** Prefactor of the quadratic pressure term in the quadratic function that approximates the  lherzolite liquidus used for calculating the fraction of peridotite-derived melt. Units: $\frac{^{\circ}C}{\text{Pa}^2}$.

(parameters:Material_20model/Latent_20heat_20melt/C1)=
### __Parameter name:__ C1
**Default value:** 1780.0

**Pattern:** [Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]

**Documentation:** Constant parameter in the quadratic function that approximates the liquidus of peridotite. Units: $^{\circ}C$.

(parameters:Material_20model/Latent_20heat_20melt/C2)=
### __Parameter name:__ C2
**Default value:** 4.50e-8

**Pattern:** [Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]

**Documentation:** Prefactor of the linear pressure term in the quadratic function that approximates the liquidus of peridotite. Units: $\frac{^{\circ}C}{\text{Pa}}$.

(parameters:Material_20model/Latent_20heat_20melt/C3)=
### __Parameter name:__ C3
**Default value:** -2.0e-18

**Pattern:** [Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]

**Documentation:** Prefactor of the quadratic pressure term in the quadratic function that approximates the liquidus of peridotite. Units: $\frac{^{\circ}C}{\text{Pa}^2}$.

(parameters:Material_20model/Latent_20heat_20melt/Composition_20viscosity_20prefactor)=
### __Parameter name:__ Composition viscosity prefactor
**Default value:** 1.0

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** A linear dependency of viscosity on composition. Dimensionless prefactor.

(parameters:Material_20model/Latent_20heat_20melt/Compressibility)=
### __Parameter name:__ Compressibility
**Default value:** 5.124e-12

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the compressibility $\kappa$. Units: $\frac{1}{\text{Pa}}$.

(parameters:Material_20model/Latent_20heat_20melt/D1)=
### __Parameter name:__ D1
**Default value:** 976.0

**Pattern:** [Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]

**Documentation:** Constant parameter in the quadratic function that approximates the solidus of pyroxenite. Units: $^{\circ}C$.

(parameters:Material_20model/Latent_20heat_20melt/D2)=
### __Parameter name:__ D2
**Default value:** 1.329e-7

**Pattern:** [Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]

**Documentation:** Prefactor of the linear pressure term in the quadratic function that approximates the solidus of pyroxenite. Note that this factor is different from the value given in Sobolev, 2011, because they use the potential temperature whereas we use the absolute temperature. Units: $\frac{^{\circ}C}{\text{Pa}}$.

(parameters:Material_20model/Latent_20heat_20melt/D3)=
### __Parameter name:__ D3
**Default value:** -5.1e-18

**Pattern:** [Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]

**Documentation:** Prefactor of the quadratic pressure term in the quadratic function that approximates the solidus of pyroxenite. Units: $\frac{^{\circ}C}{\text{Pa}^2}$.

(parameters:Material_20model/Latent_20heat_20melt/Density_20differential_20for_20compositional_20field_201)=
### __Parameter name:__ Density differential for compositional field 1
**Default value:** 0.

**Pattern:** [Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]

**Documentation:** If compositional fields are used, then one would frequently want to make the density depend on these fields. In this simple material model, we make the following assumptions: if no compositional fields are used in the current simulation, then the density is simply the usual one with its linear dependence on the temperature. If there are compositional fields, then the density only depends on the first one in such a way that the density has an additional term of the kind $+\Delta \rho \; c_1(\mathbf x)$. This parameter describes the value of $\Delta \rho$. Units: $\frac{\text{kg}}{\text{m}^3}$/unit change in composition.

(parameters:Material_20model/Latent_20heat_20melt/E1)=
### __Parameter name:__ E1
**Default value:** 663.8

**Pattern:** [Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]

**Documentation:** Prefactor of the linear depletion term in the quadratic function that approximates the melt fraction of pyroxenite. Units: $\frac{^{\circ}C}{\text{Pa}}$.

(parameters:Material_20model/Latent_20heat_20melt/E2)=
### __Parameter name:__ E2
**Default value:** -611.4

**Pattern:** [Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]

**Documentation:** Prefactor of the quadratic depletion term in the quadratic function that approximates the melt fraction of pyroxenite. Units: $\frac{^{\circ}C}{\text{Pa}^2}$.

(parameters:Material_20model/Latent_20heat_20melt/Mass_20fraction_20cpx)=
### __Parameter name:__ Mass fraction cpx
**Default value:** 0.15

**Pattern:** [Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]

**Documentation:** Mass fraction of clinopyroxene in the peridotite to be molten. Units: non-dimensional.

(parameters:Material_20model/Latent_20heat_20melt/Maximum_20pyroxenite_20melt_20fraction)=
### __Parameter name:__ Maximum pyroxenite melt fraction
**Default value:** 0.5429

**Pattern:** [Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]

**Documentation:** Maximum melt fraction of pyroxenite in this parameterization. At higher temperatures peridotite begins to melt.

(parameters:Material_20model/Latent_20heat_20melt/Peridotite_20melting_20entropy_20change)=
### __Parameter name:__ Peridotite melting entropy change
**Default value:** -300.

**Pattern:** [Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]

**Documentation:** The entropy change for the phase transition from solid to melt of peridotite. Units: $\frac{\text{J}}{\text{K}\text{kg}}$.

(parameters:Material_20model/Latent_20heat_20melt/Pyroxenite_20melting_20entropy_20change)=
### __Parameter name:__ Pyroxenite melting entropy change
**Default value:** -400.

**Pattern:** [Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]

**Documentation:** The entropy change for the phase transition from solid to melt of pyroxenite. Units: $\frac{\text{J}}{\text{K}\text{kg}}$.

(parameters:Material_20model/Latent_20heat_20melt/Reference_20density)=
### __Parameter name:__ Reference density
**Default value:** 3300.

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** Reference density $\rho_0$. Units: $\frac{\text{kg}}{\text{m}^3}$.

(parameters:Material_20model/Latent_20heat_20melt/Reference_20specific_20heat)=
### __Parameter name:__ Reference specific heat
**Default value:** 1250.

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the specific heat $C_p$. Units: $\frac{\text{J}}{\text{K}\text{kg}}$.

(parameters:Material_20model/Latent_20heat_20melt/Reference_20temperature)=
### __Parameter name:__ Reference temperature
**Default value:** 293.

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The reference temperature $T_0$. Units: $\text{K}$.

(parameters:Material_20model/Latent_20heat_20melt/Relative_20density_20of_20melt)=
### __Parameter name:__ Relative density of melt
**Default value:** 0.9

**Pattern:** [Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]

**Documentation:** The relative density of melt compared to the solid material. This means, the density change upon melting is this parameter times the density of solid material.Units: non-dimensional.

(parameters:Material_20model/Latent_20heat_20melt/Thermal_20conductivity)=
### __Parameter name:__ Thermal conductivity
**Default value:** 2.38

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the thermal conductivity $k$. Units: $\frac{\text{W}{\text{m}\text{K}}$.

(parameters:Material_20model/Latent_20heat_20melt/Thermal_20expansion_20coefficient)=
### __Parameter name:__ Thermal expansion coefficient
**Default value:** 4e-5

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the thermal expansion coefficient $\alpha_s$. Units: $\frac{1}{\text{K}}$.

(parameters:Material_20model/Latent_20heat_20melt/Thermal_20expansion_20coefficient_20of_20melt)=
### __Parameter name:__ Thermal expansion coefficient of melt
**Default value:** 6.8e-5

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the thermal expansion coefficient $\alpha_f$. Units: $\frac{1}{\text{K}}$.

(parameters:Material_20model/Latent_20heat_20melt/Thermal_20viscosity_20exponent)=
### __Parameter name:__ Thermal viscosity exponent
**Default value:** 0.0

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The temperature dependence of viscosity. Dimensionless exponent.

(parameters:Material_20model/Latent_20heat_20melt/Viscosity)=
### __Parameter name:__ Viscosity
**Default value:** 5e24

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the constant viscosity. Units: $\text{Pa}\text{s}$.

(parameters:Material_20model/Latent_20heat_20melt/beta)=
### __Parameter name:__ beta
**Default value:** 1.5

**Pattern:** [Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]

**Documentation:** Exponent of the melting temperature in the melt fraction calculation. Units: non-dimensional.

(parameters:Material_20model/Latent_20heat_20melt/r1)=
### __Parameter name:__ r1
**Default value:** 0.5

**Pattern:** [Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]

**Documentation:** Constant in the linear function that approximates the clinopyroxene reaction coefficient. Units: non-dimensional.

(parameters:Material_20model/Latent_20heat_20melt/r2)=
### __Parameter name:__ r2
**Default value:** 8e-11

**Pattern:** [Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]

**Documentation:** Prefactor of the linear pressure term in the linear function that approximates the clinopyroxene reaction coefficient. Units: $\frac{1}{\text{Pa}}$.

(parameters:Material_20model/Melt_20boukare)=
## **Subsection:** Material model / Melt boukare
(parameters:Material_20model/Melt_20boukare/Einstein_20temperatures)=
### __Parameter name:__ Einstein temperatures
**Default value:** 418.1, 561.0, 297.6, 540.2, 505.75, 558.1, 558.1

**Pattern:** [List of <[Double 0...MAX_DOUBLE (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** List of Einstein temperatures for each different endmember.Units: K.

(parameters:Material_20model/Melt_20boukare/Endmember_20names)=
### __Parameter name:__ Endmember names
**Default value:** FeSiO3_bridgmanite, MgSiO3_bridgmanite, FeO_periclase, MgO_periclase, FeO_melt, MgO_melt, SiO2_melt

**Pattern:** [List of <[MultipleSelection MgSiO3_bridgmanite|FeSiO3_bridgmanite|MgO_periclase|FeO_periclase|MgO_melt|FeO_melt|SiO2_melt ]> of length 0...4294967295 (inclusive)]

**Documentation:** Names of the endmember components used in the equation of state and the melting model, and whose parameters are determined by the other input parameters of this material model. The order the parameters are given in has to be the same as the order the endmember names are given in. Units: none.

(parameters:Material_20model/Melt_20boukare/Endmember_20states)=
### __Parameter name:__ Endmember states
**Default value:** solid, solid, solid, solid, melt, melt, melt

**Pattern:** [List of <[MultipleSelection solid|melt ]> of length 0...4294967295 (inclusive)]

**Documentation:** States of the endmember components used in the equation of state and the melting model. For each endmember, this list has to define if they belong to the melt or to the solid. The order the states are given in has to be the same as the order the &rsquo;Endmember names&rsquo; are given in. Units: none.

(parameters:Material_20model/Melt_20boukare/Exponential_20melt_20weakening_20factor)=
### __Parameter name:__ Exponential melt weakening factor
**Default value:** 27

**Pattern:** [Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]

**Documentation:** The porosity dependence of the viscosity. Units: dimensionless.

(parameters:Material_20model/Melt_20boukare/Fe_20mantle_20melting_20temperature)=
### __Parameter name:__ Fe mantle melting temperature
**Default value:** 3424.5

**Pattern:** [Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]

**Documentation:** The melting temperature of one of the components in the melting model, the Fe mantle endmember.Units: K.

(parameters:Material_20model/Melt_20boukare/Fe_20number_20of_20moles)=
### __Parameter name:__ Fe number of moles
**Default value:** 0.48

**Pattern:** [Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]

**Documentation:** The number of moles of Fe atoms mixing on a pseudosite in the mantle lattice, This is needed because we use an empirical model fitting the full Boukare model, and can be changed to reflect partition coefficients from other sources.Units: none.

(parameters:Material_20model/Melt_20boukare/First_20derivatives_20of_20the_20bulk_20modulus)=
### __Parameter name:__ First derivatives of the bulk modulus
**Default value:** 4.14, 4.14, 4.9, 3.95, 5.0802472229003905, 4.25, 4.25

**Pattern:** [List of <[Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** The pressure derivative of the bulk modulus at the reference temperature and reference pressure for each different endmember component.Units: none.

(parameters:Material_20model/Melt_20boukare/Include_20melting_20and_20freezing)=
### __Parameter name:__ Include melting and freezing
**Default value:** true

**Pattern:** [Bool]

**Documentation:** Whether to include melting and freezing (according to a simplified linear melting approximation in the model (if true), or not (if false).

(parameters:Material_20model/Melt_20boukare/Linear_20coefficients_20for_20specific_20heat_20polynomial)=
### __Parameter name:__ Linear coefficients for specific heat polynomial
**Default value:** 6.36191292e-03, -3.31714290e-03, 3.36163516e-03, -6.35318887e-03, -2.41909947e-03, -2.41909947e-03, -2.41909947e-03

**Pattern:** [List of <[Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** The first of three coefficients that are used to compute the specific heat capacities for each different endmember at the reference temperature and reference pressure. This coefficient describes the linear part of the temperature dependence. Units: J/kg/K/K.

(parameters:Material_20model/Melt_20boukare/Melting_20time_20scale_20for_20operator_20splitting)=
### __Parameter name:__ Melting time scale for operator splitting
**Default value:** 1e3

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** In case the operator splitting scheme is used, the porosity field can not be set to a new equilibrium melt fraction instantly, but the model has to provide a melting time scale instead. This time scale defines how fast melting happens, or more specifically, the parameter defines the time after which the deviation of the porosity from the equilibrium melt fraction will be reduced to a fraction of $1/e$. So if the melting time scale is small compared to the time step size, the reaction will be so fast that the porosity is very close to the equilibrium melt fraction after reactions are computed. Conversely, if the melting time scale is large compared to the time step size, almost no melting and freezing will occur.

Also note that the melting time scale has to be larger than or equal to the reaction time step used in the operator splitting scheme, otherwise reactions can not be computed. If the model does not use operator splitting, this parameter is not used. Units: yr or s, depending on the &ldquo;Use years instead of seconds&rdquo; parameter.

(parameters:Material_20model/Melt_20boukare/Mg_20mantle_20melting_20temperature)=
### __Parameter name:__ Mg mantle melting temperature
**Default value:** 4821.2

**Pattern:** [Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]

**Documentation:** The melting temperature of one of the components in the melting model, the Mg mantle endmember.Units: K.

(parameters:Material_20model/Melt_20boukare/Mg_20number_20of_20moles)=
### __Parameter name:__ Mg number of moles
**Default value:** 0.62

**Pattern:** [Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]

**Documentation:** The number of moles of Mg atoms mixing on a pseudosite in the mantle lattice, This is needed because we use an empirical model fitting the full Boukare model, and can be changed to reflect partition coefficients from other sources.Units: none.

(parameters:Material_20model/Melt_20boukare/Molar_20masses)=
### __Parameter name:__ Molar masses
**Default value:** 0.1319287, 0.1003887, 0.0718444, 0.0403044, 0.0707624708, 0.048592178, 0.048592178

**Pattern:** [List of <[Double 0...MAX_DOUBLE (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** Molar masses of the different endmembersUnits: kg/mol.

(parameters:Material_20model/Melt_20boukare/Number_20of_20atoms)=
### __Parameter name:__ Number of atoms
**Default value:** 5.0, 5.0, 2.0, 2.0, 2.092, 2.419, 2.419

**Pattern:** [List of <[Double 0...MAX_DOUBLE (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** Number of atoms per in the formula of each endmember.Units: none.

(parameters:Material_20model/Melt_20boukare/Reference_20bulk_20moduli)=
### __Parameter name:__ Reference bulk moduli
**Default value:** 2.81e11, 2.51e+11, 1.52e11, 1.616e11, 166652774642.11273, 2.317e11, 2.317e11

**Pattern:** [List of <[Double 0...MAX_DOUBLE (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** List of bulk moduli for each different endmember at the reference temperature and reference pressure.Units: Pa.

(parameters:Material_20model/Melt_20boukare/Reference_20bulk_20viscosity)=
### __Parameter name:__ Reference bulk viscosity
**Default value:** 1e22

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the constant bulk viscosity $\xi_0$ of the solid matrix. This viscosity may be modified by both temperature and porosity dependencies. Units: $Pa \, s$.

(parameters:Material_20model/Melt_20boukare/Reference_20enthalpies)=
### __Parameter name:__ Reference enthalpies
**Default value:** -1082910.0, -1442310.0, -262240.0, -601570.0, -195245.49100022088, -538009.8, -538009.8

**Pattern:** [List of <[Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** List of enthalpies at the reference temperature and reference pressure for each different endmember component.Units: J/mol.

(parameters:Material_20model/Melt_20boukare/Reference_20entropies)=
### __Parameter name:__ Reference entropies
**Default value:** 95.0, 62.6, 58.6, 26.5, 95.0299295525918, 64.9, 64.9

**Pattern:** [List of <[Double 0...MAX_DOUBLE (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** List of entropies at the reference temperature and reference pressure for each different endmember component.Units: J/K/mol.

(parameters:Material_20model/Melt_20boukare/Reference_20melt_20viscosity)=
### __Parameter name:__ Reference melt viscosity
**Default value:** 10

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the constant melt viscosity $\eta_f$. Units: $Pa \, s$.

(parameters:Material_20model/Melt_20boukare/Reference_20permeability)=
### __Parameter name:__ Reference permeability
**Default value:** 1e-8

**Pattern:** [Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]

**Documentation:** Reference permeability of the solid host rock.Units: $m^2$.

(parameters:Material_20model/Melt_20boukare/Reference_20pressure)=
### __Parameter name:__ Reference pressure
**Default value:** 1e11

**Pattern:** [Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]

**Documentation:** Reference pressure used to compute the material propertiesof the different endmember components.Units: Pa.

(parameters:Material_20model/Melt_20boukare/Reference_20shear_20viscosity)=
### __Parameter name:__ Reference shear viscosity
**Default value:** 5e20

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the constant viscosity $\eta_0$ of the solid matrix. This viscosity may be modified by both temperature and porosity dependencies. Units: $Pa \, s$.

(parameters:Material_20model/Melt_20boukare/Reference_20specific_20heat_20capacities)=
### __Parameter name:__ Reference specific heat capacities
**Default value:** 139.546209, 161.546581, 52.0016403, 73.1147154, 79.5326013, 79.5326013, 79.5326013

**Pattern:** [List of <[Double 0...MAX_DOUBLE (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** List of specific heat capacities for each different endmember at the reference temperature and reference pressure.Units: J/kg/K.

(parameters:Material_20model/Melt_20boukare/Reference_20temperature)=
### __Parameter name:__ Reference temperature
**Default value:** 298.15

**Pattern:** [Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]

**Documentation:** Reference temperature used to compute the material propertiesof the different endmember components.Units: K.

(parameters:Material_20model/Melt_20boukare/Reference_20thermal_20expansivities)=
### __Parameter name:__ Reference thermal expansivities
**Default value:** 1.87e-05, 1.87e-05, 3.22e-05, 3.11e-05, 2.9614332469401705e-05, 2.06e-05, 2.06e-05

**Pattern:** [List of <[Double 0...MAX_DOUBLE (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** List of thermal expansivities for each different endmember at the reference temperature and reference pressure.Units: 1/K.

(parameters:Material_20model/Melt_20boukare/Reference_20volumes)=
### __Parameter name:__ Reference volumes
**Default value:** 2.534e-05, 2.445e-05, 1.206e-05, 1.125e-05, 1.2325484447664221e-05, 1.218e-05, 1.218e-05

**Pattern:** [List of <[Double 0...MAX_DOUBLE (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** Reference volumes of the different endmembers.Units: $m^3$.

(parameters:Material_20model/Melt_20boukare/Second_20coefficients_20for_20specific_20heat_20polynomial)=
### __Parameter name:__ Second coefficients for specific heat polynomial
**Default value:** -4.13886524e+06, -3.57533814e+06, -1.19540964e+06, -7.33679285e+05, -1.61692272e+06, -1.61692272e+06, -1.61692272e+06

**Pattern:** [List of <[Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** The second of three coefficients that are used to compute the specific heat capacities for each different endmember at the reference temperature and reference pressure. This coefficient describes the part of the temperature dependence that scales as the inverse of the square of the temperature. Units: J K/kg.

(parameters:Material_20model/Melt_20boukare/Second_20derivatives_20of_20the_20bulk_20modulus)=
### __Parameter name:__ Second derivatives of the bulk modulus
**Default value:** -1.6e-11, -1.6e-11, -3.2e-11, -2.4e-11, -3.9742163085937504e-11, -2.14e-11, -2.14e-11

**Pattern:** [List of <[Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** The second pressure derivative of the bulk modulus at the reference temperature and reference pressure for each different endmember component.Units: 1/Pa.

(parameters:Material_20model/Melt_20boukare/Thermal_20bulk_20viscosity_20exponent)=
### __Parameter name:__ Thermal bulk viscosity exponent
**Default value:** 0.0

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The temperature dependence of the bulk viscosity. Dimensionless exponent. See the general documentation of this model for a formula that states the dependence of the viscosity on this factor, which is called $\beta$ there.

(parameters:Material_20model/Melt_20boukare/Thermal_20conductivity)=
### __Parameter name:__ Thermal conductivity
**Default value:** 4.7

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the thermal conductivity $k$. Units: $W/m/K$.

(parameters:Material_20model/Melt_20boukare/Thermal_20viscosity_20exponent)=
### __Parameter name:__ Thermal viscosity exponent
**Default value:** 0.0

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The temperature dependence of the shear viscosity. Dimensionless exponent. See the general documentation of this model for a formula that states the dependence of the viscosity on this factor, which is called $\beta$ there.

(parameters:Material_20model/Melt_20boukare/Third_20coefficients_20for_20specific_20heat_20polynomial)=
### __Parameter name:__ Third coefficients for specific heat polynomial
**Default value:** -464.775577, -1112.54791, 25.5067110, -592.994207, -562.222634, -562.222634, -562.222634

**Pattern:** [List of <[Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** The third of three coefficients that are used to compute the specific heat capacities for each different endmember at the reference temperature and reference pressure. This coefficient describes the part of the temperature dependence that scales as the inverse of the square root of the temperatureUnits: J/kg/sqrt(K).

(parameters:Material_20model/Melt_20global)=
## **Subsection:** Material model / Melt global
(parameters:Material_20model/Melt_20global/Depletion_20density_20change)=
### __Parameter name:__ Depletion density change
**Default value:** 0.0

**Pattern:** [Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]

**Documentation:** The density contrast between material with a depletion of 1 and a depletion of zero. Negative values indicate lower densities of depleted material. Depletion is indicated by the compositional field with the name peridotite. Not used if this field does not exist in the model. Units: $\frac{\text{kg}}{\text{m}^3}$.

(parameters:Material_20model/Melt_20global/Depletion_20solidus_20change)=
### __Parameter name:__ Depletion solidus change
**Default value:** 200.0

**Pattern:** [Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]

**Documentation:** The solidus temperature change for a depletion of 100\%. For positive values, the solidus gets increased for a positive peridotite field (depletion) and lowered for a negative peridotite field (enrichment). Scaling with depletion is linear. Only active when fractional melting is used. Units: $\text{K}$.

(parameters:Material_20model/Melt_20global/Exponential_20depletion_20strengthening_20factor)=
### __Parameter name:__ Exponential depletion strengthening factor
**Default value:** 0.0

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** $\alpha_F$: exponential dependency of viscosity on the depletion field $F$ (called peridotite). Dimensionless factor. With a value of 0.0 (the default) the viscosity does not depend on the depletion. The effective viscosity increasedue to depletion is defined as $std::exp( \alpha_F * F)$. Rationale: melting dehydrates the source rock by removing most of the volatiles,and makes it stronger. Hirth and Kohlstedt (1996) report typical values around a factor 100 to 1000 viscosity contrast between wet and dry rocks, although some experimental studies report a smaller (factor 10) contrast (e.g. Fei et al., 2013).

(parameters:Material_20model/Melt_20global/Exponential_20melt_20weakening_20factor)=
### __Parameter name:__ Exponential melt weakening factor
**Default value:** 27.

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The porosity dependence of the viscosity. Units: dimensionless.

(parameters:Material_20model/Melt_20global/Include_20melting_20and_20freezing)=
### __Parameter name:__ Include melting and freezing
**Default value:** true

**Pattern:** [Bool]

**Documentation:** Whether to include melting and freezing (according to a simplified linear melting approximation in the model (if true), or not (if false).

(parameters:Material_20model/Melt_20global/Maximum_20Depletion_20viscosity_20change)=
### __Parameter name:__ Maximum Depletion viscosity change
**Default value:** 1.0e3

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** $\Delta \eta_{F,max}$: maximum depletion strengthening of viscosity. Rationale: melting dehydrates the source rock by removing most of the volatiles,and makes it stronger. Hirth and Kohlstedt (1996) report typical values around a factor 100 to 1000 viscosity contrast between wet and dry rocks, although some experimental studies report a smaller (factor 10) contrast (e.g. Fei et al., 2013).

(parameters:Material_20model/Melt_20global/Melt_20bulk_20modulus_20derivative)=
### __Parameter name:__ Melt bulk modulus derivative
**Default value:** 0.0

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the pressure derivative of the melt bulk modulus. Units: None.

(parameters:Material_20model/Melt_20global/Melt_20compressibility)=
### __Parameter name:__ Melt compressibility
**Default value:** 0.0

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the compressibility of the melt. Units: $\frac{1}{\text{Pa}}$.

(parameters:Material_20model/Melt_20global/Melting_20time_20scale_20for_20operator_20splitting)=
### __Parameter name:__ Melting time scale for operator splitting
**Default value:** 1e3

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** In case the operator splitting scheme is used, the porosity field can not be set to a new equilibrium melt fraction instantly, but the model has to provide a melting time scale instead. This time scale defines how fast melting happens, or more specifically, the parameter defines the time after which the deviation of the porosity from the equilibrium melt fraction will be reduced to a fraction of $1/e$. So if the melting time scale is small compared to the time step size, the reaction will be so fast that the porosity is very close to the equilibrium melt fraction after reactions are computed. Conversely, if the melting time scale is large compared to the time step size, almost no melting and freezing will occur.

Also note that the melting time scale has to be larger than or equal to the reaction time step used in the operator splitting scheme, otherwise reactions can not be computed. If the model does not use operator splitting, this parameter is not used. Units: yr or s, depending on the &ldquo;Use years instead of seconds&rdquo; parameter.

(parameters:Material_20model/Melt_20global/Pressure_20solidus_20change)=
### __Parameter name:__ Pressure solidus change
**Default value:** 6e-8

**Pattern:** [Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]

**Documentation:** The linear solidus temperature change with pressure. For positive values, the solidus gets increased for positive pressures. Units: $\frac{1}{\text{Pa}}$.

(parameters:Material_20model/Melt_20global/Reference_20bulk_20viscosity)=
### __Parameter name:__ Reference bulk viscosity
**Default value:** 1e22

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the constant bulk viscosity $\xi_0$ of the solid matrix. This viscosity may be modified by both temperature and porosity dependencies. Units: $\text{Pa}\text{s}$.

(parameters:Material_20model/Melt_20global/Reference_20melt_20density)=
### __Parameter name:__ Reference melt density
**Default value:** 2500.

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** Reference density of the melt/fluid$\rho_{f,0}$. Units: $\frac{\text{kg}}{\text{m}^3}$.

(parameters:Material_20model/Melt_20global/Reference_20melt_20viscosity)=
### __Parameter name:__ Reference melt viscosity
**Default value:** 10.

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the constant melt viscosity $\eta_f$. Units: $\text{Pa}\text{s}$.

(parameters:Material_20model/Melt_20global/Reference_20permeability)=
### __Parameter name:__ Reference permeability
**Default value:** 1e-8

**Pattern:** [Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]

**Documentation:** Reference permeability of the solid host rock.Units: \si{\meter\squared}.

(parameters:Material_20model/Melt_20global/Reference_20shear_20viscosity)=
### __Parameter name:__ Reference shear viscosity
**Default value:** 5e20

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the constant viscosity $\eta_0$ of the solid matrix. This viscosity may be modified by both temperature and porosity dependencies. Units: $\text{Pa}\text{s}$.

(parameters:Material_20model/Melt_20global/Reference_20solid_20density)=
### __Parameter name:__ Reference solid density
**Default value:** 3000.

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** Reference density of the solid $\rho_{s,0}$. Units: $\frac{\text{kg}}{\text{m}^3}$.

(parameters:Material_20model/Melt_20global/Reference_20specific_20heat)=
### __Parameter name:__ Reference specific heat
**Default value:** 1250.

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the specific heat $C_p$. Units: $\frac{\text{J}}{\text{K}\text{kg}}$.

(parameters:Material_20model/Melt_20global/Reference_20temperature)=
### __Parameter name:__ Reference temperature
**Default value:** 293.

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The reference temperature $T_0$. The reference temperature is used in both the density and viscosity formulas. Units: $\text{K}$.

(parameters:Material_20model/Melt_20global/Solid_20compressibility)=
### __Parameter name:__ Solid compressibility
**Default value:** 0.0

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the compressibility of the solid matrix. Units: $\frac{1}{\text{Pa}}$.

(parameters:Material_20model/Melt_20global/Surface_20solidus)=
### __Parameter name:__ Surface solidus
**Default value:** 1300.

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** Solidus for a pressure of zero. Units: $\text{K}$.

(parameters:Material_20model/Melt_20global/Thermal_20bulk_20viscosity_20exponent)=
### __Parameter name:__ Thermal bulk viscosity exponent
**Default value:** 0.0

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The temperature dependence of the bulk viscosity. Dimensionless exponent. See the general documentation of this model for a formula that states the dependence of the viscosity on this factor, which is called $\beta$ there.

(parameters:Material_20model/Melt_20global/Thermal_20conductivity)=
### __Parameter name:__ Thermal conductivity
**Default value:** 4.7

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the thermal conductivity $k$. Units: $\frac{\text{W}{\text{m}\text{K}}$.

(parameters:Material_20model/Melt_20global/Thermal_20expansion_20coefficient)=
### __Parameter name:__ Thermal expansion coefficient
**Default value:** 2e-5

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the thermal expansion coefficient $\beta$. Units: $\frac{1}{\text{K}}$.

(parameters:Material_20model/Melt_20global/Thermal_20viscosity_20exponent)=
### __Parameter name:__ Thermal viscosity exponent
**Default value:** 0.0

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The temperature dependence of the shear viscosity. Dimensionless exponent. See the general documentation of this model for a formula that states the dependence of the viscosity on this factor, which is called $\beta$ there.

(parameters:Material_20model/Melt_20simple)=
## **Subsection:** Material model / Melt simple
(parameters:Material_20model/Melt_20simple/A1)=
### __Parameter name:__ A1
**Default value:** 1085.7

**Pattern:** [Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]

**Documentation:** Constant parameter in the quadratic function that approximates the solidus of peridotite. Units: $^{\circ}C$.

(parameters:Material_20model/Melt_20simple/A2)=
### __Parameter name:__ A2
**Default value:** 1.329e-7

**Pattern:** [Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]

**Documentation:** Prefactor of the linear pressure term in the quadratic function that approximates the solidus of peridotite. Units: $\frac{^{\circ}C}{\text{Pa}}$.

(parameters:Material_20model/Melt_20simple/A3)=
### __Parameter name:__ A3
**Default value:** -5.1e-18

**Pattern:** [Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]

**Documentation:** Prefactor of the quadratic pressure term in the quadratic function that approximates the solidus of peridotite. Units: $\frac{^{\circ}C}{\text{Pa}^2}$.

(parameters:Material_20model/Melt_20simple/B1)=
### __Parameter name:__ B1
**Default value:** 1475.0

**Pattern:** [Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]

**Documentation:** Constant parameter in the quadratic function that approximates the lherzolite liquidus used for calculating the fraction of peridotite-derived melt. Units: $^{\circ}C$.

(parameters:Material_20model/Melt_20simple/B2)=
### __Parameter name:__ B2
**Default value:** 8.0e-8

**Pattern:** [Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]

**Documentation:** Prefactor of the linear pressure term in the quadratic function that approximates the  lherzolite liquidus used for calculating the fraction of peridotite-derived melt. Units: $\frac{^{\circ}C}{\text{Pa}}$.

(parameters:Material_20model/Melt_20simple/B3)=
### __Parameter name:__ B3
**Default value:** -3.2e-18

**Pattern:** [Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]

**Documentation:** Prefactor of the quadratic pressure term in the quadratic function that approximates the  lherzolite liquidus used for calculating the fraction of peridotite-derived melt. Units: $\frac{^{\circ}C}{\text{Pa}^2}$.

(parameters:Material_20model/Melt_20simple/C1)=
### __Parameter name:__ C1
**Default value:** 1780.0

**Pattern:** [Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]

**Documentation:** Constant parameter in the quadratic function that approximates the liquidus of peridotite. Units: $^{\circ}C$.

(parameters:Material_20model/Melt_20simple/C2)=
### __Parameter name:__ C2
**Default value:** 4.50e-8

**Pattern:** [Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]

**Documentation:** Prefactor of the linear pressure term in the quadratic function that approximates the liquidus of peridotite. Units: $\frac{^{\circ}C}{\text{Pa}}$.

(parameters:Material_20model/Melt_20simple/C3)=
### __Parameter name:__ C3
**Default value:** -2.0e-18

**Pattern:** [Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]

**Documentation:** Prefactor of the quadratic pressure term in the quadratic function that approximates the liquidus of peridotite. Units: $\frac{^{\circ}C}{\text{Pa}^2}$.

(parameters:Material_20model/Melt_20simple/Depletion_20density_20change)=
### __Parameter name:__ Depletion density change
**Default value:** 0.0

**Pattern:** [Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]

**Documentation:** The density contrast between material with a depletion of 1 and a depletion of zero. Negative values indicate lower densities of depleted material. Depletion is indicated by the compositional field with the name peridotite. Not used if this field does not exist in the model. Units: $\frac{\text{kg}}{\text{m}^3}$.

(parameters:Material_20model/Melt_20simple/Depletion_20solidus_20change)=
### __Parameter name:__ Depletion solidus change
**Default value:** 200.0

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The solidus temperature change for a depletion of 100\%. For positive values, the solidus gets increased for a positive peridotite field (depletion) and lowered for a negative peridotite field (enrichment). Scaling with depletion is linear. Only active when fractional melting is used. Units: $\text{K}$.

(parameters:Material_20model/Melt_20simple/Exponential_20melt_20weakening_20factor)=
### __Parameter name:__ Exponential melt weakening factor
**Default value:** 27.

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The porosity dependence of the viscosity. Units: dimensionless.

(parameters:Material_20model/Melt_20simple/Freezing_20rate)=
### __Parameter name:__ Freezing rate
**Default value:** 0.0

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** Freezing rate of melt when in subsolidus regions. If this parameter is set to a number larger than 0.0, it specifies the fraction of melt that will freeze per year (or per second, depending on the &ldquo;Use years instead of seconds&rdquo; parameter), as soon as the porosity exceeds the equilibrium melt fraction, and the equilibrium melt fraction falls below the depletion. In this case, melt will freeze according to the given rate until one of those conditions is not fulfilled anymore. The reasoning behind this is that there should not be more melt present than the equilibrium melt fraction, as melt production decreases with increasing depletion, but the freezing process of melt also reduces the depletion by the same amount, and as soon as the depletion falls below the equilibrium melt fraction, we expect that material should melt again (no matter how much melt is present). This is quite a simplification and not a realistic freezing parameterization, but without tracking the melt composition, there is no way to compute freezing rates accurately. If this parameter is set to zero, no freezing will occur. Note that freezing can never be faster than determined by the &ldquo;Melting time scale for operator splitting&rdquo;. The product of the &ldquo;Freezing rate&rdquo; and the &ldquo;Melting time scale for operator splitting&rdquo; defines how fast freezing occurs with respect to melting (if the product is 0.5, melting will occur twice as fast as freezing). Units: 1/yr or 1/s, depending on the &ldquo;Use years instead of seconds&rdquo; parameter.

(parameters:Material_20model/Melt_20simple/Mass_20fraction_20cpx)=
### __Parameter name:__ Mass fraction cpx
**Default value:** 0.15

**Pattern:** [Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]

**Documentation:** Mass fraction of clinopyroxene in the peridotite to be molten. Units: non-dimensional.

(parameters:Material_20model/Melt_20simple/Melt_20bulk_20modulus_20derivative)=
### __Parameter name:__ Melt bulk modulus derivative
**Default value:** 0.0

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the pressure derivative of the melt bulk modulus. Units: None.

(parameters:Material_20model/Melt_20simple/Melt_20compressibility)=
### __Parameter name:__ Melt compressibility
**Default value:** 0.0

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the compressibility of the melt. Units: $\frac{1}{\text{Pa}}$.

(parameters:Material_20model/Melt_20simple/Melt_20extraction_20depth)=
### __Parameter name:__ Melt extraction depth
**Default value:** 1000.0

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** Depth above that melt will be extracted from the model, which is done by a negative reaction term proportional to the porosity field. Units: \si{\meter}.

(parameters:Material_20model/Melt_20simple/Melting_20time_20scale_20for_20operator_20splitting)=
### __Parameter name:__ Melting time scale for operator splitting
**Default value:** 1e3

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** Because the operator splitting scheme is used, the porosity field can not be set to a new equilibrium melt fraction instantly, but the model has to provide a melting time scale instead. This time scale defines how fast melting happens, or more specifically, the parameter defines the time after which the deviation of the porosity from the equilibrium melt fraction will be reduced to a fraction of $1/e$. So if the melting time scale is small compared to the time step size, the reaction will be so fast that the porosity is very close to the equilibrium melt fraction after reactions are computed. Conversely, if the melting time scale is large compared to the time step size, almost no melting and freezing will occur.

Also note that the melting time scale has to be larger than or equal to the reaction time step used in the operator splitting scheme, otherwise reactions can not be computed. Units: yr or s, depending on the &ldquo;Use years instead of seconds&rdquo; parameter.

(parameters:Material_20model/Melt_20simple/Peridotite_20melting_20entropy_20change)=
### __Parameter name:__ Peridotite melting entropy change
**Default value:** -300.

**Pattern:** [Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]

**Documentation:** The entropy change for the phase transition from solid to melt of peridotite. Units: $\frac{\text{J}}{\text{K}\text{kg}}$.

(parameters:Material_20model/Melt_20simple/Reference_20bulk_20viscosity)=
### __Parameter name:__ Reference bulk viscosity
**Default value:** 1e22

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the constant bulk viscosity $\xi_0$ of the solid matrix. This viscosity may be modified by both temperature and porosity dependencies. Units: $\text{Pa}\text{s}$.

(parameters:Material_20model/Melt_20simple/Reference_20melt_20density)=
### __Parameter name:__ Reference melt density
**Default value:** 2500.

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** Reference density of the melt/fluid$\rho_{f,0}$. Units: $\frac{\text{kg}}{\text{m}^3}$.

(parameters:Material_20model/Melt_20simple/Reference_20melt_20viscosity)=
### __Parameter name:__ Reference melt viscosity
**Default value:** 10.

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the constant melt viscosity $\eta_f$. Units: $\text{Pa}\text{s}$.

(parameters:Material_20model/Melt_20simple/Reference_20permeability)=
### __Parameter name:__ Reference permeability
**Default value:** 1e-8

**Pattern:** [Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]

**Documentation:** Reference permeability of the solid host rock.Units: \si{\meter\squared}.

(parameters:Material_20model/Melt_20simple/Reference_20shear_20viscosity)=
### __Parameter name:__ Reference shear viscosity
**Default value:** 5e20

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the constant viscosity $\eta_0$ of the solid matrix. This viscosity may be modified by both temperature and porosity dependencies. Units: $\text{Pa}\text{s}$.

(parameters:Material_20model/Melt_20simple/Reference_20solid_20density)=
### __Parameter name:__ Reference solid density
**Default value:** 3000.

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** Reference density of the solid $\rho_{s,0}$. Units: $\frac{\text{kg}}{\text{m}^3}$.

(parameters:Material_20model/Melt_20simple/Reference_20specific_20heat)=
### __Parameter name:__ Reference specific heat
**Default value:** 1250.

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the specific heat $C_p$. Units: $\frac{\text{J}}{\text{K}\text{kg}}$.

(parameters:Material_20model/Melt_20simple/Reference_20temperature)=
### __Parameter name:__ Reference temperature
**Default value:** 293.

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The reference temperature $T_0$. The reference temperature is used in both the density and viscosity formulas. Units: $\text{K}$.

(parameters:Material_20model/Melt_20simple/Solid_20compressibility)=
### __Parameter name:__ Solid compressibility
**Default value:** 0.0

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the compressibility of the solid matrix. Units: $\frac{1}{\text{Pa}}$.

(parameters:Material_20model/Melt_20simple/Thermal_20bulk_20viscosity_20exponent)=
### __Parameter name:__ Thermal bulk viscosity exponent
**Default value:** 0.0

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The temperature dependence of the bulk viscosity. Dimensionless exponent. See the general documentation of this model for a formula that states the dependence of the viscosity on this factor, which is called $\beta$ there.

(parameters:Material_20model/Melt_20simple/Thermal_20conductivity)=
### __Parameter name:__ Thermal conductivity
**Default value:** 4.7

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the thermal conductivity $k$. Units: $\frac{\text{W}{\text{m}\text{K}}$.

(parameters:Material_20model/Melt_20simple/Thermal_20expansion_20coefficient)=
### __Parameter name:__ Thermal expansion coefficient
**Default value:** 2e-5

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the thermal expansion coefficient $\beta$. Units: $\frac{1}{\text{K}}$.

(parameters:Material_20model/Melt_20simple/Thermal_20viscosity_20exponent)=
### __Parameter name:__ Thermal viscosity exponent
**Default value:** 0.0

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The temperature dependence of the shear viscosity. Dimensionless exponent. See the general documentation of this model for a formula that states the dependence of the viscosity on this factor, which is called $\beta$ there.

(parameters:Material_20model/Melt_20simple/Use_20fractional_20melting)=
### __Parameter name:__ Use fractional melting
**Default value:** false

**Pattern:** [Bool]

**Documentation:** If fractional melting should be used (if true), including a solidus change based on depletion (in this case, the amount of melt that has migrated away from its origin), and freezing of melt when it has moved to a region with temperatures lower than the solidus; or if batch melting should be used (if false), assuming that the melt fraction only depends on temperature and pressure, and how much melt has already been generated at a given point, but not considering movement of melt in the melting parameterization.

Note that melt does not freeze unless the &rsquo;Freezing rate&rsquo; parameter is set to a value larger than 0.

(parameters:Material_20model/Melt_20simple/Use_20full_20compressibility)=
### __Parameter name:__ Use full compressibility
**Default value:** false

**Pattern:** [Bool]

**Documentation:** If the compressibility should be used everywhere in the code (if true), changing the volume of material when the density changes, or only in the momentum conservation and advection equations (if false).

(parameters:Material_20model/Melt_20simple/beta)=
### __Parameter name:__ beta
**Default value:** 1.5

**Pattern:** [Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]

**Documentation:** Exponent of the melting temperature in the melt fraction calculation. Units: non-dimensional.

(parameters:Material_20model/Melt_20simple/r1)=
### __Parameter name:__ r1
**Default value:** 0.5

**Pattern:** [Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]

**Documentation:** Constant in the linear function that approximates the clinopyroxene reaction coefficient. Units: non-dimensional.

(parameters:Material_20model/Melt_20simple/r2)=
### __Parameter name:__ r2
**Default value:** 8e-11

**Pattern:** [Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]

**Documentation:** Prefactor of the linear pressure term in the linear function that approximates the clinopyroxene reaction coefficient. Units: $\frac{1}{\text{Pa}}$.

(parameters:Material_20model/Modified_20Tait_20model)=
## **Subsection:** Material model / Modified Tait model
(parameters:Material_20model/Modified_20Tait_20model/Einstein_20temperature)=
### __Parameter name:__ Einstein temperature
**Default value:** 600.

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The Einstein temperature at the reference pressure and temperature. Units: $\text{K}$.

(parameters:Material_20model/Modified_20Tait_20model/Reference_20bulk_20modulus_20derivative)=
### __Parameter name:__ Reference bulk modulus derivative
**Default value:** 4.

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the first pressure derivative of the isothermal bulk modulus at the reference pressure and temperature. Units: None.

(parameters:Material_20model/Modified_20Tait_20model/Reference_20density)=
### __Parameter name:__ Reference density
**Default value:** 3300.

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The density at the reference pressure and temperature. Units: $\frac{\text{kg}}{\text{m}^3}$.

(parameters:Material_20model/Modified_20Tait_20model/Reference_20isothermal_20bulk_20modulus)=
### __Parameter name:__ Reference isothermal bulk modulus
**Default value:** 125e9

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The isothermal bulk modulus at the reference pressure and temperature. Units: \si{\pascal}.

(parameters:Material_20model/Modified_20Tait_20model/Reference_20pressure)=
### __Parameter name:__ Reference pressure
**Default value:** 1e5

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** Reference pressure $P_0$. Units: \si{\pascal}.

(parameters:Material_20model/Modified_20Tait_20model/Reference_20temperature)=
### __Parameter name:__ Reference temperature
**Default value:** 298.15

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** Reference temperature $T_0$. Units: $\text{K}$.

(parameters:Material_20model/Modified_20Tait_20model/Reference_20thermal_20expansivity)=
### __Parameter name:__ Reference thermal expansivity
**Default value:** 2e-5

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The thermal expansion coefficient at the reference pressure and temperature. Units: $\frac{1}{\text{K}}$.

(parameters:Material_20model/Modified_20Tait_20model/Thermal_20conductivity)=
### __Parameter name:__ Thermal conductivity
**Default value:** 4.7

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the constant thermal conductivity $k$. Units: $\frac{\text{W}{\text{m}\text{K}}$.

(parameters:Material_20model/Modified_20Tait_20model/Viscosity)=
### __Parameter name:__ Viscosity
**Default value:** 1e21

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the constant viscosity $\eta_0$. Units: $\text{Pa}\text{s}$.

(parameters:Material_20model/Modified_20Tait_20model/Reference_20heat_20capacity_20function)=
## **Subsection:** Material model / Modified Tait model / Reference heat capacity function
(parameters:Material_20model/Modified_20Tait_20model/Reference_20heat_20capacity_20function/Function_20constants)=
### __Parameter name:__ Function constants
**Default value:**

**Pattern:** [Anything]

**Documentation:** Sometimes it is convenient to use symbolic constants in the expression that describes the function, rather than having to use its numeric value everywhere the constant appears. These values can be defined using this parameter, in the form &lsquo;var1=value1, var2=value2, ...&rsquo;.

A typical example would be to set this runtime parameter to &lsquo;pi=3.1415926536&rsquo; and then use &lsquo;pi&rsquo; in the expression of the actual formula. (That said, for convenience this class actually defines both &lsquo;pi&rsquo; and &lsquo;Pi&rsquo; by default, but you get the idea.)

(parameters:Material_20model/Modified_20Tait_20model/Reference_20heat_20capacity_20function/Function_20expression)=
### __Parameter name:__ Function expression
**Default value:** 1.25e3

**Pattern:** [Anything]

**Documentation:**

(parameters:Material_20model/Modified_20Tait_20model/Reference_20heat_20capacity_20function/Variable_20names)=
### __Parameter name:__ Variable names
**Default value:** x,t

**Pattern:** [Anything]

**Documentation:** The names of the variables as they will be used in the function, separated by commas. By default, the names of variables at which the function will be evaluated are &lsquo;x&rsquo; (in 1d), &lsquo;x,y&rsquo; (in 2d) or &lsquo;x,y,z&rsquo; (in 3d) for spatial coordinates and &lsquo;t&rsquo; for time. You can then use these variable names in your function expression and they will be replaced by the values of these variables at which the function is currently evaluated. However, you can also choose a different set of names for the independent variables at which to evaluate your function expression. For example, if you work in spherical coordinates, you may wish to set this input parameter to &lsquo;r,phi,theta,t&rsquo; and then use these variable names in your function expression.

(parameters:Material_20model/Multicomponent)=
## **Subsection:** Material model / Multicomponent
(parameters:Material_20model/Multicomponent/Densities)=
### __Parameter name:__ Densities
**Default value:** 3300.

**Pattern:** [Anything]

**Documentation:** List of densities for background mantle and compositional fields,for a total of N+M+1 values, where N is the number of compositional fields and M is the number of phases. If only one value is given, then all use the same value. Units: \si{\kilogram\per\meter\cubed}.

(parameters:Material_20model/Multicomponent/Heat_20capacities)=
### __Parameter name:__ Heat capacities
**Default value:** 1250.

**Pattern:** [Anything]

**Documentation:** List of specific heats $C_p$ for background mantle and compositional fields,for a total of N+M+1 values, where N is the number of compositional fields and M is the number of phases. If only one value is given, then all use the same value. Units: \si{\joule\per\kelvin\per\kilogram}.

(parameters:Material_20model/Multicomponent/Reference_20temperature)=
### __Parameter name:__ Reference temperature
**Default value:** 293.

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The reference temperature $T_0$. Units: $\text{K}$.

(parameters:Material_20model/Multicomponent/Specific_20heats)=
### __Parameter name__: Specific heats
**Alias:** [Heat capacities](parameters:Material_20model/Multicomponent/Heat_20capacities)

**Deprecation Status:** false

(parameters:Material_20model/Multicomponent/Thermal_20conductivities)=
### __Parameter name:__ Thermal conductivities
**Default value:** 4.7

**Pattern:** [Anything]

**Documentation:** List of thermal conductivities for background mantle and compositional fields,for a total of N+1 values, where N is the number of compositional fields.If only one value is given, then all use the same value. Units: $\frac{\text{W}{\text{m}\text{K}}$.

(parameters:Material_20model/Multicomponent/Thermal_20expansivities)=
### __Parameter name:__ Thermal expansivities
**Default value:** 0.000040

**Pattern:** [Anything]

**Documentation:** List of thermal expansivities for background mantle and compositional fields,for a total of N+M+1 values, where N is the number of compositional fields and M is the number of phases. If only one value is given, then all use the same value. Units: \si{\per\kelvin}.

(parameters:Material_20model/Multicomponent/Viscosities)=
### __Parameter name:__ Viscosities
**Default value:** 1.e21

**Pattern:** [Anything]

**Documentation:** List of viscosities for background mantle and compositional fields,for a total of N+1 values, where N is the number of compositional fields.If only one value is given, then all use the same value. Units: $\text{Pa}\text{s}$.

(parameters:Material_20model/Multicomponent/Viscosity_20averaging_20scheme)=
### __Parameter name:__ Viscosity averaging scheme
**Default value:** harmonic

**Pattern:** [Selection arithmetic|harmonic|geometric|maximum composition ]

**Documentation:** When more than one compositional field is present at a point with different viscosities, we need to come up with an average viscosity at that point.  Select a weighted harmonic, arithmetic, geometric, or maximum composition.

(parameters:Material_20model/Multicomponent_20compressible)=
## **Subsection:** Material model / Multicomponent compressible
(parameters:Material_20model/Multicomponent_20compressible/Define_20transition_20by_20depth_20instead_20of_20pressure)=
### __Parameter name:__ Define transition by depth instead of pressure
**Default value:** true

**Pattern:** [Bool]

**Documentation:** Whether to list phase transitions by depth or pressure. If this parameter is true, then the input file will use Phase transitions depths and Phase transition widths to define the phase transition. If it is false, the parameter file will read in phase transition data from Phase transition pressures and Phase transition pressure widths.

(parameters:Material_20model/Multicomponent_20compressible/Enable_20phase_20transitions)=
### __Parameter name:__ Enable phase transitions
**Default value:** false

**Pattern:** [Bool]

**Documentation:** Whether to enable the use of phase transitions, which break the thermodynamic consistency of the equation of state for properties (heat capacity, thermal expansivity and compressibility) that are affected by the P-T-X dependence of the phase transition. Specifically, this means that latent heat and excess expansivity/compressibility of reactions are neglected.

(parameters:Material_20model/Multicomponent_20compressible/Isochoric_20specific_20heats)=
### __Parameter name:__ Isochoric specific heats
**Default value:** 1250.

**Pattern:** [Anything]

**Documentation:** List of isochoric specific heats for background and compositional fields (N), for a total of N+1 values for models with no phase transitions (or models where the value does not change across any of the phase transitions). For models with phase transitions, the list needs to contain each field name, including the background, for a total of N+1 names, and for each of these names, specify the value for each phase (giving P_c+1 values for each field, with P_c being the number of phase transitions for field c). Therefore, the total number of values given is N+P+1, with P = sum(P_c) the total number of phase transitions, summed over all phases. The format is background: value1|value2|...|valueP_1+1, field1:value1|...|valueP_2+1, ..., fieldN: value1|...|valueP_N+1. If only one value is given, then all fields/phases use the same value. Units: \si{\joule\per\kelvin\per\kilogram}.

(parameters:Material_20model/Multicomponent_20compressible/Isothermal_20bulk_20modulus_20pressure_20derivatives)=
### __Parameter name:__ Isothermal bulk modulus pressure derivatives
**Default value:** 4.

**Pattern:** [Anything]

**Documentation:** List of isothermal bulk modulus pressure derivatives for background and compositional fields (N), for a total of N+1 values for models with no phase transitions (or models where the value does not change across any of the phase transitions). For models with phase transitions, the list needs to contain each field name, including the background, for a total of N+1 names, and for each of these names, specify the value for each phase (giving P_c+1 values for each field, with P_c being the number of phase transitions for field c). Therefore, the total number of values given is N+P+1, with P = sum(P_c) the total number of phase transitions, summed over all phases. The format is background: value1|value2|...|valueP_1+1, field1:value1|...|valueP_2+1, ..., fieldN: value1|...|valueP_N+1. If only one value is given, then all fields/phases use the same value. Units: [].

(parameters:Material_20model/Multicomponent_20compressible/Phase_20transition_20Clapeyron_20slopes)=
### __Parameter name:__ Phase transition Clapeyron slopes
**Default value:**

**Pattern:** [Anything]

**Documentation:** A list of Clapeyron slopes for each phase transition. A positive Clapeyron slope indicates that the phase transition will occur in a greater depth, if the temperature is higher than the one given in Phase transition temperatures and in a smaller depth, if the temperature is smaller than the one given in Phase transition temperatures. For negative slopes the other way round. List must have the same number of entries as Phase transition depths. Units: \si{\pascal\per\kelvin}.

(parameters:Material_20model/Multicomponent_20compressible/Phase_20transition_20depths)=
### __Parameter name:__ Phase transition depths
**Default value:**

**Pattern:** [Anything]

**Documentation:** A list of depths where phase transitions occur. Values must monotonically increase. Units: \si{\meter}.

(parameters:Material_20model/Multicomponent_20compressible/Phase_20transition_20pressure_20widths)=
### __Parameter name:__ Phase transition pressure widths
**Default value:**

**Pattern:** [Anything]

**Documentation:** A list of widths for each phase transition, in terms of pressure. The phase functions are scaled with these values, leading to a jump between phases for a value of zero and a gradual transition for larger values. List must have the same number of entries as Phase transition pressures. Define transition by depth instead of pressure must be set to false to use this parameter. Units: \si{\pascal}.

(parameters:Material_20model/Multicomponent_20compressible/Phase_20transition_20pressures)=
### __Parameter name:__ Phase transition pressures
**Default value:**

**Pattern:** [Anything]

**Documentation:** A list of pressures where phase transitions occur. Values must monotonically increase. Define transition by depth instead of pressure must be set to false to use this parameter. Units: \si{\pascal}.

(parameters:Material_20model/Multicomponent_20compressible/Phase_20transition_20temperature_20lower_20limits)=
### __Parameter name:__ Phase transition temperature lower limits
**Default value:** -1.7976931348623157e+308

**Pattern:** [Anything]

**Documentation:** A list of lower temperature limits for each phase transition. Below this temperature the respective phase transition is deactivated. The default value means there is no lower limit for any phase transition. List must have the same number of entries as Phase transition depths. When the optional temperature limits are applied, the user has to be careful about the consistency between adjacent phases. Phase transitions should be continuous in pressure-temperature space. We recommend producing a phase diagram with simple model setups to check the implementation as a starting point.Units: \si{\kelvin}.

(parameters:Material_20model/Multicomponent_20compressible/Phase_20transition_20temperature_20upper_20limits)=
### __Parameter name:__ Phase transition temperature upper limits
**Default value:** 1.7976931348623157e+308

**Pattern:** [Anything]

**Documentation:** A list of upper temperature limits for each phase transition. Above this temperature the respective phase transition is deactivated. The default value means there is no upper limit for any phase transitions. List must have the same number of entries as Phase transition depths. When the optional temperature limits are applied, the user has to be careful about the consistency between adjacent phases. Phase transitions should be continuous in pressure-temperature space. We recommend producing a phase diagram with simple model setups to check the implementation as a starting point.Units: \si{\kelvin}.

(parameters:Material_20model/Multicomponent_20compressible/Phase_20transition_20temperatures)=
### __Parameter name:__ Phase transition temperatures
**Default value:**

**Pattern:** [Anything]

**Documentation:** A list of temperatures where phase transitions occur. Higher or lower temperatures lead to phase transition occurring in smaller or greater depths than given in Phase transition depths, depending on the Clapeyron slope given in Phase transition Clapeyron slopes. List must have the same number of entries as Phase transition depths. Units: \si{\kelvin}.

(parameters:Material_20model/Multicomponent_20compressible/Phase_20transition_20widths)=
### __Parameter name:__ Phase transition widths
**Default value:**

**Pattern:** [Anything]

**Documentation:** A list of widths for each phase transition, in terms of depth. The phase functions are scaled with these values, leading to a jump between phases for a value of zero and a gradual transition for larger values. List must have the same number of entries as Phase transition depths. Units: \si{\meter}.

(parameters:Material_20model/Multicomponent_20compressible/Reference_20densities)=
### __Parameter name:__ Reference densities
**Default value:** 3300.

**Pattern:** [Anything]

**Documentation:** List of reference densities for background and compositional fields (N), for a total of N+1 values for models with no phase transitions (or models where the value does not change across any of the phase transitions). For models with phase transitions, the list needs to contain each field name, including the background, for a total of N+1 names, and for each of these names, specify the value for each phase (giving P_c+1 values for each field, with P_c being the number of phase transitions for field c). Therefore, the total number of values given is N+P+1, with P = sum(P_c) the total number of phase transitions, summed over all phases. The format is background: value1|value2|...|valueP_1+1, field1:value1|...|valueP_2+1, ..., fieldN: value1|...|valueP_N+1. If only one value is given, then all fields/phases use the same value. Units: \si{\kilogram\per\meter\cubed}.

(parameters:Material_20model/Multicomponent_20compressible/Reference_20isothermal_20compressibilities)=
### __Parameter name:__ Reference isothermal compressibilities
**Default value:** 4e-12

**Pattern:** [Anything]

**Documentation:** List of isothermal compressibilities for background and compositional fields (N), for a total of N+1 values for models with no phase transitions (or models where the value does not change across any of the phase transitions). For models with phase transitions, the list needs to contain each field name, including the background, for a total of N+1 names, and for each of these names, specify the value for each phase (giving P_c+1 values for each field, with P_c being the number of phase transitions for field c). Therefore, the total number of values given is N+P+1, with P = sum(P_c) the total number of phase transitions, summed over all phases. The format is background: value1|value2|...|valueP_1+1, field1:value1|...|valueP_2+1, ..., fieldN: value1|...|valueP_N+1. If only one value is given, then all fields/phases use the same value. Units: \si{\per\pascal}.

(parameters:Material_20model/Multicomponent_20compressible/Reference_20temperatures)=
### __Parameter name:__ Reference temperatures
**Default value:** 298.15

**Pattern:** [Anything]

**Documentation:** List of reference temperatures $T_0$ for background and compositional fields (N), for a total of N+1 values for models with no phase transitions (or models where the value does not change across any of the phase transitions). For models with phase transitions, the list needs to contain each field name, including the background, for a total of N+1 names, and for each of these names, specify the value for each phase (giving P_c+1 values for each field, with P_c being the number of phase transitions for field c). Therefore, the total number of values given is N+P+1, with P = sum(P_c) the total number of phase transitions, summed over all phases. The format is background: value1|value2|...|valueP_1+1, field1:value1|...|valueP_2+1, ..., fieldN: value1|...|valueP_N+1. If only one value is given, then all fields/phases use the same value. Units: \si{\kelvin}.

(parameters:Material_20model/Multicomponent_20compressible/Reference_20thermal_20expansivities)=
### __Parameter name:__ Reference thermal expansivities
**Default value:** 4.e-5

**Pattern:** [Anything]

**Documentation:** List of reference thermal expansivities for background and compositional fields (N), for a total of N+1 values for models with no phase transitions (or models where the value does not change across any of the phase transitions). For models with phase transitions, the list needs to contain each field name, including the background, for a total of N+1 names, and for each of these names, specify the value for each phase (giving P_c+1 values for each field, with P_c being the number of phase transitions for field c). Therefore, the total number of values given is N+P+1, with P = sum(P_c) the total number of phase transitions, summed over all phases. The format is background: value1|value2|...|valueP_1+1, field1:value1|...|valueP_2+1, ..., fieldN: value1|...|valueP_N+1. If only one value is given, then all fields/phases use the same value. Units: \si{\per\kelvin}.

(parameters:Material_20model/Multicomponent_20compressible/Thermal_20conductivities)=
### __Parameter name:__ Thermal conductivities
**Default value:** 4.7

**Pattern:** [Anything]

**Documentation:** List of thermal conductivities for background and compositional fields (N), for a total of N+1 values for models with no phase transitions (or models where the value does not change across any of the phase transitions). For models with phase transitions, the list needs to contain each field name, including the background, for a total of N+1 names, and for each of these names, specify the value for each phase (giving P_c+1 values for each field, with P_c being the number of phase transitions for field c). Therefore, the total number of values given is N+P+1, with P = sum(P_c) the total number of phase transitions, summed over all phases. The format is background: value1|value2|...|valueP_1+1, field1:value1|...|valueP_2+1, ..., fieldN: value1|...|valueP_N+1. If only one value is given, then all fields/phases use the same value. Units: \si{\watt\per\meter\per\kelvin}.

(parameters:Material_20model/Multicomponent_20compressible/Viscosities)=
### __Parameter name:__ Viscosities
**Default value:** 1.e21

**Pattern:** [Anything]

**Documentation:** List of viscosities for background and compositional fields (N), for a total of N+1 values for models with no phase transitions (or models where the value does not change across any of the phase transitions). For models with phase transitions, the list needs to contain each field name, including the background, for a total of N+1 names, and for each of these names, specify the value for each phase (giving P_c+1 values for each field, with P_c being the number of phase transitions for field c). Therefore, the total number of values given is N+P+1, with P = sum(P_c) the total number of phase transitions, summed over all phases. The format is background: value1|value2|...|valueP_1+1, field1:value1|...|valueP_2+1, ..., fieldN: value1|...|valueP_N+1. If only one value is given, then all fields/phases use the same value. Units: \si{\pascal\second}.

(parameters:Material_20model/Multicomponent_20compressible/Viscosity_20averaging_20scheme)=
### __Parameter name:__ Viscosity averaging scheme
**Default value:** harmonic

**Pattern:** [Selection arithmetic|harmonic|geometric|maximum composition ]

**Documentation:** When more than one compositional field is present at a point with different viscosities, we need to come up with an average viscosity at that point.  Select a weighted harmonic, arithmetic, geometric, or maximum composition.

(parameters:Material_20model/Nondimensional_20model)=
## **Subsection:** Material model / Nondimensional model
(parameters:Material_20model/Nondimensional_20model/Di)=
### __Parameter name:__ Di
**Default value:** 0.0

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** Dissipation number. Pick 0.0 for incompressible computations.

(parameters:Material_20model/Nondimensional_20model/Ra)=
### __Parameter name:__ Ra
**Default value:** 1e4

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** Rayleigh number Ra

(parameters:Material_20model/Nondimensional_20model/Reference_20density)=
### __Parameter name:__ Reference density
**Default value:** 1.0

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** Reference density $\rho_0$. Units: $\frac{\text{kg}}{\text{m}^3}$.

(parameters:Material_20model/Nondimensional_20model/Reference_20specific_20heat)=
### __Parameter name:__ Reference specific heat
**Default value:** 1.0

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the specific heat $C_p$. Units: $\frac{\text{J}}{\text{K}\text{kg}}$.

(parameters:Material_20model/Nondimensional_20model/Use_20TALA)=
### __Parameter name:__ Use TALA
**Default value:** false

**Pattern:** [Bool]

**Documentation:** Whether to use the TALA instead of the ALA approximation.

(parameters:Material_20model/Nondimensional_20model/Viscosity_20depth_20prefactor)=
### __Parameter name:__ Viscosity depth prefactor
**Default value:** 0.0

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** Exponential depth prefactor for viscosity.

(parameters:Material_20model/Nondimensional_20model/Viscosity_20temperature_20prefactor)=
### __Parameter name:__ Viscosity temperature prefactor
**Default value:** 0.0

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** Exponential temperature prefactor for viscosity.

(parameters:Material_20model/Nondimensional_20model/gamma)=
### __Parameter name:__ gamma
**Default value:** 1.0

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** Grueneisen parameter

(parameters:Material_20model/PerpleX_20lookup_20model)=
## **Subsection:** Material model / PerpleX lookup model
(parameters:Material_20model/PerpleX_20lookup_20model/Maximum_20material_20pressure)=
### __Parameter name:__ Maximum material pressure
**Default value:** 1.e12

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the maximum pressure used to query PerpleX. Units: \si{\pascal}.

(parameters:Material_20model/PerpleX_20lookup_20model/Maximum_20material_20temperature)=
### __Parameter name:__ Maximum material temperature
**Default value:** 6000.

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the maximum temperature used to query PerpleX. Units: $\text{K}$.

(parameters:Material_20model/PerpleX_20lookup_20model/Minimum_20material_20pressure)=
### __Parameter name:__ Minimum material pressure
**Default value:** 1.e5

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the minimum pressure used to query PerpleX. Units: \si{\pascal}.

(parameters:Material_20model/PerpleX_20lookup_20model/Minimum_20material_20temperature)=
### __Parameter name:__ Minimum material temperature
**Default value:** 0.

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the minimum temperature used to query PerpleX. Units: $\text{K}$.

(parameters:Material_20model/PerpleX_20lookup_20model/PerpleX_20input_20file_20name)=
### __Parameter name:__ PerpleX input file name
**Default value:** rock.dat

**Pattern:** [Anything]

**Documentation:** The name of the PerpleX input file (should end with .dat).

(parameters:Material_20model/PerpleX_20lookup_20model/Thermal_20conductivity)=
### __Parameter name:__ Thermal conductivity
**Default value:** 4.7

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the thermal conductivity $k$. Units: $\frac{\text{W}{\text{m}\text{K}}$.

(parameters:Material_20model/PerpleX_20lookup_20model/Viscosity)=
### __Parameter name:__ Viscosity
**Default value:** 5e24

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the viscosity $\eta$. Units: $\text{Pa}\text{s}$.

(parameters:Material_20model/Prescribed_20viscosity)=
## **Subsection:** Material model / Prescribed viscosity
(parameters:Material_20model/Prescribed_20viscosity/Base_20model)=
### __Parameter name:__ Base model
**Default value:** simple

**Pattern:** [Selection Steinberger|ascii reference profile|averaging|compositing|composition reaction|depth dependent|diffusion dislocation|drucker prager|entropy model|grain size|latent heat|latent heat melt|melt boukare|melt global|melt simple|modified tait|multicomponent|multicomponent compressible|nondimensional|perplex lookup|prescribed viscosity|reactive fluid transport|replace lithosphere viscosity|simple|simple compressible|simpler|visco plastic|viscoelastic ]

**Documentation:** The name of a material model that will be modified by the prescribed viscosity material model. Valid values for this parameter are the names of models that are also valid for the &ldquo;Material models/Model name&rdquo; parameter. See the documentation for that for more information.

(parameters:Material_20model/Prescribed_20viscosity/Indicator_20function)=
## **Subsection:** Material model / Prescribed viscosity / Indicator function
(parameters:Material_20model/Prescribed_20viscosity/Indicator_20function/Function_20constants)=
### __Parameter name:__ Function constants
**Default value:**

**Pattern:** [Anything]

**Documentation:** Sometimes it is convenient to use symbolic constants in the expression that describes the function, rather than having to use its numeric value everywhere the constant appears. These values can be defined using this parameter, in the form &lsquo;var1=value1, var2=value2, ...&rsquo;.

A typical example would be to set this runtime parameter to &lsquo;pi=3.1415926536&rsquo; and then use &lsquo;pi&rsquo; in the expression of the actual formula. (That said, for convenience this class actually defines both &lsquo;pi&rsquo; and &lsquo;Pi&rsquo; by default, but you get the idea.)

(parameters:Material_20model/Prescribed_20viscosity/Indicator_20function/Function_20expression)=
### __Parameter name:__ Function expression
**Default value:** 0; 0; 0

**Pattern:** [Anything]

**Documentation:** The formula that denotes the function you want to evaluate for particular values of the independent variables. This expression may contain any of the usual operations such as addition or multiplication, as well as all of the common functions such as &lsquo;sin&rsquo; or &lsquo;cos&rsquo;. In addition, it may contain expressions like &lsquo;if(x>0, 1, -1)&rsquo; where the expression evaluates to the second argument if the first argument is true, and to the third argument otherwise. For a full overview of possible expressions accepted see the documentation of the muparser library at http://muparser.beltoforion.de/.

If the function you are describing represents a vector-valued function with multiple components, then separate the expressions for individual components by a semicolon.

(parameters:Material_20model/Prescribed_20viscosity/Indicator_20function/Variable_20names)=
### __Parameter name:__ Variable names
**Default value:** x,y,t

**Pattern:** [Anything]

**Documentation:** The names of the variables as they will be used in the function, separated by commas. By default, the names of variables at which the function will be evaluated are &lsquo;x&rsquo; (in 1d), &lsquo;x,y&rsquo; (in 2d) or &lsquo;x,y,z&rsquo; (in 3d) for spatial coordinates and &lsquo;t&rsquo; for time. You can then use these variable names in your function expression and they will be replaced by the values of these variables at which the function is currently evaluated. However, you can also choose a different set of names for the independent variables at which to evaluate your function expression. For example, if you work in spherical coordinates, you may wish to set this input parameter to &lsquo;r,phi,theta,t&rsquo; and then use these variable names in your function expression.

(parameters:Material_20model/Prescribed_20viscosity/Viscosity_20function)=
## **Subsection:** Material model / Prescribed viscosity / Viscosity function
(parameters:Material_20model/Prescribed_20viscosity/Viscosity_20function/Function_20constants)=
### __Parameter name:__ Function constants
**Default value:**

**Pattern:** [Anything]

**Documentation:** Sometimes it is convenient to use symbolic constants in the expression that describes the function, rather than having to use its numeric value everywhere the constant appears. These values can be defined using this parameter, in the form &lsquo;var1=value1, var2=value2, ...&rsquo;.

A typical example would be to set this runtime parameter to &lsquo;pi=3.1415926536&rsquo; and then use &lsquo;pi&rsquo; in the expression of the actual formula. (That said, for convenience this class actually defines both &lsquo;pi&rsquo; and &lsquo;Pi&rsquo; by default, but you get the idea.)

(parameters:Material_20model/Prescribed_20viscosity/Viscosity_20function/Function_20expression)=
### __Parameter name:__ Function expression
**Default value:** 0; 0; 0

**Pattern:** [Anything]

**Documentation:** The formula that denotes the function you want to evaluate for particular values of the independent variables. This expression may contain any of the usual operations such as addition or multiplication, as well as all of the common functions such as &lsquo;sin&rsquo; or &lsquo;cos&rsquo;. In addition, it may contain expressions like &lsquo;if(x>0, 1, -1)&rsquo; where the expression evaluates to the second argument if the first argument is true, and to the third argument otherwise. For a full overview of possible expressions accepted see the documentation of the muparser library at http://muparser.beltoforion.de/.

If the function you are describing represents a vector-valued function with multiple components, then separate the expressions for individual components by a semicolon.

(parameters:Material_20model/Prescribed_20viscosity/Viscosity_20function/Variable_20names)=
### __Parameter name:__ Variable names
**Default value:** x,y,t

**Pattern:** [Anything]

**Documentation:** The names of the variables as they will be used in the function, separated by commas. By default, the names of variables at which the function will be evaluated are &lsquo;x&rsquo; (in 1d), &lsquo;x,y&rsquo; (in 2d) or &lsquo;x,y,z&rsquo; (in 3d) for spatial coordinates and &lsquo;t&rsquo; for time. You can then use these variable names in your function expression and they will be replaced by the values of these variables at which the function is currently evaluated. However, you can also choose a different set of names for the independent variables at which to evaluate your function expression. For example, if you work in spherical coordinates, you may wish to set this input parameter to &lsquo;r,phi,theta,t&rsquo; and then use these variable names in your function expression.

(parameters:Material_20model/Reactive_20Fluid_20Transport_20Model)=
## **Subsection:** Material model / Reactive Fluid Transport Model
(parameters:Material_20model/Reactive_20Fluid_20Transport_20Model/Base_20model)=
### __Parameter name:__ Base model
**Default value:** visco plastic

**Pattern:** [Selection Steinberger|ascii reference profile|averaging|compositing|composition reaction|depth dependent|diffusion dislocation|drucker prager|entropy model|grain size|latent heat|latent heat melt|melt boukare|melt global|melt simple|modified tait|multicomponent|multicomponent compressible|nondimensional|perplex lookup|prescribed viscosity|reactive fluid transport|replace lithosphere viscosity|simple|simple compressible|simpler|visco plastic|viscoelastic ]

**Documentation:** The name of a material model incorporating the addition of fluids. Valid values for this parameter are the names of models that are also valid for the &ldquo;Material models/Model name&rdquo; parameter. See the documentation for that for more information.

(parameters:Material_20model/Reactive_20Fluid_20Transport_20Model/Exponential_20fluid_20weakening_20factor)=
### __Parameter name:__ Exponential fluid weakening factor
**Default value:** 27

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The porosity dependence of the viscosity. Units: dimensionless.

(parameters:Material_20model/Reactive_20Fluid_20Transport_20Model/Fluid_20compressibility)=
### __Parameter name:__ Fluid compressibility
**Default value:** 0.0

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the compressibility of the fluid. Units: $\frac{1}{\text{Pa}}$.

(parameters:Material_20model/Reactive_20Fluid_20Transport_20Model/Fluid_20reaction_20time_20scale_20for_20operator_20splitting)=
### __Parameter name:__ Fluid reaction time scale for operator splitting
**Default value:** 1e3

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** In case the operator splitting scheme is used, the porosity field can not be set to a new equilibrium fluid fraction instantly, but the model has to provide a reaction time scale instead. This time scale defines how fast fluid release and absorption happen, or more specifically, the parameter defines the time after which the deviation of the porosity from the free fluid fraction that would be in equilibrium with the solid will be reduced to a fraction of $1/e$. So if the fluid reaction time scale is small compared to the time step size, the reaction will be so fast that the porosity is very close to this equilibrium value after reactions are computed. Conversely, if the fluid reaction time scale is large compared to the time step size, almost no fluid release and absorption will occur.

Also note that the fluid reaction time scale has to be larger than or equal to the reaction time step used in the operator splitting scheme, otherwise reactions can not be computed. If the model does not use operator splitting, this parameter is not used. Units: yr or s, depending on the &ldquo;Use years instead of seconds&rdquo; parameter.

(parameters:Material_20model/Reactive_20Fluid_20Transport_20Model/Fluid_2dsolid_20reaction_20scheme)=
### __Parameter name:__ Fluid-solid reaction scheme
**Default value:** no reaction

**Pattern:** [Selection no reaction|zero solubility|tian approximation|katz2003 ]

**Documentation:** Select what type of scheme to use for reactions between fluid and solid phases. The current available options are models where no reactions occur between the two phases, or the solid phase is insoluble (zero solubility) and all of the bound fluid is released into the fluid phase, tian approximation use polynomials to describe hydration and dehydration reactions for four different rock compositions as defined in Tian et al., 2019, or the Katz et. al. 2003 mantle melting model. If the Katz 2003 melting model is used, its parameters are declared in its own subsection.

(parameters:Material_20model/Reactive_20Fluid_20Transport_20Model/Maximum_20compaction_20viscosity)=
### __Parameter name:__ Maximum compaction viscosity
**Default value:** 1.7976931348623157e+308

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** Upper cutoff for the compaction viscosity. Units: $\text{Pa}\text{s}$.

(parameters:Material_20model/Reactive_20Fluid_20Transport_20Model/Minimum_20compaction_20viscosity)=
### __Parameter name:__ Minimum compaction viscosity
**Default value:** 0

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** Lower cutoff for the compaction viscosity. Units: $\text{Pa}\text{s}$.

(parameters:Material_20model/Reactive_20Fluid_20Transport_20Model/Reference_20fluid_20density)=
### __Parameter name:__ Reference fluid density
**Default value:** 2500

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** Reference density of the melt/fluid$\rho_{f,0}$. Units: \si{\kilogram\per\meter\cubed}.

(parameters:Material_20model/Reactive_20Fluid_20Transport_20Model/Reference_20fluid_20viscosity)=
### __Parameter name:__ Reference fluid viscosity
**Default value:** 10

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the constant melt/fluid viscosity $\eta_f$. Units: $\text{Pa}\text{s}$.

(parameters:Material_20model/Reactive_20Fluid_20Transport_20Model/Reference_20permeability)=
### __Parameter name:__ Reference permeability
**Default value:** 1e-8

**Pattern:** [Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]

**Documentation:** Reference permeability of the solid host rock.Units: \si{\meter\squared}.

(parameters:Material_20model/Reactive_20Fluid_20Transport_20Model/Reference_20temperature)=
### __Parameter name:__ Reference temperature
**Default value:** 293.

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The reference temperature $T_0$ for the katz2003 reaction model. The reference temperature is used in both the density and viscosity formulas of this model. Units: \si{\kelvin}.

(parameters:Material_20model/Reactive_20Fluid_20Transport_20Model/Shear_20to_20bulk_20viscosity_20ratio)=
### __Parameter name:__ Shear to bulk viscosity ratio
**Default value:** 0.1

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** Ratio between shear and bulk viscosity at the reference permeability $\phi_0=0.05$. The bulk viscosity additionally scales with $\phi_0/\phi$. The shear viscosity is read in from the base model. Units: dimensionless.

(parameters:Material_20model/Reactive_20Fluid_20Transport_20Model/Katz_202003_20model)=
## **Subsection:** Material model / Reactive Fluid Transport Model / Katz 2003 model
(parameters:Material_20model/Reactive_20Fluid_20Transport_20Model/Katz_202003_20model/A1)=
### __Parameter name:__ A1
**Default value:** 1085.7

**Pattern:** [Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]

**Documentation:** Constant parameter in the quadratic function that approximates the solidus of peridotite. Units: $^{\circ}C$.

(parameters:Material_20model/Reactive_20Fluid_20Transport_20Model/Katz_202003_20model/A2)=
### __Parameter name:__ A2
**Default value:** 1.329e-7

**Pattern:** [Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]

**Documentation:** Prefactor of the linear pressure term in the quadratic function that approximates the solidus of peridotite. Units: $\frac{^{\circ}C}{\text{Pa}}$.

(parameters:Material_20model/Reactive_20Fluid_20Transport_20Model/Katz_202003_20model/A3)=
### __Parameter name:__ A3
**Default value:** -5.1e-18

**Pattern:** [Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]

**Documentation:** Prefactor of the quadratic pressure term in the quadratic function that approximates the solidus of peridotite. Units: $\frac{^{\circ}C}{\text{Pa}^2}$.

(parameters:Material_20model/Reactive_20Fluid_20Transport_20Model/Katz_202003_20model/B1)=
### __Parameter name:__ B1
**Default value:** 1475.0

**Pattern:** [Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]

**Documentation:** Constant parameter in the quadratic function that approximates the lherzolite liquidus used for calculating the fraction of peridotite-derived melt. Units: $^{\circ}C$.

(parameters:Material_20model/Reactive_20Fluid_20Transport_20Model/Katz_202003_20model/B2)=
### __Parameter name:__ B2
**Default value:** 8.0e-8

**Pattern:** [Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]

**Documentation:** Prefactor of the linear pressure term in the quadratic function that approximates the  lherzolite liquidus used for calculating the fraction of peridotite-derived melt. Units: $\frac{^{\circ}C}{\text{Pa}}$.

(parameters:Material_20model/Reactive_20Fluid_20Transport_20Model/Katz_202003_20model/B3)=
### __Parameter name:__ B3
**Default value:** -3.2e-18

**Pattern:** [Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]

**Documentation:** Prefactor of the quadratic pressure term in the quadratic function that approximates the  lherzolite liquidus used for calculating the fraction of peridotite-derived melt. Units: $\frac{^{\circ}C}{\text{Pa}^2}$.

(parameters:Material_20model/Reactive_20Fluid_20Transport_20Model/Katz_202003_20model/C1)=
### __Parameter name:__ C1
**Default value:** 1780.0

**Pattern:** [Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]

**Documentation:** Constant parameter in the quadratic function that approximates the liquidus of peridotite. Units: $^{\circ}C$.

(parameters:Material_20model/Reactive_20Fluid_20Transport_20Model/Katz_202003_20model/C2)=
### __Parameter name:__ C2
**Default value:** 4.50e-8

**Pattern:** [Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]

**Documentation:** Prefactor of the linear pressure term in the quadratic function that approximates the liquidus of peridotite. Units: $\frac{^{\circ}C}{\text{Pa}}$.

(parameters:Material_20model/Reactive_20Fluid_20Transport_20Model/Katz_202003_20model/C3)=
### __Parameter name:__ C3
**Default value:** -2.0e-18

**Pattern:** [Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]

**Documentation:** Prefactor of the quadratic pressure term in the quadratic function that approximates the liquidus of peridotite. Units: $\frac{^{\circ}C}{\text{Pa}^2}$.

(parameters:Material_20model/Reactive_20Fluid_20Transport_20Model/Katz_202003_20model/Depletion_20solidus_20change)=
### __Parameter name:__ Depletion solidus change
**Default value:** 200.0

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The solidus temperature change for a depletion of 100\%. For positive values, the solidus gets increased for a positive peridotite field (depletion) and lowered for a negative peridotite field (enrichment). Scaling with depletion is linear. Only active when fractional melting is used. Units: $\text{K}$.

(parameters:Material_20model/Reactive_20Fluid_20Transport_20Model/Katz_202003_20model/Exponential_20melt_20weakening_20factor)=
### __Parameter name:__ Exponential melt weakening factor
**Default value:** 27.

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The porosity dependence of the viscosity. Units: dimensionless.

(parameters:Material_20model/Reactive_20Fluid_20Transport_20Model/Katz_202003_20model/Freezing_20rate)=
### __Parameter name:__ Freezing rate
**Default value:** 0.0

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** Freezing rate of melt when in subsolidus regions. If this parameter is set to a number larger than 0.0, it specifies the fraction of melt that will freeze per year (or per second, depending on the &ldquo;Use years instead of seconds&rdquo; parameter), as soon as the porosity exceeds the equilibrium melt fraction, and the equilibrium melt fraction falls below the depletion. In this case, melt will freeze according to the given rate until one of those conditions is not fulfilled anymore. The reasoning behind this is that there should not be more melt present than the equilibrium melt fraction, as melt production decreases with increasing depletion, but the freezing process of melt also reduces the depletion by the same amount, and as soon as the depletion falls below the equilibrium melt fraction, we expect that material should melt again (no matter how much melt is present). This is quite a simplification and not a realistic freezing parameterization, but without tracking the melt composition, there is no way to compute freezing rates accurately. If this parameter is set to zero, no freezing will occur. Note that freezing can never be faster than determined by the &ldquo;Melting time scale for operator splitting&rdquo;. The product of the &ldquo;Freezing rate&rdquo; and the &ldquo;Melting time scale for operator splitting&rdquo; defines how fast freezing occurs with respect to melting (if the product is 0.5, melting will occur twice as fast as freezing). Units: 1/yr or 1/s, depending on the &ldquo;Use years instead of seconds&rdquo; parameter.

(parameters:Material_20model/Reactive_20Fluid_20Transport_20Model/Katz_202003_20model/Mass_20fraction_20cpx)=
### __Parameter name:__ Mass fraction cpx
**Default value:** 0.15

**Pattern:** [Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]

**Documentation:** Mass fraction of clinopyroxene in the peridotite to be molten. Units: non-dimensional.

(parameters:Material_20model/Reactive_20Fluid_20Transport_20Model/Katz_202003_20model/Melt_20bulk_20modulus_20derivative)=
### __Parameter name:__ Melt bulk modulus derivative
**Default value:** 0.0

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the pressure derivative of the melt bulk modulus. Units: None.

(parameters:Material_20model/Reactive_20Fluid_20Transport_20Model/Katz_202003_20model/Melt_20compressibility)=
### __Parameter name:__ Melt compressibility
**Default value:** 0.0

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the compressibility of the melt. Units: $\frac{1}{\text{Pa}}$.

(parameters:Material_20model/Reactive_20Fluid_20Transport_20Model/Katz_202003_20model/Melt_20extraction_20depth)=
### __Parameter name:__ Melt extraction depth
**Default value:** 1000.0

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** Depth above that melt will be extracted from the model, which is done by a negative reaction term proportional to the porosity field. Units: \si{\meter}.

(parameters:Material_20model/Reactive_20Fluid_20Transport_20Model/Katz_202003_20model/Melting_20time_20scale_20for_20operator_20splitting)=
### __Parameter name:__ Melting time scale for operator splitting
**Default value:** 1e3

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** Because the operator splitting scheme is used, the porosity field can not be set to a new equilibrium melt fraction instantly, but the model has to provide a melting time scale instead. This time scale defines how fast melting happens, or more specifically, the parameter defines the time after which the deviation of the porosity from the equilibrium melt fraction will be reduced to a fraction of $1/e$. So if the melting time scale is small compared to the time step size, the reaction will be so fast that the porosity is very close to the equilibrium melt fraction after reactions are computed. Conversely, if the melting time scale is large compared to the time step size, almost no melting and freezing will occur.

Also note that the melting time scale has to be larger than or equal to the reaction time step used in the operator splitting scheme, otherwise reactions can not be computed. Units: yr or s, depending on the &ldquo;Use years instead of seconds&rdquo; parameter.

(parameters:Material_20model/Reactive_20Fluid_20Transport_20Model/Katz_202003_20model/Peridotite_20melting_20entropy_20change)=
### __Parameter name:__ Peridotite melting entropy change
**Default value:** -300.

**Pattern:** [Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]

**Documentation:** The entropy change for the phase transition from solid to melt of peridotite. Units: $\frac{\text{J}}{\text{K}\text{kg}}$.

(parameters:Material_20model/Reactive_20Fluid_20Transport_20Model/Katz_202003_20model/Reference_20bulk_20viscosity)=
### __Parameter name:__ Reference bulk viscosity
**Default value:** 1e22

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the constant bulk viscosity $\xi_0$ of the solid matrix. This viscosity may be modified by both temperature and porosity dependencies. Units: $\text{Pa}\text{s}$.

(parameters:Material_20model/Reactive_20Fluid_20Transport_20Model/Katz_202003_20model/Reference_20melt_20density)=
### __Parameter name:__ Reference melt density
**Default value:** 2500.

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** Reference density of the melt/fluid$\rho_{f,0}$. Units: $\frac{\text{kg}}{\text{m}^3}$.

(parameters:Material_20model/Reactive_20Fluid_20Transport_20Model/Katz_202003_20model/Reference_20melt_20viscosity)=
### __Parameter name:__ Reference melt viscosity
**Default value:** 10.

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the constant melt viscosity $\eta_f$. Units: $\text{Pa}\text{s}$.

(parameters:Material_20model/Reactive_20Fluid_20Transport_20Model/Katz_202003_20model/Reference_20permeability)=
### __Parameter name:__ Reference permeability
**Default value:** 1e-8

**Pattern:** [Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]

**Documentation:** Reference permeability of the solid host rock.Units: \si{\meter\squared}.

(parameters:Material_20model/Reactive_20Fluid_20Transport_20Model/Katz_202003_20model/Thermal_20bulk_20viscosity_20exponent)=
### __Parameter name:__ Thermal bulk viscosity exponent
**Default value:** 0.0

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The temperature dependence of the bulk viscosity. Dimensionless exponent. See the general documentation of this model for a formula that states the dependence of the viscosity on this factor, which is called $\beta$ there.

(parameters:Material_20model/Reactive_20Fluid_20Transport_20Model/Katz_202003_20model/Use_20fractional_20melting)=
### __Parameter name:__ Use fractional melting
**Default value:** false

**Pattern:** [Bool]

**Documentation:** If fractional melting should be used (if true), including a solidus change based on depletion (in this case, the amount of melt that has migrated away from its origin), and freezing of melt when it has moved to a region with temperatures lower than the solidus; or if batch melting should be used (if false), assuming that the melt fraction only depends on temperature and pressure, and how much melt has already been generated at a given point, but not considering movement of melt in the melting parameterization.

Note that melt does not freeze unless the &rsquo;Freezing rate&rsquo; parameter is set to a value larger than 0.

(parameters:Material_20model/Reactive_20Fluid_20Transport_20Model/Katz_202003_20model/beta)=
### __Parameter name:__ beta
**Default value:** 1.5

**Pattern:** [Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]

**Documentation:** Exponent of the melting temperature in the melt fraction calculation. Units: non-dimensional.

(parameters:Material_20model/Reactive_20Fluid_20Transport_20Model/Katz_202003_20model/r1)=
### __Parameter name:__ r1
**Default value:** 0.5

**Pattern:** [Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]

**Documentation:** Constant in the linear function that approximates the clinopyroxene reaction coefficient. Units: non-dimensional.

(parameters:Material_20model/Reactive_20Fluid_20Transport_20Model/Katz_202003_20model/r2)=
### __Parameter name:__ r2
**Default value:** 8e-11

**Pattern:** [Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]

**Documentation:** Prefactor of the linear pressure term in the linear function that approximates the clinopyroxene reaction coefficient. Units: $\frac{1}{\text{Pa}}$.

(parameters:Material_20model/Reactive_20Fluid_20Transport_20Model/Tian_202019_20model)=
## **Subsection:** Material model / Reactive Fluid Transport Model / Tian 2019 model
(parameters:Material_20model/Reactive_20Fluid_20Transport_20Model/Tian_202019_20model/Maximum_20weight_20percent_20water_20in_20MORB)=
### __Parameter name:__ Maximum weight percent water in MORB
**Default value:** 2

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The maximum allowed weight percent that the sediment composition can hold.

(parameters:Material_20model/Reactive_20Fluid_20Transport_20Model/Tian_202019_20model/Maximum_20weight_20percent_20water_20in_20gabbro)=
### __Parameter name:__ Maximum weight percent water in gabbro
**Default value:** 1

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The maximum allowed weight percent that the sediment composition can hold.

(parameters:Material_20model/Reactive_20Fluid_20Transport_20Model/Tian_202019_20model/Maximum_20weight_20percent_20water_20in_20peridotite)=
### __Parameter name:__ Maximum weight percent water in peridotite
**Default value:** 8

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The maximum allowed weight percent that the sediment composition can hold.

(parameters:Material_20model/Reactive_20Fluid_20Transport_20Model/Tian_202019_20model/Maximum_20weight_20percent_20water_20in_20sediment)=
### __Parameter name:__ Maximum weight percent water in sediment
**Default value:** 3

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The maximum allowed weight percent that the sediment composition can hold.

(parameters:Material_20model/Reactive_20Fluid_20Transport_20Model/Tian_202019_20model/Use_20adiabatic_20pressure_20for_20reactions)=
### __Parameter name:__ Use adiabatic pressure for reactions
**Default value:** false

**Pattern:** [Bool]

**Documentation:** If true, the adiabatic pressure is used in the Tian 2019 solubility model. If false, the full pressure is used instead. When simulating fully coupled fluid transport, setting this to true is recommended since the compaction pressure can lead to numerical instabilities when determining reaction rates.

(parameters:Material_20model/Replace_20lithosphere_20viscosity)=
## **Subsection:** Material model / Replace lithosphere viscosity
(parameters:Material_20model/Replace_20lithosphere_20viscosity/Base_20model)=
### __Parameter name:__ Base model
**Default value:** simple

**Pattern:** [Selection Steinberger|ascii reference profile|averaging|compositing|composition reaction|depth dependent|diffusion dislocation|drucker prager|entropy model|grain size|latent heat|latent heat melt|melt boukare|melt global|melt simple|modified tait|multicomponent|multicomponent compressible|nondimensional|perplex lookup|prescribed viscosity|reactive fluid transport|replace lithosphere viscosity|simple|simple compressible|simpler|visco plastic|viscoelastic ]

**Documentation:** The name of a material model that will be modified by a replacingthe viscosity in the lithosphere by a constant value. Valid values for this parameter are the names of models that are also valid for the &ldquo;Material models/Model name&rdquo; parameter. See the documentation for more information.

(parameters:Material_20model/Replace_20lithosphere_20viscosity/Data_20directory)=
### __Parameter name:__ Data directory
**Default value:** $ASPECT_SOURCE_DIR/data/initial-temperature/lithosphere-mask/

**Pattern:** [DirectoryName]

**Documentation:** The path to the LAB depth data file

(parameters:Material_20model/Replace_20lithosphere_20viscosity/Depth_20specification_20method)=
### __Parameter name:__ Depth specification method
**Default value:** Value

**Pattern:** [Selection File|Value ]

**Documentation:** Method that is used to specify the depth of the lithosphere-asthenosphere boundary.

(parameters:Material_20model/Replace_20lithosphere_20viscosity/LAB_20depth_20filename)=
### __Parameter name:__ LAB depth filename
**Default value:** LAB_CAM2016.txt

**Pattern:** [FileName (Type: input)]

**Documentation:** File from which the lithosphere-asthenosphere boundary depth data is read.

(parameters:Material_20model/Replace_20lithosphere_20viscosity/Lithosphere_20viscosity)=
### __Parameter name:__ Lithosphere viscosity
**Default value:** 1e23

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The viscosity within lithosphere, applied abovethe maximum lithosphere depth.

(parameters:Material_20model/Replace_20lithosphere_20viscosity/Maximum_20lithosphere_20depth)=
### __Parameter name:__ Maximum lithosphere depth
**Default value:** 200000.0

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** Units: \si{\meter}.The maximum depth of the lithosphere. The model will be NaNs below this depth.

(parameters:Material_20model/Simple_20compressible_20model)=
## **Subsection:** Material model / Simple compressible model
(parameters:Material_20model/Simple_20compressible_20model/Reference_20compressibility)=
### __Parameter name:__ Reference compressibility
**Default value:** 4e-12

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the reference compressibility. Units: $\frac{1}{\text{Pa}}$.

(parameters:Material_20model/Simple_20compressible_20model/Reference_20density)=
### __Parameter name:__ Reference density
**Default value:** 3300.

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** Reference density $\rho_0$. Units: $\frac{\text{kg}}{\text{m}^3}$.

(parameters:Material_20model/Simple_20compressible_20model/Reference_20specific_20heat)=
### __Parameter name:__ Reference specific heat
**Default value:** 1250.

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the specific heat $C_p$. Units: $\frac{\text{J}}{\text{K}\text{kg}}$.

(parameters:Material_20model/Simple_20compressible_20model/Thermal_20conductivity)=
### __Parameter name:__ Thermal conductivity
**Default value:** 4.7

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the thermal conductivity $k$. Units: $\frac{\text{W}{\text{m}\text{K}}$.

(parameters:Material_20model/Simple_20compressible_20model/Thermal_20expansion_20coefficient)=
### __Parameter name:__ Thermal expansion coefficient
**Default value:** 2e-5

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the thermal expansion coefficient $\alpha$. Units: $\frac{1}{\text{K}}$.

(parameters:Material_20model/Simple_20compressible_20model/Viscosity)=
### __Parameter name:__ Viscosity
**Default value:** 1000000000000000000000.000000

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the viscosity $\eta$. Units: $\text{Pa}\text{s}$.

(parameters:Material_20model/Simple_20model)=
## **Subsection:** Material model / Simple model
(parameters:Material_20model/Simple_20model/Composition_20viscosity_20prefactor)=
### __Parameter name:__ Composition viscosity prefactor
**Default value:** 1.0

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** A linear dependency of viscosity on the first compositional field. Dimensionless prefactor. With a value of 1.0 (the default) the viscosity does not depend on the composition. See the general documentation of this model for a formula that states the dependence of the viscosity on this factor, which is called $\xi$ there.

(parameters:Material_20model/Simple_20model/Density_20differential_20for_20compositional_20field_201)=
### __Parameter name:__ Density differential for compositional field 1
**Default value:** 0.

**Pattern:** [Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]

**Documentation:** If compositional fields are used, then one would frequently want to make the density depend on these fields. In this simple material model, we make the following assumptions: if no compositional fields are used in the current simulation, then the density is simply the usual one with its linear dependence on the temperature. If there are compositional fields, then the material model determines how many of them influence the density. The composition-dependence adds a term of the kind $+\Delta \rho \; c_1(\mathbf x)$. This parameter describes the value of $\Delta \rho$. Units: $\frac{\text{kg}}{\text{m}^3}$/unit change in composition.

(parameters:Material_20model/Simple_20model/Maximum_20thermal_20prefactor)=
### __Parameter name:__ Maximum thermal prefactor
**Default value:** 1.0e2

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The maximum value of the viscosity prefactor associated with temperature dependence.

(parameters:Material_20model/Simple_20model/Minimum_20thermal_20prefactor)=
### __Parameter name:__ Minimum thermal prefactor
**Default value:** 1.0e-2

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The minimum value of the viscosity prefactor associated with temperature dependence.

(parameters:Material_20model/Simple_20model/Reference_20density)=
### __Parameter name:__ Reference density
**Default value:** 3300.

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** Reference density $\rho_0$. Units: $\frac{\text{kg}}{\text{m}^3}$.

(parameters:Material_20model/Simple_20model/Reference_20specific_20heat)=
### __Parameter name:__ Reference specific heat
**Default value:** 1250.

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the specific heat $C_p$. Units: $\frac{\text{J}}{\text{K}\text{kg}}$.

(parameters:Material_20model/Simple_20model/Reference_20temperature)=
### __Parameter name:__ Reference temperature
**Default value:** 293.

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The reference temperature $T_0$. The reference temperature is used in both the density and viscosity formulas. Units: $\text{K}$.

(parameters:Material_20model/Simple_20model/Thermal_20conductivity)=
### __Parameter name:__ Thermal conductivity
**Default value:** 4.7

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the thermal conductivity $k$. Units: $\frac{\text{W}{\text{m}\text{K}}$.

(parameters:Material_20model/Simple_20model/Thermal_20expansion_20coefficient)=
### __Parameter name:__ Thermal expansion coefficient
**Default value:** 2e-5

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the thermal expansion coefficient $\alpha$. Units: $\frac{1}{\text{K}}$.

(parameters:Material_20model/Simple_20model/Thermal_20viscosity_20exponent)=
### __Parameter name:__ Thermal viscosity exponent
**Default value:** 0.0

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The temperature dependence of viscosity. Dimensionless exponent. See the general documentation of this model for a formula that states the dependence of the viscosity on this factor, which is called $\beta$ there.

(parameters:Material_20model/Simple_20model/Viscosity)=
### __Parameter name:__ Viscosity
**Default value:** 5e24

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the constant viscosity $\eta_0$. This viscosity may be modified by both temperature and compositional dependencies. Units: $\text{Pa}\text{s}$.

(parameters:Material_20model/Simpler_20model)=
## **Subsection:** Material model / Simpler model
(parameters:Material_20model/Simpler_20model/Reference_20density)=
### __Parameter name:__ Reference density
**Default value:** 3300.

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** Reference density $\rho_0$. Units: $\frac{\text{kg}}{\text{m}^3}$.

(parameters:Material_20model/Simpler_20model/Reference_20specific_20heat)=
### __Parameter name:__ Reference specific heat
**Default value:** 1250.

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the specific heat $C_p$. Units: $\frac{\text{J}}{\text{K}\text{kg}}$.

(parameters:Material_20model/Simpler_20model/Reference_20temperature)=
### __Parameter name:__ Reference temperature
**Default value:** 293.

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The reference temperature $T_0$. The reference temperature is used in both the density and viscosity formulas. Units: $\text{K}$.

(parameters:Material_20model/Simpler_20model/Thermal_20conductivity)=
### __Parameter name:__ Thermal conductivity
**Default value:** 4.7

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the thermal conductivity $k$. Units: $\frac{\text{W}{\text{m}\text{K}}$.

(parameters:Material_20model/Simpler_20model/Thermal_20expansion_20coefficient)=
### __Parameter name:__ Thermal expansion coefficient
**Default value:** 2e-5

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the thermal expansion coefficient $\alpha$. Units: $\frac{1}{\text{K}}$.

(parameters:Material_20model/Simpler_20model/Viscosity)=
### __Parameter name:__ Viscosity
**Default value:** 5000000000000000452984832.000000

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the viscosity $\eta$. Units: $\text{Pa}\text{s}$.

(parameters:Material_20model/Steinberger_20model)=
## **Subsection:** Material model / Steinberger model
(parameters:Material_20model/Steinberger_20model/Angles_20of_20dilation)=
### __Parameter name:__ Angles of dilation
**Default value:** 0.

**Pattern:** [Anything]

**Documentation:** List of angles of plastic dilation, $\psi$, for background material and compositional fields, for a total of N+1 values, where N is the number of all compositional fields or only those corresponding to chemical compositions. For a value of zero, the von Mises flow rule is retrieved. The dilation angle should never exceed the internal friction angle.

(parameters:Material_20model/Steinberger_20model/Angles_20of_20internal_20friction)=
### __Parameter name:__ Angles of internal friction
**Default value:** 0.

**Pattern:** [Anything]

**Documentation:** List of angles of internal friction, $\phi$, for background material and compositional fields, for a total of N+1 values, where N is the number of all compositional fields or only those corresponding to chemical compositions. For a value of zero, in 2d the von Mises criterion is retrieved. Angles higher than 30 degrees are harder to solve numerically. Units: degrees.

(parameters:Material_20model/Steinberger_20model/Bilinear_20interpolation)=
### __Parameter name:__ Bilinear interpolation
**Default value:** true

**Pattern:** [Bool]

**Documentation:** Whether to use bilinear interpolation to compute material properties (slower but more accurate).

(parameters:Material_20model/Steinberger_20model/Cohesions)=
### __Parameter name:__ Cohesions
**Default value:** 1e20

**Pattern:** [Anything]

**Documentation:** List of cohesions, $C$, for background material and compositional fields, for a total of N+1 values, where N is the number of all compositional fields or only those corresponding to chemical compositions. The extremely large default cohesion value (1e20 Pa) prevents the viscous stress from exceeding the yield stress. Units: \si{\pascal}.

(parameters:Material_20model/Steinberger_20model/Composition_20viscosity_20prefactors)=
### __Parameter name:__ Composition viscosity prefactors
**Default value:** 1

**Pattern:** [Anything]

**Documentation:** List of N prefactors that are used to modify the reference viscosity, where N is either equal to one or the number of chemical components in the simulation. If only one value is given, then all components use the same value. Units: $\text{Pa}\text{s}$.

(parameters:Material_20model/Steinberger_20model/Data_20directory)=
### __Parameter name:__ Data directory
**Default value:** $ASPECT_SOURCE_DIR/data/material-model/steinberger/

**Pattern:** [DirectoryName]

**Documentation:** The path to the model data. The path may also include the special text &rsquo;$ASPECT_SOURCE_DIR&rsquo; which will be interpreted as the path in which the ASPECT source files were located when ASPECT was compiled. This interpretation allows, for example, to reference files located in the &lsquo;data/&rsquo; subdirectory of ASPECT.

(parameters:Material_20model/Steinberger_20model/Derivatives_20file_20names)=
### __Parameter name:__ Derivatives file names
**Default value:**

**Pattern:** [List of <[Anything]> of length 0...4294967295 (inclusive)]

**Documentation:** The file names of the enthalpy derivatives data. List with as many components as active compositional fields (material data is assumed to be in order with the ordering of the fields).

(parameters:Material_20model/Steinberger_20model/Latent_20heat)=
### __Parameter name:__ Latent heat
**Default value:** false

**Pattern:** [Bool]

**Documentation:** Whether to include latent heat effects in the calculation of thermal expansivity and specific heat. If true, ASPECT follows the approach of Nakagawa et al. 2009, using pressure and temperature derivatives of the enthalpy to calculate the thermal expansivity and specific heat. If false, ASPECT uses the thermal expansivity and specific heat values from the material properties table.

(parameters:Material_20model/Steinberger_20model/Lateral_20viscosity_20file_20name)=
### __Parameter name:__ Lateral viscosity file name
**Default value:** temp-viscosity-prefactor.txt

**Pattern:** [Anything]

**Documentation:** The file name of the lateral viscosity data.

(parameters:Material_20model/Steinberger_20model/Material_20file_20format)=
### __Parameter name:__ Material file format
**Default value:** perplex

**Pattern:** [Selection perplex|hefesto ]

**Documentation:** The material file format to be read in the property tables.

(parameters:Material_20model/Steinberger_20model/Material_20file_20names)=
### __Parameter name:__ Material file names
**Default value:** pyr-ringwood88.txt

**Pattern:** [List of <[Anything]> of length 0...4294967295 (inclusive)]

**Documentation:** The file names of the material data (material data is assumed to be in order with the ordering of the compositional fields). Note that there are three options on how many files need to be listed here: 1. If only one file is provided, it is used for the whole model domain, and compositional fields are ignored. 2. If there is one more file name than the number of compositional fields, then the first file is assumed to define a &lsquo;background composition&rsquo; that is modified by the compositional fields. If there are exactly as many files as compositional fields, the fields are assumed to represent the fractions of different materials and the average property is computed as a sum of the value of the compositional field times the material property of that field.

(parameters:Material_20model/Steinberger_20model/Maximum_20latent_20heat_20substeps)=
### __Parameter name:__ Maximum latent heat substeps
**Default value:** 1

**Pattern:** [Integer range 1...2147483647 (inclusive)]

**Documentation:** The maximum number of substeps over the temperature pressure range to calculate the averaged enthalpy gradient over a cell.

(parameters:Material_20model/Steinberger_20model/Maximum_20lateral_20viscosity_20variation)=
### __Parameter name:__ Maximum lateral viscosity variation
**Default value:** 1e2

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The relative cutoff value for lateral viscosity variations caused by temperature deviations. The viscosity may vary laterally by this factor squared.

(parameters:Material_20model/Steinberger_20model/Maximum_20thermal_20conductivity)=
### __Parameter name:__ Maximum thermal conductivity
**Default value:** 1000

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The maximum thermal conductivity that is allowed in the model. Larger values will be cut off.

(parameters:Material_20model/Steinberger_20model/Maximum_20viscosity)=
### __Parameter name:__ Maximum viscosity
**Default value:** 1e23

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The maximum viscosity that is allowed in the viscosity calculation. Larger values will be cut off.

(parameters:Material_20model/Steinberger_20model/Maximum_20yield_20stress)=
### __Parameter name:__ Maximum yield stress
**Default value:** 1e12

**Pattern:** [Anything]

**Documentation:** List of maximum yield stresses, for background material and compositional fields, , which limits the maximum value of the yield stress determined by the Drucker-Prager plasticity parameters. Default value is chosen so this is not automatically used. Values of 100e6--1000e6 $Pa$ have been used in previous models. Units: \si{\pascal}.

(parameters:Material_20model/Steinberger_20model/Minimum_20viscosity)=
### __Parameter name:__ Minimum viscosity
**Default value:** 1e19

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The minimum viscosity that is allowed in the viscosity calculation. Smaller values will be cut off.

(parameters:Material_20model/Steinberger_20model/Number_20lateral_20average_20bands)=
### __Parameter name:__ Number lateral average bands
**Default value:** 10

**Pattern:** [Integer range 1...2147483647 (inclusive)]

**Documentation:** Number of bands to compute laterally averaged temperature within.

(parameters:Material_20model/Steinberger_20model/Plastic_20damper_20viscosity)=
### __Parameter name:__ Plastic damper viscosity
**Default value:** 0.0

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** Viscosity of the damper that acts in parallel with the plastic viscosity to produce mesh-independent behavior at sufficient resolutions. Units: \si{\pascal\second}

(parameters:Material_20model/Steinberger_20model/Prefactors_20for_20yield_20stress)=
### __Parameter name:__ Prefactors for yield stress
**Default value:** 1.0

**Pattern:** [Anything]

**Documentation:** List of prefactors for the yield stress, for background material and compositional fields, for a total of N+1 values, where N is the number of all compositional fields or only those corresponding to chemical compositions. The prefactor is multiplied with the yield stress computed from the Drucker-Prager plasticity parameters. Default value is 1.0.

(parameters:Material_20model/Steinberger_20model/Pressure_20dependencies_20of_20thermal_20conductivity)=
### __Parameter name:__ Pressure dependencies of thermal conductivity
**Default value:** 3.3e-10, 3.4e-10, 3.6e-10, 1.05e-10

**Pattern:** [List of <[Double -MAX_DOUBLE...MAX_DOUBLE (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** A list of values that determine the linear scaling of the thermal conductivity with pressure. Units: \si{\watt\per\meter\per\kelvin\per\pascal}.

(parameters:Material_20model/Steinberger_20model/Radial_20viscosity_20file_20name)=
### __Parameter name:__ Radial viscosity file name
**Default value:** radial-visc.txt

**Pattern:** [Anything]

**Documentation:** The file name of the radial viscosity data.

(parameters:Material_20model/Steinberger_20model/Reference_20temperatures_20for_20thermal_20conductivity)=
### __Parameter name:__ Reference temperatures for thermal conductivity
**Default value:** 300, 300, 300, 1200

**Pattern:** [List of <[Double 0...MAX_DOUBLE (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** A list of values of reference temperatures used to determine the temperature-dependence of the thermal conductivity. Units: $\text{K}$.

(parameters:Material_20model/Steinberger_20model/Reference_20thermal_20conductivities)=
### __Parameter name:__ Reference thermal conductivities
**Default value:** 2.47, 3.81, 3.52, 4.9

**Pattern:** [List of <[Double 0...MAX_DOUBLE (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** A list of base values of the thermal conductivity for each of the horizontal layers. Pressure- and temperature-dependence will be applied on top of this base value, according to the parameters &rsquo;Pressure dependencies of thermal conductivity&rsquo; and &rsquo;Reference temperatures for thermal conductivity&rsquo;. Units: $\frac{\text{W}{\text{m}\text{K}}$

(parameters:Material_20model/Steinberger_20model/Saturation_20prefactors)=
### __Parameter name:__ Saturation prefactors
**Default value:** 0, 0, 0, 1

**Pattern:** [List of <[Double 0...1 (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** A list of values that indicate how a given layer should take into account the effects of saturation on the temperature-dependence of the thermal conductivity. This factor is multiplied with a saturation function based on the theory of Roufosse and Klemens, 1974. A value of 1 reproduces the formulation of Stackhouse et al. (2015), a value of 0 reproduces the formulation of Tosi et al., (2013). Units: none.

(parameters:Material_20model/Steinberger_20model/Thermal_20conductivity)=
### __Parameter name:__ Thermal conductivity
**Default value:** 4.7

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The value of the thermal conductivity $k$. Units: $\frac{\text{W}{\text{m}\text{K}}$.

(parameters:Material_20model/Steinberger_20model/Thermal_20conductivity_20exponents)=
### __Parameter name:__ Thermal conductivity exponents
**Default value:** 0.48, 0.56, 0.61, 1.0

**Pattern:** [List of <[Double 0...MAX_DOUBLE (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** A list of exponents in the temperature-dependent term of the conductivity formulation. Note that this exponent is not used (and should have a value of 1) in the formulation of Stackhouse et al. (2015). Units: none.

(parameters:Material_20model/Steinberger_20model/Thermal_20conductivity_20formulation)=
### __Parameter name:__ Thermal conductivity formulation
**Default value:** constant

**Pattern:** [Selection constant|p-T-dependent ]

**Documentation:** Which law should be used to compute the thermal conductivity. The &rsquo;constant&rsquo; law uses a constant value for the thermal conductivity. The &rsquo;p-T-dependent&rsquo; formulation uses equations from Stackhouse et al. (2015): First-principles calculations of the lattice thermal conductivity of the lower mantle (https://doi.org/10.1016/j.epsl.2015.06.050), and Tosi et al. (2013): Mantle dynamics with pressure- and temperature-dependent thermal expansivity and conductivity (https://doi.org/10.1016/j.pepi.2013.02.004) to compute the thermal conductivity in dependence of temperature and pressure. The thermal conductivity parameter sets can be chosen in such a way that either the Stackhouse or the Tosi relations are used. The conductivity description can consist of several layers with different sets of parameters. Note that the Stackhouse parametrization is only valid for the lower mantle (bridgmanite).

(parameters:Material_20model/Steinberger_20model/Thermal_20conductivity_20transition_20depths)=
### __Parameter name:__ Thermal conductivity transition depths
**Default value:** 410000, 520000, 660000

**Pattern:** [List of <[Double 0...MAX_DOUBLE (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** A list of depth values that indicate where the transitions between the different conductivity parameter sets should occur (in most cases, these will be the depths of major phase transitions). Units: \si{\meter}.

(parameters:Material_20model/Steinberger_20model/Use_20Drucker_2dPrager_20rheology)=
### __Parameter name:__ Use Drucker-Prager rheology
**Default value:** false

**Pattern:** [Bool]

**Documentation:** This parameter determines whether to apply plastic yielding according to a Drucker-Prager rheology after computing the default steinberger viscosity (if true) or not (if false).

(parameters:Material_20model/Steinberger_20model/Use_20lateral_20average_20temperature_20for_20viscosity)=
### __Parameter name:__ Use lateral average temperature for viscosity
**Default value:** true

**Pattern:** [Bool]

**Documentation:** Whether to use the laterally averaged temperature instead of the adiabatic temperature as reference for the viscosity calculation. This ensures that the laterally averaged viscosities remain more or less constant over the model runtime. This behavior might or might not be desired.

(parameters:Material_20model/Steinberger_20model/Use_20plastic_20damper)=
### __Parameter name:__ Use plastic damper
**Default value:** false

**Pattern:** [Bool]

**Documentation:** Whether to use a plastic damper when computing the Drucker-Prager plastic viscosity. The damper acts to stabilize the plastic shear band width and remove associated mesh-dependent behavior at sufficient resolutions.

(parameters:Material_20model/Steinberger_20model/Viscosity_20averaging_20scheme)=
### __Parameter name:__ Viscosity averaging scheme
**Default value:** harmonic

**Pattern:** [Selection arithmetic|harmonic|geometric|maximum composition ]

**Documentation:** Method to average viscosities over multiple compositional fields. One of arithmetic, harmonic, geometric or maximum composition.

(parameters:Material_20model/Visco_20Plastic)=
## **Subsection:** Material model / Visco Plastic
(parameters:Material_20model/Visco_20Plastic/Activation_20energies_20for_20Peierls_20creep)=
### __Parameter name:__ Activation energies for Peierls creep
**Default value:** 320e3

**Pattern:** [Anything]

**Documentation:** List of activation energies, $E$, for background material and compositional fields, for a total of N+1 values, where N is the number of all compositional fields or only those corresponding to chemical compositions. If only one value is given, then all use the same value. Units: \si{\joule\per\mole}.

(parameters:Material_20model/Visco_20Plastic/Activation_20energies_20for_20diffusion_20creep)=
### __Parameter name:__ Activation energies for diffusion creep
**Default value:** 375e3

**Pattern:** [Anything]

**Documentation:** List of activation energies, $E_a$, for background material and compositional fields, for a total of N+1 values, where N is the number of all compositional fields or only those corresponding to chemical compositions. If only one value is given, then all use the same value. Units: \si{\joule\per\mole}.

(parameters:Material_20model/Visco_20Plastic/Activation_20energies_20for_20dislocation_20creep)=
### __Parameter name:__ Activation energies for dislocation creep
**Default value:** 530e3

**Pattern:** [Anything]

**Documentation:** List of activation energies, $E_a$, for background material and compositional fields, for a total of N+1 values, where N is the number of all compositional fields or only those corresponding to chemical compositions. If only one value is given, then all use the same value. Units: \si{\joule\per\mole}.

(parameters:Material_20model/Visco_20Plastic/Activation_20volumes_20for_20Peierls_20creep)=
### __Parameter name:__ Activation volumes for Peierls creep
**Default value:** 1.4e-5

**Pattern:** [Anything]

**Documentation:** List of activation volumes, $V$, for background material and compositional fields, for a total of N+1 values, where N is the number of all compositional fields or only those corresponding to chemical compositions. If only one value is given, then all use the same value. Units: \si{\meter\cubed\per\mole}.

(parameters:Material_20model/Visco_20Plastic/Activation_20volumes_20for_20diffusion_20creep)=
### __Parameter name:__ Activation volumes for diffusion creep
**Default value:** 6e-6

**Pattern:** [Anything]

**Documentation:** List of activation volumes, $V_a$, for background material and compositional fields, for a total of N+1 values, where N is the number of all compositional fields or only those corresponding to chemical compositions. If only one value is given, then all use the same value. Units: \si{\meter\cubed\per\mole}.

(parameters:Material_20model/Visco_20Plastic/Activation_20volumes_20for_20dislocation_20creep)=
### __Parameter name:__ Activation volumes for dislocation creep
**Default value:** 1.4e-5

**Pattern:** [Anything]

**Documentation:** List of activation volumes, $V_a$, for background material and compositional fields, for a total of N+1 values, where N is the number of all compositional fields or only those corresponding to chemical compositions. If only one value is given, then all use the same value. Units: \si{\meter\cubed\per\mole}.

(parameters:Material_20model/Visco_20Plastic/Adiabat_20temperature_20gradient_20for_20viscosity)=
### __Parameter name:__ Adiabat temperature gradient for viscosity
**Default value:** 0.0

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** Add an adiabatic temperature gradient to the temperature used in the flow law so that the activation volume is consistent with what one would use in a earth-like (compressible) model. Default is set so this is off. Note that this is a linear approximation of the real adiabatic gradient, which is okay for the upper mantle, but is not really accurate for the lower mantle. Using a pressure gradient of 32436 Pa/m, then a value of 0.3 K/km = 0.0003 K/m = 9.24e-09 K/Pa gives an earth-like adiabat.Units: \si{\kelvin\per\pascal}.

(parameters:Material_20model/Visco_20Plastic/Allow_20negative_20pressures_20in_20plasticity)=
### __Parameter name:__ Allow negative pressures in plasticity
**Default value:** false

**Pattern:** [Bool]

**Documentation:** Whether to allow negative pressures to be used in the computation of plastic yield stresses and viscosities. Setting this parameter to true may be advantageous in models without gravity where the dynamic stresses are much higher than the lithostatic pressure. If false, the minimum pressure in the plasticity formulation will be set to zero.

(parameters:Material_20model/Visco_20Plastic/Angles_20of_20dilation)=
### __Parameter name:__ Angles of dilation
**Default value:** 0.

**Pattern:** [Anything]

**Documentation:** List of angles of plastic dilation, $\psi$, for background material and compositional fields, for a total of N+1 values, where N is the number of all compositional fields or only those corresponding to chemical compositions. For a value of zero, the von Mises flow rule is retrieved. The dilation angle should never exceed the internal friction angle.

(parameters:Material_20model/Visco_20Plastic/Angles_20of_20internal_20friction)=
### __Parameter name:__ Angles of internal friction
**Default value:** 0.

**Pattern:** [Anything]

**Documentation:** List of angles of internal friction, $\phi$, for background material and compositional fields, for a total of N+1 values, where N is the number of all compositional fields or only those corresponding to chemical compositions. For a value of zero, in 2d the von Mises criterion is retrieved. Angles higher than 30 degrees are harder to solve numerically. Units: degrees.

(parameters:Material_20model/Visco_20Plastic/Apply_20strict_20stress_20cutoff_20for_20Peierls_20creep)=
### __Parameter name:__ Apply strict stress cutoff for Peierls creep
**Default value:** false

**Pattern:** [Bool]

**Documentation:** Whether the cutoff stresses for Peierls creep are used as the minimum stresses in the Peierls rheology

(parameters:Material_20model/Visco_20Plastic/Cohesion_20strain_20weakening_20factors)=
### __Parameter name:__ Cohesion strain weakening factors
**Default value:** 1.

**Pattern:** [List of <[Double 0...MAX_DOUBLE (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** List of cohesion strain weakening factors for background material and compositional fields, for a total of N+1 values, where N is the number of all compositional fields or only those corresponding to chemical compositions. If only one value is given, then all use the same value.  Units: None.

(parameters:Material_20model/Visco_20Plastic/Cohesions)=
### __Parameter name:__ Cohesions
**Default value:** 1e20

**Pattern:** [Anything]

**Documentation:** List of cohesions, $C$, for background material and compositional fields, for a total of N+1 values, where N is the number of all compositional fields or only those corresponding to chemical compositions. The extremely large default cohesion value (1e20 Pa) prevents the viscous stress from exceeding the yield stress. Units: \si{\pascal}.

(parameters:Material_20model/Visco_20Plastic/Constant_20viscosity_20prefactors)=
### __Parameter name:__ Constant viscosity prefactors
**Default value:** 1.0

**Pattern:** [List of <[Double 0...MAX_DOUBLE (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** List of constant viscosity prefactors (i.e., multiplicative factors) for background material and compositional fields, for a total of N+1 where N is the number of all compositional fields or only those corresponding to chemical compositions. Units: none.

(parameters:Material_20model/Visco_20Plastic/Cutoff_20stresses_20for_20Peierls_20creep)=
### __Parameter name:__ Cutoff stresses for Peierls creep
**Default value:** 0.0

**Pattern:** [Anything]

**Documentation:** List of the Stress thresholds below which the strain rate is solved for as a quadratic function of stress to aid with convergence when stress exponent n=0. Units: \si{\pascal}

(parameters:Material_20model/Visco_20Plastic/Data_20directory)=
### __Parameter name:__ Data directory
**Default value:** $ASPECT_SOURCE_DIR/data/material-model/entropy-table/pyrtable

**Pattern:** [DirectoryName]

**Documentation:** The path to the model data. The path may also include the special text &rsquo;$ASPECT_SOURCE_DIR&rsquo; which will be interpreted as the path in which the ASPECT source files were located when ASPECT was compiled. This interpretation allows, for example, to reference files located in the &lsquo;data/&rsquo; subdirectory of ASPECT.

(parameters:Material_20model/Visco_20Plastic/Define_20thermal_20conductivities)=
### __Parameter name:__ Define thermal conductivities
**Default value:** false

**Pattern:** [Bool]

**Documentation:** Whether to directly define thermal conductivities for each compositional field instead of calculating the values through the specified thermal diffusivities, densities, and heat capacities.

(parameters:Material_20model/Visco_20Plastic/Define_20transition_20by_20depth_20instead_20of_20pressure)=
### __Parameter name:__ Define transition by depth instead of pressure
**Default value:** true

**Pattern:** [Bool]

**Documentation:** Whether to list phase transitions by depth or pressure. If this parameter is true, then the input file will use Phase transitions depths and Phase transition widths to define the phase transition. If it is false, the parameter file will read in phase transition data from Phase transition pressures and Phase transition pressure widths.

(parameters:Material_20model/Visco_20Plastic/Densities)=
### __Parameter name:__ Densities
**Default value:** 3300.

**Pattern:** [Anything]

**Documentation:** List of densities for background mantle and compositional fields,for a total of N+M+1 values, where N is the number of compositional fields and M is the number of phases. If only one value is given, then all use the same value. Units: \si{\kilogram\per\meter\cubed}.

(parameters:Material_20model/Visco_20Plastic/Dynamic_20angles_20of_20internal_20friction)=
### __Parameter name:__ Dynamic angles of internal friction
**Default value:** 2

**Pattern:** [List of <[Double 0...MAX_DOUBLE (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** List of dynamic angles of internal friction, $\phi$, for background material and compositional fields, for a total of N$+$1 values, where N is the number of all compositional fields or only those corresponding to chemical compositions. Dynamic angles of friction are used as the current friction angle when the effective strain rate is well above the &rsquo;dynamic characteristic strain rate&rsquo;. Units: \si{\degree}.

(parameters:Material_20model/Visco_20Plastic/Dynamic_20characteristic_20strain_20rate)=
### __Parameter name:__ Dynamic characteristic strain rate
**Default value:** 1e-12

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The characteristic strain rate value at which the angle of friction is equal to $\mu = (\mu_s+\mu_d)/2$. When the effective strain rate is very high, the dynamic angle of friction is taken, when it is very low, the static angle of internal friction is used. Around the dynamic characteristic strain rate, there is a smooth gradient from the static to the dynamic angle of internal friction. Units: \si{\per\second}.

(parameters:Material_20model/Visco_20Plastic/Dynamic_20friction_20smoothness_20exponent)=
### __Parameter name:__ Dynamic friction smoothness exponent
**Default value:** 1

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** An exponential factor in the equation for the calculation of the friction angle when a static and a dynamic angle of internal friction are specified. A factor of 1 returns the equation to Equation (13) in {cite}`van_dinther_seismic_2013`. A factor between 0 and 1 makes the curve of the friction angle vs. the strain rate smoother, while a factor $>$ 1 makes the change between static and dynamic friction angle more steplike. Units: none.

(parameters:Material_20model/Visco_20Plastic/Elastic_20damper_20viscosity)=
### __Parameter name:__ Elastic damper viscosity
**Default value:** 0.0

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** Viscosity of a viscous damper that acts in parallel with the elastic element to stabilize behavior. Units: $\text{Pa}\text{s}$

(parameters:Material_20model/Visco_20Plastic/Elastic_20shear_20moduli)=
### __Parameter name:__ Elastic shear moduli
**Default value:** 75.0e9

**Pattern:** [List of <[Double 0...MAX_DOUBLE (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** List of elastic shear moduli, $G$, for background material and compositional fields, for a total of N+1 values, where N is the number of all compositional fields or only those corresponding to chemical compositions. The default value of 75 GPa is representative of mantle rocks. Units: Pa.

(parameters:Material_20model/Visco_20Plastic/End_20plasticity_20strain_20weakening_20intervals)=
### __Parameter name:__ End plasticity strain weakening intervals
**Default value:** 1.

**Pattern:** [List of <[Double 0...MAX_DOUBLE (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** List of strain weakening interval final strains for the cohesion and friction angle parameters of the background material and compositional fields, for a total of N+1 values, where N is the number of all compositional fields or only those corresponding to chemical compositions. If only one value is given, then all use the same value.  Units: None.

(parameters:Material_20model/Visco_20Plastic/End_20prefactor_20strain_20weakening_20intervals)=
### __Parameter name:__ End prefactor strain weakening intervals
**Default value:** 1.

**Pattern:** [List of <[Double 0...MAX_DOUBLE (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** List of strain weakening interval final strains for the diffusion and dislocation prefactor parameters of the background material and compositional fields, for a total of N+1 values, where N is the number of all compositional fields or only those corresponding to chemical compositions. If only one value is given, then all use the same value.  Units: None.

(parameters:Material_20model/Visco_20Plastic/Fixed_20elastic_20time_20step)=
### __Parameter name:__ Fixed elastic time step
**Default value:** 1.e3

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The fixed elastic time step $dte$. It is always used during the first timestep; afterwards on if &rsquo;Used fixed elastic time step&rsquo; is true. Units: years if the &rsquo;Use years instead of seconds&rsquo; parameter is set; seconds otherwise.

(parameters:Material_20model/Visco_20Plastic/Friction_20mechanism)=
### __Parameter name:__ Friction mechanism
**Default value:** none

**Pattern:** [Selection none|dynamic friction|function ]

**Documentation:** Whether to make the friction angle dependent on strain rate or not. This rheology is intended to be used together with the visco-plastic rheology model.

\item &ldquo;none&rdquo;: No dependence of the friction angle is applied.

\item &ldquo;dynamic friction&rdquo;: The friction angle is rate dependent.When &rsquo;dynamic angles of internal friction&rsquo; are specified, the friction angle will be weakened for high strain rates with: $\mu = \mu_d + \frac{\mu_s-\mu_d}{1+\frac{\dot{\epsilon}_{ii}}{\dot{\epsilon}_C}}^x$  where $\mu_s$ and $\mu_d$ are the friction angles at low and high strain rates, respectively. $\dot{\epsilon}_{ii}$ is the second invariant of the strain rate and $\dot{\epsilon}_C$ is the &rsquo;dynamic characteristic strain rate&rsquo; where $\mu = (\mu_s+\mu_d)/2$. The &rsquo;dynamic friction smoothness exponent&rsquo; x controls how smooth or step-like the change from $\mu_s$ to $\mu_d$ is. The equation is modified after Equation (13) in {cite}`van_dinther_seismic_2013`. $\mu_s$ and $\mu_d$ can be specified by setting &rsquo;Angles of internal friction&rsquo; and &rsquo;Dynamic angles of internal friction&rsquo;, respectively. This relationship is similar to rate-and-state friction constitutive relationships, which are applicable to the strength of rocks during earthquakes.

\item &ldquo;function&rdquo;: Specify the friction angle as a function of space and time for each compositional field.

(parameters:Material_20model/Visco_20Plastic/Friction_20strain_20weakening_20factors)=
### __Parameter name:__ Friction strain weakening factors
**Default value:** 1.

**Pattern:** [List of <[Double 0...MAX_DOUBLE (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** List of friction strain weakening factors for background material and compositional fields, for a total of N+1 values, where N is the number of all compositional fields or only those corresponding to chemical compositions. If only one value is given, then all use the same value.  Units: None.

(parameters:Material_20model/Visco_20Plastic/Grain_20size)=
### __Parameter name:__ Grain size
**Default value:** 1e-3

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The fixed grain size of the material. This grain size is only used if the parent material model does not provide its own (possibly variable) grain size when calling this rheology.Units: \si{\meter}.

(parameters:Material_20model/Visco_20Plastic/Grain_20size_20exponents_20for_20diffusion_20creep)=
### __Parameter name:__ Grain size exponents for diffusion creep
**Default value:** 3.

**Pattern:** [Anything]

**Documentation:** List of grain size exponents, $m_{\text{diffusion}}$, for background material and compositional fields, for a total of N+1 values, where N is the number of all compositional fields or only those corresponding to chemical compositions. If only one value is given, then all use the same value. Units: None.

(parameters:Material_20model/Visco_20Plastic/Heat_20capacities)=
### __Parameter name:__ Heat capacities
**Default value:** 1250.

**Pattern:** [Anything]

**Documentation:** List of specific heats $C_p$ for background mantle and compositional fields,for a total of N+M+1 values, where N is the number of compositional fields and M is the number of phases. If only one value is given, then all use the same value. Units: \si{\joule\per\kelvin\per\kilogram}.

(parameters:Material_20model/Visco_20Plastic/Include_20Grain_20Boundary_20Sliding)=
### __Parameter name:__ Include Grain Boundary Sliding
**Default value:** false

**Pattern:** [Bool]

**Documentation:** Whether to include grain boundary sliding in the rheological formulation. If set to true, the grain boundary sliding parameters must be specified.

(parameters:Material_20model/Visco_20Plastic/Include_20Peierls_20creep)=
### __Parameter name:__ Include Peierls creep
**Default value:** false

**Pattern:** [Bool]

**Documentation:** Whether to include Peierls creep in the rheological formulation.

(parameters:Material_20model/Visco_20Plastic/Lower_20temperature_20for_20maximum_20strain_20weakening)=
### __Parameter name:__ Lower temperature for maximum strain weakening
**Default value:** 923.

**Pattern:** [List of <[Double 0...MAX_DOUBLE (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** List of lower temperature for maximum strain weakening for background material and compositional fields, for a total of N+1 values, where N is the number of all compositional fields or only those corresponding to chemical compositions. If only one value is given, then all use the same value. Units: $\text{K}$.

(parameters:Material_20model/Visco_20Plastic/Lower_20temperature_20for_20onset_20of_20strain_20weakening)=
### __Parameter name:__ Lower temperature for onset of strain weakening
**Default value:** 823.

**Pattern:** [List of <[Double 0...MAX_DOUBLE (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** List of lower temperature for onset of strain weakening for background material and compositional fields, for a total of N+1 values, where N is the number of all compositional fields or only those corresponding to chemical compositions. If only one value is given, then all use the same value. Units: $\text{K}$.

(parameters:Material_20model/Visco_20Plastic/Material_20file_20names)=
### __Parameter name:__ Material file names
**Default value:** material_table_temperature_pressure_small.txt

**Pattern:** [List of <[Anything]> of length 0...4294967295 (inclusive)]

**Documentation:** The file names of the material data (material data is assumed to be in order with the ordering of the compositional fields). Note that there are two options on how many files need to be listed here: 1. If only one file is provided, it is used for the whole model domain, and compositional fields are ignored. 2. If there is one more file name than the number of compositional fields, then the first file is assumed to define a &lsquo;background composition&rsquo; that is modified by the compositional fields. These data files need to have the same structure as the one necessary for equation of state plus a new column for the phase indexes, which amounts to 8 columns in total.

(parameters:Material_20model/Visco_20Plastic/Maximum_20Peierls_20strain_20rate_20iterations)=
### __Parameter name:__ Maximum Peierls strain rate iterations
**Default value:** 40

**Pattern:** [Integer range 0...2147483647 (inclusive)]

**Documentation:** Maximum number of iterations to find the correct Peierls strain rate.

(parameters:Material_20model/Visco_20Plastic/Maximum_20viscosity)=
### __Parameter name:__ Maximum viscosity
**Default value:** 1e28

**Pattern:** [Anything]

**Documentation:** Upper cutoff for effective viscosity. Units: $\text{Pa}\text{s}$. List with as many components as active compositional fields (material data is assumed to be in order with the ordering of the fields).

(parameters:Material_20model/Visco_20Plastic/Maximum_20yield_20stress)=
### __Parameter name:__ Maximum yield stress
**Default value:** 1e12

**Pattern:** [Anything]

**Documentation:** List of maximum yield stresses, for background material and compositional fields, , which limits the maximum value of the yield stress determined by the Drucker-Prager plasticity parameters. Default value is chosen so this is not automatically used. Values of 100e6--1000e6 $Pa$ have been used in previous models. Units: \si{\pascal}.

(parameters:Material_20model/Visco_20Plastic/Minimum_20mass_20fraction_20bound_20water_20content_20for_20fugacity)=
### __Parameter name:__ Minimum mass fraction bound water content for fugacity
**Default value:** 6.15e-6

**Pattern:** [List of <[Double 0...MAX_DOUBLE (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** The minimum water content for the HK04 olivine hydration viscosity prefactor scheme. This acts as the cutoff between &rsquo;dry&rsquo; creep and &rsquo;wet&rsquo; creep for olivine, and the default value is chosen based on the value reported by Hirth & Kohlstaedt 2004. For a mass fraction of bound water beneath this value, this value is used instead to compute the water fugacity. Units: \si{\kg} / \si{\kg} %.

(parameters:Material_20model/Visco_20Plastic/Minimum_20strain_20rate)=
### __Parameter name:__ Minimum strain rate
**Default value:** 1.0e-20

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** Stabilizes strain dependent viscosity. Units: \si{\per\second}.

(parameters:Material_20model/Visco_20Plastic/Minimum_20viscosity)=
### __Parameter name:__ Minimum viscosity
**Default value:** 1e17

**Pattern:** [Anything]

**Documentation:** Lower cutoff for effective viscosity. Units: $\text{Pa}\text{s}$. List with as many components as active compositional fields (material data is assumed to be in order with the ordering of the fields).

(parameters:Material_20model/Visco_20Plastic/Peierls_20creep_20flow_20law)=
### __Parameter name:__ Peierls creep flow law
**Default value:** viscosity approximation

**Pattern:** [Selection viscosity approximation|exact ]

**Documentation:** Select what type of Peierls creep flow law to use. Currently, the available options are &rsquo;exact&rsquo;, which uses a Newton-Raphson iterative method to find the stress and then compute viscosity, and &rsquo;viscosity approximation&rsquo;, in which viscosity is an explicit function of the strain rate invariant, rather than stress.

(parameters:Material_20model/Visco_20Plastic/Peierls_20fitting_20parameters)=
### __Parameter name:__ Peierls fitting parameters
**Default value:** 0.17

**Pattern:** [Anything]

**Documentation:** List of fitting parameters $\gamma$ between stress $\sigma$ and the Peierls stress $\sigma_{\text{peierls}}$ for background material and compositional fields, for a total of N+1 values, where N is the number of all compositional fields or only those corresponding to chemical compositions. If only one value is given, then all use the same value. Units: none

(parameters:Material_20model/Visco_20Plastic/Peierls_20glide_20parameters_20p)=
### __Parameter name:__ Peierls glide parameters p
**Default value:** 0.5

**Pattern:** [Anything]

**Documentation:** List of the first Peierls creep glide parameters, $p$, for background and compositional fields for a total of N+1 values, where N is the number of all compositional fields or only those corresponding to chemical compositions. If only one value is given, then all use the same value. Units: none

(parameters:Material_20model/Visco_20Plastic/Peierls_20glide_20parameters_20q)=
### __Parameter name:__ Peierls glide parameters q
**Default value:** 1.0

**Pattern:** [Anything]

**Documentation:** List of the second Peierls creep glide parameters, $q$, for background and compositional fields for a total of N+1 values, where N is the number of all compositional fields or only those corresponding to chemical compositions. If only one value is given, then all use the same value. Units: none

(parameters:Material_20model/Visco_20Plastic/Peierls_20strain_20rate_20residual_20tolerance)=
### __Parameter name:__ Peierls strain rate residual tolerance
**Default value:** 1e-10

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** Tolerance for the iterative solve to find the correct Peierls creep strain rate. The tolerance is expressed as the difference between the natural logarithm of the input strain rate and the strain rate at the current iteration.

(parameters:Material_20model/Visco_20Plastic/Peierls_20stresses)=
### __Parameter name:__ Peierls stresses
**Default value:** 5.e9

**Pattern:** [Anything]

**Documentation:** List of stress limits for Peierls creep $\sigma_{\text{peierls}}$ for background material and compositional fields, for a total of N+1 values, where N is the number of all compositional fields or only those corresponding to chemical compositions. If only one value is given, then all use the same value. Units: \si{\pascal}

(parameters:Material_20model/Visco_20Plastic/Phase_20transition_20Clapeyron_20slopes)=
### __Parameter name:__ Phase transition Clapeyron slopes
**Default value:**

**Pattern:** [Anything]

**Documentation:** A list of Clapeyron slopes for each phase transition. A positive Clapeyron slope indicates that the phase transition will occur in a greater depth, if the temperature is higher than the one given in Phase transition temperatures and in a smaller depth, if the temperature is smaller than the one given in Phase transition temperatures. For negative slopes the other way round. List must have the same number of entries as Phase transition depths. Units: \si{\pascal\per\kelvin}.

(parameters:Material_20model/Visco_20Plastic/Phase_20transition_20depths)=
### __Parameter name:__ Phase transition depths
**Default value:**

**Pattern:** [Anything]

**Documentation:** A list of depths where phase transitions occur. Values must monotonically increase. Units: \si{\meter}.

(parameters:Material_20model/Visco_20Plastic/Phase_20transition_20indicators)=
### __Parameter name:__ Phase transition indicators
**Default value:**

**Pattern:** [Anything]

**Documentation:** A list of phase indicators in a look-up table for each phase transition. This parameter selectively assign different rheologies to specific phases, rather than having a unique rheology for each phase in the table. For example, if the table has phases 0, 1, and 2, and one only want a distinct rheology for phase 2, then only phase 2 is needed in the list of indicator. And phases 0, 1 will just be assigned the rheology of the base phase.

(parameters:Material_20model/Visco_20Plastic/Phase_20transition_20pressure_20widths)=
### __Parameter name:__ Phase transition pressure widths
**Default value:**

**Pattern:** [Anything]

**Documentation:** A list of widths for each phase transition, in terms of pressure. The phase functions are scaled with these values, leading to a jump between phases for a value of zero and a gradual transition for larger values. List must have the same number of entries as Phase transition pressures. Define transition by depth instead of pressure must be set to false to use this parameter. Units: \si{\pascal}.

(parameters:Material_20model/Visco_20Plastic/Phase_20transition_20pressures)=
### __Parameter name:__ Phase transition pressures
**Default value:**

**Pattern:** [Anything]

**Documentation:** A list of pressures where phase transitions occur. Values must monotonically increase. Define transition by depth instead of pressure must be set to false to use this parameter. Units: \si{\pascal}.

(parameters:Material_20model/Visco_20Plastic/Phase_20transition_20temperature_20lower_20limits)=
### __Parameter name:__ Phase transition temperature lower limits
**Default value:** -1.7976931348623157e+308

**Pattern:** [Anything]

**Documentation:** A list of lower temperature limits for each phase transition. Below this temperature the respective phase transition is deactivated. The default value means there is no lower limit for any phase transition. List must have the same number of entries as Phase transition depths. When the optional temperature limits are applied, the user has to be careful about the consistency between adjacent phases. Phase transitions should be continuous in pressure-temperature space. We recommend producing a phase diagram with simple model setups to check the implementation as a starting point.Units: \si{\kelvin}.

(parameters:Material_20model/Visco_20Plastic/Phase_20transition_20temperature_20upper_20limits)=
### __Parameter name:__ Phase transition temperature upper limits
**Default value:** 1.7976931348623157e+308

**Pattern:** [Anything]

**Documentation:** A list of upper temperature limits for each phase transition. Above this temperature the respective phase transition is deactivated. The default value means there is no upper limit for any phase transitions. List must have the same number of entries as Phase transition depths. When the optional temperature limits are applied, the user has to be careful about the consistency between adjacent phases. Phase transitions should be continuous in pressure-temperature space. We recommend producing a phase diagram with simple model setups to check the implementation as a starting point.Units: \si{\kelvin}.

(parameters:Material_20model/Visco_20Plastic/Phase_20transition_20temperatures)=
### __Parameter name:__ Phase transition temperatures
**Default value:**

**Pattern:** [Anything]

**Documentation:** A list of temperatures where phase transitions occur. Higher or lower temperatures lead to phase transition occurring in smaller or greater depths than given in Phase transition depths, depending on the Clapeyron slope given in Phase transition Clapeyron slopes. List must have the same number of entries as Phase transition depths. Units: \si{\kelvin}.

(parameters:Material_20model/Visco_20Plastic/Phase_20transition_20widths)=
### __Parameter name:__ Phase transition widths
**Default value:**

**Pattern:** [Anything]

**Documentation:** A list of widths for each phase transition, in terms of depth. The phase functions are scaled with these values, leading to a jump between phases for a value of zero and a gradual transition for larger values. List must have the same number of entries as Phase transition depths. Units: \si{\meter}.

(parameters:Material_20model/Visco_20Plastic/Plastic_20damper_20viscosity)=
### __Parameter name:__ Plastic damper viscosity
**Default value:** 0.0

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** Viscosity of the damper that acts in parallel with the plastic viscosity to produce mesh-independent behavior at sufficient resolutions. Units: \si{\pascal\second}

(parameters:Material_20model/Visco_20Plastic/Prefactor_20strain_20weakening_20factors)=
### __Parameter name:__ Prefactor strain weakening factors
**Default value:** 1.

**Pattern:** [List of <[Double 0...1 (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** List of viscous strain weakening factors for background material and compositional fields, for a total of N+1 values, where N is the number of all compositional fields or only those corresponding to chemical compositions. If only one value is given, then all use the same value.  Units: None.

(parameters:Material_20model/Visco_20Plastic/Prefactors_20for_20Frank_20Kamenetskii)=
### __Parameter name:__ Prefactors for Frank Kamenetskii
**Default value:** 1.e21

**Pattern:** [List of <[Double 0...MAX_DOUBLE (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** A viscosity prefactor for the viscosity approximation, for a total of N+1 values, where N is the number of all compositional fields or only those corresponding to chemical compositions. If only one value is given, then all use the same value.  Units: None

(parameters:Material_20model/Visco_20Plastic/Prefactors_20for_20Peierls_20creep)=
### __Parameter name:__ Prefactors for Peierls creep
**Default value:** 1.4e-19

**Pattern:** [Anything]

**Documentation:** List of viscosity prefactors, $A$, for background material and compositional fields, for a total of N+1 values, where N is the number of all compositional fields or only those corresponding to chemical compositions. If only one value is given, then all use the same value. Units: \si{\pascal}$^{-n_{\text{peierls}}}$ \si{\per\second}

(parameters:Material_20model/Visco_20Plastic/Prefactors_20for_20diffusion_20creep)=
### __Parameter name:__ Prefactors for diffusion creep
**Default value:** 1.5e-15

**Pattern:** [Anything]

**Documentation:** List of viscosity prefactors, $A$, for background material and compositional fields, for a total of N+1 values, where N is the number of all compositional fields or only those corresponding to chemical compositions. If only one value is given, then all use the same value. Units: \si{\per\pascal\meter}$^{m_{\text{diffusion}}}$\si{\per\second}.

(parameters:Material_20model/Visco_20Plastic/Prefactors_20for_20dislocation_20creep)=
### __Parameter name:__ Prefactors for dislocation creep
**Default value:** 1.1e-16

**Pattern:** [Anything]

**Documentation:** List of viscosity prefactors, $A$, for background material and compositional fields, for a total of N+1 values, where N is the number of all compositional fields or only those corresponding to chemical compositions. If only one value is given, then all use the same value. Units: \si{\pascal}$^{-n_{\text{dislocation}}}$ \si{\per\second}.

(parameters:Material_20model/Visco_20Plastic/Prefactors_20for_20yield_20stress)=
### __Parameter name:__ Prefactors for yield stress
**Default value:** 1.0

**Pattern:** [Anything]

**Documentation:** List of prefactors for the yield stress, for background material and compositional fields, for a total of N+1 values, where N is the number of all compositional fields or only those corresponding to chemical compositions. The prefactor is multiplied with the yield stress computed from the Drucker-Prager plasticity parameters. Default value is 1.0.

(parameters:Material_20model/Visco_20Plastic/Pressure_20prefactors_20for_20Frank_20Kamenetskii)=
### __Parameter name:__ Pressure prefactors for Frank Kamenetskii
**Default value:** 0.0

**Pattern:** [List of <[Double 0...MAX_DOUBLE (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** A prefactor for the pressure term in the viscosity approximation, for a total of N+1 values, where N is the number of all compositional fields or only those corresponding to chemical compositions. If only one value is given, then all use the same value. Units: None

(parameters:Material_20model/Visco_20Plastic/Reference_20pressures_20for_20Frank_20Kamenetskii)=
### __Parameter name:__ Reference pressures for Frank Kamenetskii
**Default value:** 1.7976931348623157e+308

**Pattern:** [List of <[Double 0...MAX_DOUBLE (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** A reference pressure in the viscosity approximation which specifies where the FK pressure dependence goes to 0.Given for a total of N+1 values, where N is the number of all compositional fields or only those corresponding to chemical compositions. If only one value is given, then all use the same value. Units: Pa

(parameters:Material_20model/Visco_20Plastic/Reference_20strain_20rate)=
### __Parameter name:__ Reference strain rate
**Default value:** 1.0e-15

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** Reference strain rate for first time step. Units: \si{\per\second}.

(parameters:Material_20model/Visco_20Plastic/Reference_20temperature)=
### __Parameter name:__ Reference temperature
**Default value:** 293.

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The reference temperature $T_0$. Units: \si{\kelvin}.

(parameters:Material_20model/Visco_20Plastic/Reference_20temperatures_20for_20Frank_20Kamenetskii)=
### __Parameter name:__ Reference temperatures for Frank Kamenetskii
**Default value:** 1.7976931348623157e+308

**Pattern:** [List of <[Double 0...MAX_DOUBLE (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** A reference temperature in the viscosity approximation which specifies where the FK temperature dependence goes to 0. Given for a total of N+1 values, where N is the number of all compositional fields or only those corresponding to chemical compositions. If only one value is given, then all use the same value. Units: K

(parameters:Material_20model/Visco_20Plastic/Specific_20heats)=
### __Parameter name__: Specific heats
**Alias:** [Heat capacities](parameters:Material_20model/Visco_20Plastic/Heat_20capacities)

**Deprecation Status:** false

(parameters:Material_20model/Visco_20Plastic/Stabilization_20time_20scale_20factor)=
### __Parameter name:__ Stabilization time scale factor
**Default value:** 1.

**Pattern:** [Double 1...MAX_DOUBLE (inclusive)]

**Documentation:** A stabilization factor for the elastic stresses that influences how fast elastic stresses adjust to deformation. This value is equal to the elastic time step divided by the computational time step. The default value of 1.0 may lead to oscillatory motion. Increasing this factor to 2.0 can reduce oscillations while preserving an immediate elastic response. In complex models the factor can be increased further to improve convergence behaviour. As the stabilization factor increases, the effective viscosity gets smaller, and is balanced by an increasing body force term. For composite rheologies that use this formulation of elasticity, setting an infinite shear modulus only recovers the nonelastic part of the rheology if this stabilization factor is equal to 1.0.

(parameters:Material_20model/Visco_20Plastic/Start_20plasticity_20strain_20weakening_20intervals)=
### __Parameter name:__ Start plasticity strain weakening intervals
**Default value:** 0.

**Pattern:** [List of <[Double 0...MAX_DOUBLE (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** List of strain weakening interval initial strains for the cohesion and friction angle parameters of the background material and compositional fields, for a total of N+1 values, where N is the number of all compositional fields or only those corresponding to chemical compositions. If only one value is given, then all use the same value. Units: None.

(parameters:Material_20model/Visco_20Plastic/Start_20prefactor_20strain_20weakening_20intervals)=
### __Parameter name:__ Start prefactor strain weakening intervals
**Default value:** 0.

**Pattern:** [List of <[Double 0...MAX_DOUBLE (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** List of strain weakening interval initial strains for the diffusion and dislocation prefactor parameters of the background material and compositional fields, for a total of N+1 values, where N is the number of all compositional fields or only those corresponding to chemical compositions. If only one value is given, then all use the same value.  Units: None.

(parameters:Material_20model/Visco_20Plastic/Strain_20healing_20mechanism)=
### __Parameter name:__ Strain healing mechanism
**Default value:** no healing

**Pattern:** [Selection no healing|temperature dependent ]

**Documentation:** Whether to apply strain healing to plastic yielding and viscosity terms, and if yes, which method to use. The following methods are available:

\item &ldquo;no healing&rdquo;: No strain healing is applied.

\item &ldquo;temperature dependent&rdquo;: Purely temperature dependent strain healing applied to plastic yielding and viscosity terms, similar to the temperature-dependent Frank Kamenetskii formulation, computes strain healing as removing strain as a function of temperature, time, and a user-defined healing rate and prefactor as done in Fuchs and Becker, 2019, for mantle convection

(parameters:Material_20model/Visco_20Plastic/Strain_20healing_20temperature_20dependent_20prefactor)=
### __Parameter name:__ Strain healing temperature dependent prefactor
**Default value:** 15.

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** Prefactor for temperature dependent strain healing. Units: None

(parameters:Material_20model/Visco_20Plastic/Strain_20healing_20temperature_20dependent_20recovery_20rate)=
### __Parameter name:__ Strain healing temperature dependent recovery rate
**Default value:** 1.e-15

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** Recovery rate prefactor for temperature dependent strain healing. Units: $1/s$

(parameters:Material_20model/Visco_20Plastic/Strain_20weakening_20mechanism)=
### __Parameter name:__ Strain weakening mechanism
**Default value:** default

**Pattern:** [Selection none|finite strain tensor|total strain|plastic weakening with plastic strain only|plastic weakening with total strain only|plastic weakening with plastic strain and viscous weakening with viscous strain|viscous weakening with viscous strain only|default ]

**Documentation:** Whether to apply strain weakening to viscosity, cohesion and internal angleof friction based on accumulated finite strain, and if yes, which method to use. The following methods are available:

\item &ldquo;none&rdquo;: No strain weakening is applied.

\item &ldquo;finite strain tensor&rdquo;: The full finite strain tensor is tracked, and its second invariant is used to weaken both the plastic yield stress (specifically, the cohesion and friction angle) and the pre-yield viscosity that arises from diffusion and/or dislocation creep.

\item &ldquo;total strain&rdquo;: The finite strain is approximated as the product of the second invariant of the strain rate in each time step and the time step size, and this quantity is integrated and tracked over time. It is used to weaken both the plastic yield stress (specifically, the cohesion and friction angle) and the pre-yield viscosity.

\item &ldquo;plastic weakening with plastic strain only&rdquo;: The finite strain is approximated as the product of the second invariant of the strain ratein each time step and the time step size in regions where material is plastically yielding. This quantity is integrated and tracked over time, and used to weaken the cohesion and friction angle. The pre-yield viscosity is not weakened.

\item &ldquo;plastic weakening with total strain only&rdquo;: The finite strain is approximated as the product of the second invariant of the strain rate in each time step and the time step size, and this quantity is integrated and tracked over time. It is used to weaken the plastic yield stress (specifically, the cohesion and internal friction angle). The pre-yield viscosity is not weakened.

\item &ldquo;plastic weakening with plastic strain and viscous weakening with viscous strain&rdquo;: Both the finite strain accumulated by plastic deformation and by viscous deformation are computed separately (each approximated as the product of the second invariant of the corresponding strain rate in each time step and the time step size). The plastic strain is used to weaken the plastic yield stress (specifically, the cohesion and yield angle), and the viscous strain is used to weaken the pre-yield viscosity.

\item &ldquo;viscous weakening with viscous strain only&rdquo;: The finite strain is approximated as the product of the second invariant of the strain rate in each time step and the time step size in regions where material is not plastically yielding. This quantity is integrated and tracked over time, and used to weaken the pre-yield viscosity. The cohesion and friction angle are not weakened.

\item &ldquo;default&rdquo;: The default option has the same behavior as &ldquo;none&rdquo;, but is there to make sure that the original parameters for specifying the strain weakening mechanism (&ldquo;Use plastic/viscous strain weakening&rdquo;) are still allowed, but to guarantee that one uses either the old parameter names or the new ones, never both.

If a compositional field named &rsquo;noninitial\_plastic\_strain&rsquo; is included in the parameter file, this field will automatically be excluded from from volume fraction calculation and track the cumulative plastic strain with the initial plastic strain values removed.

(parameters:Material_20model/Visco_20Plastic/Stress_20exponents_20for_20Peierls_20creep)=
### __Parameter name:__ Stress exponents for Peierls creep
**Default value:** 2.0

**Pattern:** [Anything]

**Documentation:** List of stress exponents, $n_{\text{peierls}}$, for background material and compositional fields, for a total of N+1 values, where N is the number of all compositional fields or only those corresponding to chemical compositions. If only one value is given, then all use the same value.  Units: None.

(parameters:Material_20model/Visco_20Plastic/Stress_20exponents_20for_20diffusion_20creep)=
### __Parameter name:__ Stress exponents for diffusion creep
**Default value:** 1.

**Pattern:** [List of <[Double 0...MAX_DOUBLE (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** List of stress exponents, $n_{\text{diffusion}}$, for background mantle and compositional fields, for a total of N+1 values, where N is the number of all compositional fields or only those corresponding to chemical compositions. The stress exponent for diffusion creep is almost always equal to one. If only one value is given, then all use the same value.  Units: None.

(parameters:Material_20model/Visco_20Plastic/Stress_20exponents_20for_20dislocation_20creep)=
### __Parameter name:__ Stress exponents for dislocation creep
**Default value:** 3.5

**Pattern:** [Anything]

**Documentation:** List of stress exponents, $n_{\text{dislocation}}$, for background material and compositional fields, for a total of N+1 values, where N is the number of all compositional fields or only those corresponding to chemical compositions. If only one value is given, then all use the same value.  Units: None.

(parameters:Material_20model/Visco_20Plastic/Stress_20limiter_20exponents)=
### __Parameter name:__ Stress limiter exponents
**Default value:** 1.0

**Pattern:** [List of <[Double 0...MAX_DOUBLE (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** List of stress limiter exponents, $n_{\text{lim}}$, for background material and compositional fields, for a total of N+1 values, where N is the number of all compositional fields or only those corresponding to chemical compositions. Units: none.

(parameters:Material_20model/Visco_20Plastic/Thermal_20conductivities)=
### __Parameter name:__ Thermal conductivities
**Default value:** 3.0

**Pattern:** [List of <[Double 0...MAX_DOUBLE (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** List of thermal conductivities, for background material and compositional fields, for a total of N+1 values, where N is the number of all compositional fields or only those corresponding to chemical compositions. If only one value is given, then all use the same value. Units: $\frac{\text{W}{\text{m}\text{K}}$.

(parameters:Material_20model/Visco_20Plastic/Thermal_20diffusivities)=
### __Parameter name:__ Thermal diffusivities
**Default value:** 0.8e-6

**Pattern:** [List of <[Double 0...MAX_DOUBLE (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** List of thermal diffusivities, for background material and compositional fields, for a total of N+1 values, where N is the number of all compositional fields or only those corresponding to chemical compositions. If only one value is given, then all use the same value.  Units: \si{\meter\squared\per\second}.

(parameters:Material_20model/Visco_20Plastic/Thermal_20expansivities)=
### __Parameter name:__ Thermal expansivities
**Default value:** 0.000035

**Pattern:** [Anything]

**Documentation:** List of thermal expansivities for background mantle and compositional fields,for a total of N+M+1 values, where N is the number of compositional fields and M is the number of phases. If only one value is given, then all use the same value. Units: \si{\per\kelvin}.

(parameters:Material_20model/Visco_20Plastic/Upper_20temperature_20for_20maximum_20strain_20weakening)=
### __Parameter name:__ Upper temperature for maximum strain weakening
**Default value:** 1023.

**Pattern:** [List of <[Double 0...MAX_DOUBLE (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** List of upper temperatures for maximum strain weakening for background material and compositional fields, for a total of N+1 values, where N is the number of all compositional fields or only those corresponding to chemical compositions. If only one value is given, then all use the same value. Units: $\text{K}$.

(parameters:Material_20model/Visco_20Plastic/Upper_20temperature_20for_20onset_20of_20strain_20weakening)=
### __Parameter name:__ Upper temperature for onset of strain weakening
**Default value:** 1123.

**Pattern:** [List of <[Double 0...MAX_DOUBLE (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** List of upper temperatures for onset of strain weakeningfor background material and compositional fields, for a total of N+1 values, where N is the number of all compositional fields or only those corresponding to chemical compositions. If only one value is given, then all use the same value. Units: $\text{K}$.

(parameters:Material_20model/Visco_20Plastic/Use_20adiabatic_20pressure_20in_20creep_20viscosity)=
### __Parameter name:__ Use adiabatic pressure in creep viscosity
**Default value:** false

**Pattern:** [Bool]

**Documentation:** Whether to use the adiabatic pressure instead of the full pressure (default) when calculating viscous creep. This may be helpful in models where the full pressure has an unusually large negative value arising from large negative dynamic pressure, resulting in solver convergence issue and in some cases a viscosity of zero.

(parameters:Material_20model/Visco_20Plastic/Use_20adiabatic_20pressure_20in_20plasticity)=
### __Parameter name:__ Use adiabatic pressure in plasticity
**Default value:** false

**Pattern:** [Bool]

**Documentation:** Whether to use the adiabatic pressure instead of the full pressure when calculating plastic yield stress. This may be helpful in models where the full pressure has unusually large variations, resulting in solver convergence issues. Be aware that this setting will change the plastic shear band angle.

(parameters:Material_20model/Visco_20Plastic/Use_20dominant_20phase_20for_20viscosity)=
### __Parameter name:__ Use dominant phase for viscosity
**Default value:** false

**Pattern:** [Bool]

**Documentation:** Whether to look up the dominant phase for each composition in its respective material data file to calculate viscosity. This allows each phase to have distinct rheological parameterizations.

(parameters:Material_20model/Visco_20Plastic/Use_20fixed_20elastic_20time_20step)=
### __Parameter name:__ Use fixed elastic time step
**Default value:** unspecified

**Pattern:** [Selection true|false|unspecified ]

**Documentation:** Select whether the material time scale in the viscoelastic constitutive relationship uses the regular numerical time step or a separate fixed elastic time step throughout the model run. The fixed elastic time step is always used during the initial time step. If a fixed elastic time step is used throughout the model run, a stress averaging scheme is applied to account for differences with the numerical time step. An alternative approach is to limit the maximum time step size so that it is equal to the elastic time step. The default value of this parameter is &rsquo;unspecified&rsquo;, which throws an exception during runtime. In order for the model to run the user must select &rsquo;true&rsquo; or &rsquo;false&rsquo;.

(parameters:Material_20model/Visco_20Plastic/Use_20plastic_20damper)=
### __Parameter name:__ Use plastic damper
**Default value:** false

**Pattern:** [Bool]

**Documentation:** Whether to use a plastic damper when computing the Drucker-Prager plastic viscosity. The damper acts to stabilize the plastic shear band width and remove associated mesh-dependent behavior at sufficient resolutions.

(parameters:Material_20model/Visco_20Plastic/Use_20temperature_20activated_20strain_20softening)=
### __Parameter name:__ Use temperature activated strain softening
**Default value:** false

**Pattern:** [Bool]

**Documentation:** Whether viscous strain softening factor depends on temperature

(parameters:Material_20model/Visco_20Plastic/Viscosity_20averaging_20scheme)=
### __Parameter name:__ Viscosity averaging scheme
**Default value:** harmonic

**Pattern:** [Selection arithmetic|harmonic|geometric|maximum composition ]

**Documentation:** When more than one compositional field is present at a point with different viscosities, we need to come up with an average viscosity at that point.  Select a weighted harmonic, arithmetic, geometric, or maximum composition.

(parameters:Material_20model/Visco_20Plastic/Viscosity_20prefactor_20scheme)=
### __Parameter name:__ Viscosity prefactor scheme
**Default value:** none

**Pattern:** [Selection none|HK04 olivine hydration ]

**Documentation:** Select what type of viscosity multiplicative prefactor scheme to apply. Allowed entries are &rsquo;none&rsquo;, and &rsquo;HK04 olivine hydration&rsquo;. HK04 olivine hydration calculates the viscosity change due to hydrogen incorporation into olivine following Hirth & Kohlstaedt 2004 (10.1029/138GM06). none does not modify the viscosity. Units: none.

(parameters:Material_20model/Visco_20Plastic/Viscosity_20ratios_20for_20Frank_20Kamenetskii)=
### __Parameter name:__ Viscosity ratios for Frank Kamenetskii
**Default value:** 15.

**Pattern:** [List of <[Double 0...MAX_DOUBLE (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** An adjusted viscosity ratio, $E$, for the viscosity approximation, for a total of N+1 values, where N is the number of all compositional fields or only those corresponding to chemical compositions. If only one value is given, then all use the same value. Units: None

(parameters:Material_20model/Visco_20Plastic/Viscous_20flow_20law)=
### __Parameter name:__ Viscous flow law
**Default value:** composite

**Pattern:** [Selection diffusion|dislocation|frank kamenetskii|composite|minimum diffusion dislocation ]

**Documentation:** Select what type of viscosity law to use between the options diffusion, dislocation, frank kamenetskii, composite and the minimum of diffusion and dislocation. Soon there will be an option to select a specific flow law for each assigned composition, When the full strain rate is used to compute each viscosity instead of the properly partitioned diffusion and dislocation creep strain rates, it is recommended to take the minimum of the creep viscosities instead of their composite.

(parameters:Material_20model/Visco_20Plastic/Water_20fugacity_20exponents_20for_20diffusion_20creep)=
### __Parameter name:__ Water fugacity exponents for diffusion creep
**Default value:** 0.0

**Pattern:** [List of <[Double 0...MAX_DOUBLE (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** List of water fugacity exponents for diffusion creep for background material and compositional fields, for a total of N+1 where N is the number of all compositional fields or only those corresponding to chemical compositions. This is only applied when using the Viscosity prefactor scheme &rsquo;HK04 olivine hydration&rsquo;. Note, the water fugacity exponent required by ASPECT for diffusion creep is r/n, where n is the stress exponent for diffusion creep, which typically is 1. Units: none.

(parameters:Material_20model/Visco_20Plastic/Water_20fugacity_20exponents_20for_20dislocation_20creep)=
### __Parameter name:__ Water fugacity exponents for dislocation creep
**Default value:** 0.0

**Pattern:** [List of <[Double 0...MAX_DOUBLE (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** List of water fugacity exponents for dislocation creep for background material and compositional fields, for a total of N+1 where N is the number of all compositional fields or only those corresponding to chemical compositions. This is only applied when using the Viscosity prefactor scheme &rsquo;HK04 olivine hydration&rsquo;. Note, the water fugacity exponent required by ASPECT for dislocation creep is r/n, where n is the stress exponent for dislocation creep, which typically is 3.5. Units: none.

(parameters:Material_20model/Visco_20Plastic/Yield_20mechanism)=
### __Parameter name:__ Yield mechanism
**Default value:** drucker

**Pattern:** [Selection drucker|limiter ]

**Documentation:** Select what type of yield mechanism to use between Drucker Prager and stress limiter options.

(parameters:Material_20model/Visco_20Plastic/Friction_20function)=
## **Subsection:** Material model / Visco Plastic / Friction function
(parameters:Material_20model/Visco_20Plastic/Friction_20function/Coordinate_20system)=
### __Parameter name:__ Coordinate system
**Default value:** cartesian

**Pattern:** [Selection cartesian|spherical|depth ]

**Documentation:** A selection that determines the assumed coordinate system for the function variables. Allowed values are &lsquo;cartesian&rsquo;, &lsquo;spherical&rsquo;, and &lsquo;depth&rsquo;. &lsquo;spherical&rsquo; coordinates are interpreted as r,phi or r,phi,theta in 2d/3d respectively with theta being the polar angle. &lsquo;depth&rsquo; will create a function, in which only the first parameter is non-zero, which is interpreted to be the depth of the point.

(parameters:Material_20model/Visco_20Plastic/Friction_20function/Function_20constants)=
### __Parameter name:__ Function constants
**Default value:**

**Pattern:** [Anything]

**Documentation:** Sometimes it is convenient to use symbolic constants in the expression that describes the function, rather than having to use its numeric value everywhere the constant appears. These values can be defined using this parameter, in the form &lsquo;var1=value1, var2=value2, ...&rsquo;.

A typical example would be to set this runtime parameter to &lsquo;pi=3.1415926536&rsquo; and then use &lsquo;pi&rsquo; in the expression of the actual formula. (That said, for convenience this class actually defines both &lsquo;pi&rsquo; and &lsquo;Pi&rsquo; by default, but you get the idea.)

(parameters:Material_20model/Visco_20Plastic/Friction_20function/Function_20expression)=
### __Parameter name:__ Function expression
**Default value:** 0

**Pattern:** [Anything]

**Documentation:** The formula that denotes the function you want to evaluate for particular values of the independent variables. This expression may contain any of the usual operations such as addition or multiplication, as well as all of the common functions such as &lsquo;sin&rsquo; or &lsquo;cos&rsquo;. In addition, it may contain expressions like &lsquo;if(x>0, 1, -1)&rsquo; where the expression evaluates to the second argument if the first argument is true, and to the third argument otherwise. For a full overview of possible expressions accepted see the documentation of the muparser library at http://muparser.beltoforion.de/.

If the function you are describing represents a vector-valued function with multiple components, then separate the expressions for individual components by a semicolon.

(parameters:Material_20model/Visco_20Plastic/Friction_20function/Variable_20names)=
### __Parameter name:__ Variable names
**Default value:** x,y,t

**Pattern:** [Anything]

**Documentation:** The names of the variables as they will be used in the function, separated by commas. By default, the names of variables at which the function will be evaluated are &lsquo;x&rsquo; (in 1d), &lsquo;x,y&rsquo; (in 2d) or &lsquo;x,y,z&rsquo; (in 3d) for spatial coordinates and &lsquo;t&rsquo; for time. You can then use these variable names in your function expression and they will be replaced by the values of these variables at which the function is currently evaluated. However, you can also choose a different set of names for the independent variables at which to evaluate your function expression. For example, if you work in spherical coordinates, you may wish to set this input parameter to &lsquo;r,phi,theta,t&rsquo; and then use these variable names in your function expression.

(parameters:Material_20model/Visco_20Plastic/Grain_20boundary_20sliding)=
## **Subsection:** Material model / Visco Plastic / Grain boundary sliding
(parameters:Material_20model/Visco_20Plastic/Grain_20boundary_20sliding/Activation_20energies_20for_20grain_20boundary_20sliding)=
### __Parameter name:__ Activation energies for grain boundary sliding
**Default value:** 49

**Pattern:** [Anything]

**Documentation:** Here we use the default values for ice as given in Goldsby & Kohlstedt, 2001for T > 262 k.Units: \si{\joule\per\mole}.

(parameters:Material_20model/Visco_20Plastic/Grain_20boundary_20sliding/Activation_20volumes_20for_20grain_20boundary_20sliding)=
### __Parameter name:__ Activation volumes for grain boundary sliding
**Default value:** 13e-6

**Pattern:** [Anything]

**Documentation:** Here we use the default values for ice as given in Goldsby & Kohlstedt, 2001.Units: \si{\meter\cubed\per\mole}.

(parameters:Material_20model/Visco_20Plastic/Grain_20boundary_20sliding/Grain_20size)=
### __Parameter name:__ Grain size
**Default value:** 26e-6

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** Here we use the default values for ice as given in Goldsby & Kohlstedt, 2001.Units: \si{\meter}.

(parameters:Material_20model/Visco_20Plastic/Grain_20boundary_20sliding/Grain_20size_20exponents_20for_20grain_20boundary_20sliding)=
### __Parameter name:__ Grain size exponents for grain boundary sliding
**Default value:** 1.4.

**Pattern:** [Anything]

**Documentation:** Here we use the default values for ice as given in Goldsby & Kohlstedt, 2001.

(parameters:Material_20model/Visco_20Plastic/Grain_20boundary_20sliding/Prefactors_20for_20grain_20boundary_20sliding)=
### __Parameter name:__ Prefactors for grain boundary sliding
**Default value:** 3.9e-19.2

**Pattern:** [Anything]

**Documentation:** Here we use the default values for ice as given in Goldsby & Kohlstedt, 2001

(parameters:Material_20model/Visco_20Plastic/Grain_20boundary_20sliding/Stress_20exponents_20for_20grain_20boundary_20sliding)=
### __Parameter name:__ Stress exponents for grain boundary sliding
**Default value:** 1.8

**Pattern:** [List of <[Double 0...MAX_DOUBLE (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** Here we use the default values for ice as given in Goldsby & Kohlstedt, 2001.

(parameters:Material_20model/Viscoelastic)=
## **Subsection:** Material model / Viscoelastic
(parameters:Material_20model/Viscoelastic/Densities)=
### __Parameter name:__ Densities
**Default value:** 3300.

**Pattern:** [Anything]

**Documentation:** List of densities for background mantle and compositional fields,for a total of N+M+1 values, where N is the number of compositional fields and M is the number of phases. If only one value is given, then all use the same value. Units: \si{\kilogram\per\meter\cubed}.

(parameters:Material_20model/Viscoelastic/Elastic_20damper_20viscosity)=
### __Parameter name:__ Elastic damper viscosity
**Default value:** 0.0

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** Viscosity of a viscous damper that acts in parallel with the elastic element to stabilize behavior. Units: $\text{Pa}\text{s}$

(parameters:Material_20model/Viscoelastic/Elastic_20shear_20moduli)=
### __Parameter name:__ Elastic shear moduli
**Default value:** 75.0e9

**Pattern:** [List of <[Double 0...MAX_DOUBLE (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** List of elastic shear moduli, $G$, for background material and compositional fields, for a total of N+1 values, where N is the number of all compositional fields or only those corresponding to chemical compositions. The default value of 75 GPa is representative of mantle rocks. Units: Pa.

(parameters:Material_20model/Viscoelastic/Fixed_20elastic_20time_20step)=
### __Parameter name:__ Fixed elastic time step
**Default value:** 1.e3

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The fixed elastic time step $dte$. It is always used during the first timestep; afterwards on if &rsquo;Used fixed elastic time step&rsquo; is true. Units: years if the &rsquo;Use years instead of seconds&rsquo; parameter is set; seconds otherwise.

(parameters:Material_20model/Viscoelastic/Heat_20capacities)=
### __Parameter name:__ Heat capacities
**Default value:** 1250.

**Pattern:** [Anything]

**Documentation:** List of specific heats $C_p$ for background mantle and compositional fields,for a total of N+M+1 values, where N is the number of compositional fields and M is the number of phases. If only one value is given, then all use the same value. Units: \si{\joule\per\kelvin\per\kilogram}.

(parameters:Material_20model/Viscoelastic/Reference_20temperature)=
### __Parameter name:__ Reference temperature
**Default value:** 293.

**Pattern:** [Double 0...MAX_DOUBLE (inclusive)]

**Documentation:** The reference temperature $T_0$. Units: \si{\kelvin}.

(parameters:Material_20model/Viscoelastic/Specific_20heats)=
### __Parameter name__: Specific heats
**Alias:** [Heat capacities](parameters:Material_20model/Viscoelastic/Heat_20capacities)

**Deprecation Status:** false

(parameters:Material_20model/Viscoelastic/Stabilization_20time_20scale_20factor)=
### __Parameter name:__ Stabilization time scale factor
**Default value:** 1.

**Pattern:** [Double 1...MAX_DOUBLE (inclusive)]

**Documentation:** A stabilization factor for the elastic stresses that influences how fast elastic stresses adjust to deformation. This value is equal to the elastic time step divided by the computational time step. The default value of 1.0 may lead to oscillatory motion. Increasing this factor to 2.0 can reduce oscillations while preserving an immediate elastic response. In complex models the factor can be increased further to improve convergence behaviour. As the stabilization factor increases, the effective viscosity gets smaller, and is balanced by an increasing body force term. For composite rheologies that use this formulation of elasticity, setting an infinite shear modulus only recovers the nonelastic part of the rheology if this stabilization factor is equal to 1.0.

(parameters:Material_20model/Viscoelastic/Thermal_20conductivities)=
### __Parameter name:__ Thermal conductivities
**Default value:** 4.7

**Pattern:** [List of <[Double 0...MAX_DOUBLE (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** List of thermal conductivities for background mantle and compositional fields, for a total of N+1 values, where N is the number of all compositional fields or only those corresponding to chemical compositions. If only one value is given, then all use the same value. Units: $\frac{\text{W}{\text{m}\text{K}}$.

(parameters:Material_20model/Viscoelastic/Thermal_20expansivities)=
### __Parameter name:__ Thermal expansivities
**Default value:** 0.000035

**Pattern:** [Anything]

**Documentation:** List of thermal expansivities for background mantle and compositional fields,for a total of N+M+1 values, where N is the number of compositional fields and M is the number of phases. If only one value is given, then all use the same value. Units: \si{\per\kelvin}.

(parameters:Material_20model/Viscoelastic/Use_20fixed_20elastic_20time_20step)=
### __Parameter name:__ Use fixed elastic time step
**Default value:** unspecified

**Pattern:** [Selection true|false|unspecified ]

**Documentation:** Select whether the material time scale in the viscoelastic constitutive relationship uses the regular numerical time step or a separate fixed elastic time step throughout the model run. The fixed elastic time step is always used during the initial time step. If a fixed elastic time step is used throughout the model run, a stress averaging scheme is applied to account for differences with the numerical time step. An alternative approach is to limit the maximum time step size so that it is equal to the elastic time step. The default value of this parameter is &rsquo;unspecified&rsquo;, which throws an exception during runtime. In order for the model to run the user must select &rsquo;true&rsquo; or &rsquo;false&rsquo;.

(parameters:Material_20model/Viscoelastic/Viscosities)=
### __Parameter name:__ Viscosities
**Default value:** 1.e21

**Pattern:** [List of <[Double 0...MAX_DOUBLE (inclusive)]> of length 0...4294967295 (inclusive)]

**Documentation:** List of viscosities for background mantle and compositional fields, for a total of N+1 values, where N is the number of all compositional fields or only those corresponding to chemical compositions. If only one value is given, then all use the same value. Units: $\text{Pa}\text{s}$.

(parameters:Material_20model/Viscoelastic/Viscosity_20averaging_20scheme)=
### __Parameter name:__ Viscosity averaging scheme
**Default value:** harmonic

**Pattern:** [Selection arithmetic|harmonic|geometric|maximum composition  ]

**Documentation:** When more than one compositional field is present at a point with different viscosities, we need to come up with an average viscosity at that point.  Select a weighted harmonic, arithmetic, geometric, or maximum composition.
